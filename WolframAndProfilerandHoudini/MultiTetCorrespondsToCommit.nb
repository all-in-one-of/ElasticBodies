(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[    122180,       2831]
NotebookOptionsPosition[    116909,       2658]
NotebookOutlinePosition[    117250,       2673]
CellTagsIndexPosition[    117207,       2670]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getpt", "[", 
    RowBox[{"pts_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", "*", "i"}], "-", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", "*", "i"}], "-", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{"3", "*", "i"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"restpts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", " ", "y1", ",", " ", "z1", ",", "x2", ",", " ", "y2", ",", " ",
      "z2", ",", " ", "x3", ",", " ", "y3", ",", " ", "z3", ",", " ", "x4", 
     ",", "y4", ",", " ", "z4", ",", " ", "x5", ",", " ", "y5", ",", " ", 
     "z5"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6658152745253477`*^9, 3.665815297897182*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getTet", "[", 
    RowBox[{"pts_", ",", "verts_"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665815730104158*^9, 3.66581575230119*^9}, {
  3.665815790800848*^9, 3.6658157951131983`*^9}, {3.665815849368854*^9, 
  3.665816044707925*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getTet", "[", 
  RowBox[{"restpts", ",", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getTet", "[", 
  RowBox[{"restpts", ",", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6658162181968327`*^9, 3.665816300674715*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6658208775426207`*^9, 3.665820878567718*^9}, 
   3.6658209109989357`*^9, 3.6658214155524893`*^9, 3.665821586118829*^9, 
   3.665821699819633*^9, 3.66582193278861*^9, 3.6658220430223923`*^9, {
   3.665822091344653*^9, 3.665822096214492*^9}, 3.665822169563464*^9, 
   3.665981499752554*^9, 3.665984103756639*^9, 3.6659867561279984`*^9, 
   3.665987117504649*^9, 3.665987451552433*^9, 3.665988810540255*^9, 
   3.665989408664394*^9, 3.665989760814486*^9, 3.6659898015170393`*^9, 
   3.665991236204561*^9, 3.665991635144369*^9, 3.665991672720278*^9, 
   3.665991803744759*^9, 3.6659921591109447`*^9, 3.666112389081355*^9, 
   3.6661129515744867`*^9, 3.666113402097589*^9, 3.666113434488449*^9, 
   3.666115302699024*^9, 3.6661241234701653`*^9, 3.6661298691719103`*^9, 
   3.666130360871798*^9, 3.6663777301759367`*^9, 3.666460166125717*^9, 
   3.6664602159593077`*^9, 3.666473689612382*^9, 3.6664737551781673`*^9, 
   3.666473832716537*^9, 3.6664996854490232`*^9, 3.66650274105967*^9, 
   3.666504102218132*^9, 3.6665058734515343`*^9, 3.666507996663196*^9, 
   3.666508948233672*^9, 3.666542339125325*^9, 3.6665719651721363`*^9, 
   3.666629434005*^9, 3.666714813570574*^9, 3.66671716821647*^9, 
   3.666766436780038*^9, 3.666766499422347*^9, 3.666842192809412*^9, 
   3.666845254292904*^9, 3.666845413243699*^9, 3.6668514330892763`*^9, 
   3.666852509472953*^9, 3.6668528709228363`*^9, 3.6668589092081747`*^9, {
   3.666937328377039*^9, 3.666937358161375*^9}, 3.666937857772015*^9, 
   3.666939823438548*^9, 3.667244802435692*^9, 3.6674115821316833`*^9, 
   3.6674116977229853`*^9, 3.668181601971574*^9, 3.668182009707719*^9, 
   3.668631767839622*^9, 3.66874663866039*^9, 3.6687498182769213`*^9, {
   3.668751245561908*^9, 3.668751270476294*^9}, 3.66875207465353*^9, 
   3.6689228063336163`*^9, 3.6689230615486937`*^9, 3.669272801109858*^9, 
   3.669433050606574*^9, 3.669739247945409*^9, 3.669749723099596*^9, 
   3.6703442678689327`*^9, {3.6726900307601223`*^9, 3.672690056766932*^9}, 
   3.6726914962744417`*^9, 3.673802472389059*^9, 3.673802511855301*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x5", ",", "y5", ",", "z5", ",", "x1", ",", "y1", ",", "z1", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6658208775426207`*^9, 3.665820878567718*^9}, 
   3.6658209109989357`*^9, 3.6658214155524893`*^9, 3.665821586118829*^9, 
   3.665821699819633*^9, 3.66582193278861*^9, 3.6658220430223923`*^9, {
   3.665822091344653*^9, 3.665822096214492*^9}, 3.665822169563464*^9, 
   3.665981499752554*^9, 3.665984103756639*^9, 3.6659867561279984`*^9, 
   3.665987117504649*^9, 3.665987451552433*^9, 3.665988810540255*^9, 
   3.665989408664394*^9, 3.665989760814486*^9, 3.6659898015170393`*^9, 
   3.665991236204561*^9, 3.665991635144369*^9, 3.665991672720278*^9, 
   3.665991803744759*^9, 3.6659921591109447`*^9, 3.666112389081355*^9, 
   3.6661129515744867`*^9, 3.666113402097589*^9, 3.666113434488449*^9, 
   3.666115302699024*^9, 3.6661241234701653`*^9, 3.6661298691719103`*^9, 
   3.666130360871798*^9, 3.6663777301759367`*^9, 3.666460166125717*^9, 
   3.6664602159593077`*^9, 3.666473689612382*^9, 3.6664737551781673`*^9, 
   3.666473832716537*^9, 3.6664996854490232`*^9, 3.66650274105967*^9, 
   3.666504102218132*^9, 3.6665058734515343`*^9, 3.666507996663196*^9, 
   3.666508948233672*^9, 3.666542339125325*^9, 3.6665719651721363`*^9, 
   3.666629434005*^9, 3.666714813570574*^9, 3.66671716821647*^9, 
   3.666766436780038*^9, 3.666766499422347*^9, 3.666842192809412*^9, 
   3.666845254292904*^9, 3.666845413243699*^9, 3.6668514330892763`*^9, 
   3.666852509472953*^9, 3.6668528709228363`*^9, 3.6668589092081747`*^9, {
   3.666937328377039*^9, 3.666937358161375*^9}, 3.666937857772015*^9, 
   3.666939823438548*^9, 3.667244802435692*^9, 3.6674115821316833`*^9, 
   3.6674116977229853`*^9, 3.668181601971574*^9, 3.668182009707719*^9, 
   3.668631767839622*^9, 3.66874663866039*^9, 3.6687498182769213`*^9, {
   3.668751245561908*^9, 3.668751270476294*^9}, 3.66875207465353*^9, 
   3.6689228063336163`*^9, 3.6689230615486937`*^9, 3.669272801109858*^9, 
   3.669433050606574*^9, 3.669739247945409*^9, 3.669749723099596*^9, 
   3.6703442678689327`*^9, {3.6726900307601223`*^9, 3.672690056766932*^9}, 
   3.6726914962744417`*^9, 3.673802472389059*^9, 3.673802511856894*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"initpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "    ", "0", ",", "10", ",", "0", ",", 
     "    ", "0", ",", "0", ",", "10", ",", "    ", "0", ",", "0", ",", "0", 
     ",", "    ", "0", ",", 
     RowBox[{"-", "10"}], ",", " ", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.665816311656629*^9, 3.665816350641182*^9}, {
   3.665817974600679*^9, 3.665817987549389*^9}, 3.6658184661127367`*^9, {
   3.6658185628709583`*^9, 3.665818565348721*^9}, {3.665819245929906*^9, 
   3.665819249886527*^9}, {3.665819901786521*^9, 3.665819901955181*^9}, {
   3.6658202611975803`*^9, 3.665820266356933*^9}, {3.665821690124372*^9, 
   3.665821690537157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timestep", " ", "=", " ", "0.01"}], ";"}]], "Input",
 CellChangeTimes->{
  3.6659921550961437`*^9, 3.666504099840654*^9, 3.666505871040512*^9, {
   3.666507994378394*^9, 3.666507994550542*^9}, {3.666717165801146*^9, 
   3.666717166048462*^9}, {3.666766430281699*^9, 3.666766430699895*^9}, {
   3.666845243594295*^9, 3.6668452473228827`*^9}, {3.66685249240371*^9, 
   3.666852492518807*^9}, {3.667411692241757*^9, 3.667411692408163*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"curpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "1", ",", "0", ",", "    ", "0", ",", "10", ",", "0", ",", 
     "    ", "0.129388", ",", "0.198451", ",", "10.0678", ",", "  ", 
     "0.129388", ",", "0.198451", ",", 
     RowBox[{"5.32823", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "14"}]}]}], ",", "    ", "0.939582", ",", 
     RowBox[{"-", "9.77863"}], ",", " ", 
     RowBox[{"1.0416", "*", 
      RowBox[{"10", "^", 
       RowBox[{"-", "13"}]}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.66657195354919*^9, 3.666571958185171*^9}, {
  3.673802341317786*^9, 3.6738024513690443`*^9}, {3.673802502196166*^9, 
  3.673802504768868*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"youngs", " ", "=", " ", "1000000"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"poisson", " ", "=", " ", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.672690399561447*^9, 3.672690432314806*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu", " ", "=", " ", 
   RowBox[{"youngs", "/", 
    RowBox[{"(", 
     RowBox[{"2", "+", 
      RowBox[{"2", "*", "poisson"}]}], ")"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", 
   RowBox[{"youngs", "*", 
    RowBox[{"poisson", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "+", "poisson"}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "*", "poisson"}]}], ")"}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tet1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tet2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"mu", " ", "=", " ", "10000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", "10000"}], ";"}]}], "Input",
 CellChangeTimes->{{3.665816365927237*^9, 3.665816382066884*^9}, {
  3.665818997808136*^9, 3.665819033116259*^9}, {3.672690444203545*^9, 
  3.672690456095428*^9}, {3.673802612753701*^9, 3.673802623434269*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TetRefShapeMatrix", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F1", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"TetRefShapeMatrix", "[", 
     RowBox[{"getTet", "[", 
      RowBox[{"pts", ",", " ", "tet1"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"TetRefShapeMatrix", "[", 
      RowBox[{"getTet", "[", 
       RowBox[{"initpts", ",", "tet1"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F1", "[", "curpts", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.665816993282148*^9, 3.6658169947169657`*^9}, {
   3.6658170335648727`*^9, 3.665817040210581*^9}, {3.6658171220183268`*^9, 
   3.665817152491205*^9}, {3.6658171857781477`*^9, 3.6658172151875477`*^9}, 
   3.665817651536282*^9, {3.66581878982029*^9, 3.6658188147528677`*^9}, {
   3.665818969158842*^9, 3.665818984063986*^9}, {3.665819053795548*^9, 
   3.665819066985045*^9}, {3.665819126457912*^9, 3.665819147188525*^9}, 
   3.665820464810173*^9, {3.665820594750372*^9, 3.665820704710857*^9}, {
   3.6658208043554277`*^9, 3.665820821634694*^9}, {3.6658220848217363`*^9, 
   3.665822085018384*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9870612`", 
      RowBox[{"-", "0.0129388`"}], "0.`"},
     {"0.08015490000000002`", "0.9801549`", "0.`"},
     {
      RowBox[{"-", "5.32823`*^-15"}], 
      RowBox[{"-", "5.32823`*^-15"}], "1.0067799999999947`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6658208776071987`*^9, 3.665820878665946*^9}, 
   3.665820911061158*^9, 3.6658214156577*^9, 3.665821586270327*^9, 
   3.665821699938002*^9, {3.665821929745879*^9, 3.6658219328860073`*^9}, {
   3.665822068566183*^9, 3.665822096290595*^9}, 3.665822169631205*^9, 
   3.6659815001156673`*^9, 3.665984103848712*^9, 3.665986756257407*^9, 
   3.66598711762694*^9, 3.665987451616212*^9, 3.665988810636813*^9, 
   3.665989408746138*^9, 3.665989760962449*^9, 3.665989801935042*^9, 
   3.6659912365537233`*^9, 3.6659916356050367`*^9, 3.6659916731674023`*^9, 
   3.665991804400981*^9, 3.665992159565637*^9, 3.666112389545637*^9, 
   3.6661129523940077`*^9, 3.666113402233933*^9, 3.66611343462683*^9, 
   3.666115302771503*^9, 3.66612412388372*^9, 3.666129869266058*^9, 
   3.6661303609468307`*^9, 3.666377730716422*^9, 3.66646016618712*^9, 
   3.666460216134433*^9, 3.666473690095275*^9, 3.6664737552537737`*^9, 
   3.666473832854155*^9, 3.666499685763027*^9, 3.666502741446466*^9, 
   3.66650410281299*^9, 3.666505873838737*^9, 3.666507997241647*^9, 
   3.666508948662949*^9, 3.6665423391762953`*^9, 3.666571965270358*^9, 
   3.666629434355438*^9, 3.6667148136302147`*^9, 3.666717168285803*^9, 
   3.666766437151308*^9, 3.6667664997833*^9, 3.6668421928567142`*^9, 
   3.666845254686414*^9, 3.6668454136320457`*^9, 3.66685143314261*^9, 
   3.6668525095203753`*^9, 3.6668528709736633`*^9, 3.666858909577849*^9, 
   3.6669373287686853`*^9, 3.666937358851318*^9, 3.666937857818572*^9, 
   3.666939823524315*^9, 3.667244802813081*^9, 3.6674115825498543`*^9, 
   3.667411698098057*^9, 3.668181602320546*^9, 3.668182009759986*^9, 
   3.668631768252915*^9, 3.668746639030415*^9, 3.6687498187441187`*^9, {
   3.668751245626354*^9, 3.6687512705234747`*^9}, 3.668752074701642*^9, 
   3.668922806716629*^9, 3.668923061910617*^9, 3.669272801469314*^9, 
   3.669433050983214*^9, 3.669739248011902*^9, 3.669749723480019*^9, 
   3.6703442682547913`*^9, {3.6726900308503017`*^9, 3.672690056840631*^9}, 
   3.672690832892976*^9, 3.672691496679309*^9, 3.673802472874209*^9, 
   3.673802512335977*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"TetRefShapeMatrix", "[", 
     RowBox[{"getTet", "[", 
      RowBox[{"pts", ",", " ", "tet2"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"TetRefShapeMatrix", "[", 
      RowBox[{"getTet", "[", 
       RowBox[{"initpts", ",", " ", "tet2"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F2", "[", "curpts", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6658172182160254`*^9, 3.665817237521982*^9}, {
  3.6658176589945803`*^9, 3.6658177049778843`*^9}, {3.66581882657384*^9, 
  3.6658188330337152`*^9}, {3.665819077498995*^9, 3.665819086996098*^9}, {
  3.6658191684777718`*^9, 3.665819182354837*^9}, {3.6658194257764397`*^9, 
  3.665819427245984*^9}, {3.6658202113303003`*^9, 3.665820229385047*^9}, {
  3.665820508982215*^9, 3.665820512211378*^9}, {3.6658205894468412`*^9, 
  3.665820590133255*^9}, {3.665820764783145*^9, 3.665820767984336*^9}, {
  3.66582209397727*^9, 3.6658220941876707`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.9870612`", 
      RowBox[{"-", "0.08101940000000002`"}], "0.`"},
     {"0.08015490000000002`", "0.9977081000000001`", "0.`"},
     {
      RowBox[{"-", "5.32823`*^-15"}], 
      RowBox[{"-", "5.087770000000001`*^-15"}], "1.0067799999999947`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665818833512567*^9, 3.66581908815532*^9, {3.665819175068791*^9, 
   3.665819195263817*^9}, 3.6658192530311747`*^9, 3.665819305222872*^9, 
   3.665819430589574*^9, 3.665819745706252*^9, 3.66581987834511*^9, 
   3.6658200024965553`*^9, {3.6658202129389133`*^9, 3.665820229743659*^9}, 
   3.665820269648944*^9, 3.6658203792174797`*^9, 3.665820513345636*^9, 
   3.665820590574997*^9, 3.665820768483539*^9, 3.665820817900959*^9, {
   3.665820877646851*^9, 3.665820878693112*^9}, 3.6658209110849447`*^9, 
   3.665821415667962*^9, 3.665821586294506*^9, 3.665821699974869*^9, 
   3.665821932904676*^9, {3.665822091483528*^9, 3.665822096318234*^9}, 
   3.665822169655383*^9, 3.665981500186666*^9, 3.665984103873178*^9, 
   3.6659867562807713`*^9, 3.6659871176598988`*^9, 3.665987451644825*^9, 
   3.665988810669218*^9, 3.6659894087753363`*^9, 3.6659897609878473`*^9, 
   3.6659898020107527`*^9, 3.665991236654931*^9, 3.665991636097868*^9, 
   3.665991673481059*^9, 3.665991804498921*^9, 3.665992160033626*^9, 
   3.6661123896355124`*^9, 3.666112952551796*^9, 3.666113402251965*^9, 
   3.666113434656604*^9, 3.666115302799309*^9, 3.666124123957518*^9, 
   3.66612986930678*^9, 3.666130360979907*^9, 3.666377731007221*^9, 
   3.666460166212109*^9, 3.666460216269622*^9, 3.6664736902849092`*^9, 
   3.666473755264332*^9, 3.666473832876745*^9, 3.666499685834056*^9, 
   3.666502741517104*^9, 3.666504103166453*^9, 3.666505873924302*^9, 
   3.666507997633595*^9, 3.6665089487788553`*^9, 3.666542339197195*^9, 
   3.6665719652783403`*^9, 3.666629434422462*^9, 3.666714813658804*^9, 
   3.666717168318541*^9, 3.6667664372326393`*^9, 3.666766499852458*^9, 
   3.666842192874434*^9, 3.666845254772057*^9, 3.666845413746859*^9, 
   3.66685143316658*^9, 3.666852509539097*^9, 3.666852870996531*^9, 
   3.6668589096585217`*^9, 3.6669373288487577`*^9, 3.66693735894473*^9, 
   3.666937857833106*^9, 3.6669398235440283`*^9, 3.6672448028988237`*^9, 
   3.667411582633834*^9, 3.66741169818213*^9, 3.668181602395892*^9, 
   3.6681820097768517`*^9, 3.668631768352181*^9, 3.668746639106731*^9, 
   3.668749818926696*^9, {3.66875124565226*^9, 3.668751270542398*^9}, 
   3.668752074720738*^9, 3.6689228068019037`*^9, 3.668923062006242*^9, 
   3.6692728014873533`*^9, 3.6694330510619497`*^9, 3.66973924803344*^9, 
   3.669749723554797*^9, 3.670344268335726*^9, {3.6726900308855257`*^9, 
   3.6726900568782587`*^9}, 3.6726908352933493`*^9, 3.6726914967611*^9, 
   3.673802472956338*^9, 3.673802512466858*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnergyDensity", "[", "F_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"mu", "/", "2.0"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "F", "]"}], ".", "F"}], "]"}], " ", "-", 
       "3"}], ")"}]}], " ", "-", " ", 
    RowBox[{"mu", "*", 
     RowBox[{"Log", "[", 
      RowBox[{"Det", "[", "F", "]"}], "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lambda", "/", "2.0"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"Log", "[", 
       RowBox[{"Det", "[", "F", "]"}], "]"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"Log", "[", 
       RowBox[{"Det", "[", "F", "]"}], "]"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.665819873359787*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tet1Vol", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.0", "/", "6.0"}], ")"}], "*", 
     RowBox[{"Det", "[", 
      RowBox[{"TetRefShapeMatrix", "[", 
       RowBox[{"getTet", "[", 
        RowBox[{"initpts", ",", "tet1"}], "]"}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tet2Vol", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.0", "/", "6.0"}], ")"}], "*", 
     RowBox[{"Det", "[", 
      RowBox[{"TetRefShapeMatrix", "[", 
       RowBox[{"getTet", "[", 
        RowBox[{"initpts", ",", "tet2"}], "]"}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalE", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Tet1Vol", "*", 
    RowBox[{"EnergyDensity", "[", 
     RowBox[{"F1", "[", "pts", "]"}], "]"}]}], " ", "+", 
   RowBox[{"Tet2Vol", "*", 
    RowBox[{"EnergyDensity", "[", 
     RowBox[{"F2", "[", "pts", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6658177667574253`*^9, 3.66581779469621*^9}, {
  3.66581782870572*^9, 3.6658179404396753`*^9}, {3.665818634359209*^9, 
  3.66581866382008*^9}, {3.6658192957892714`*^9, 3.665819302609071*^9}, {
  3.665819687134677*^9, 3.66581973747373*^9}, {3.665821410360219*^9, 
  3.665821411632032*^9}, {3.6658221644905567`*^9, 3.66582216578117*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalE", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.673802540845549*^9, 3.673802545674062*^9}}],

Cell[BoxData["5494.533283441481`"], "Output",
 CellChangeTimes->{3.6738025471248007`*^9, 3.6738026304582253`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dEnergy", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"totalE", "[", "restpts", "]"}], ",", " ", 
       RowBox[{"{", "restpts", "}"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", "\[Rule]", " ", "pts"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6658184079700108`*^9, 3.6658184467332163`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dEnergy", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.665818449502461*^9, 3.665818473385376*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"11650.916587414376`"},
      {
       RowBox[{"-", "49807.00183080404`"}]},
      {"8.073286004627886`*^-9"},
      {
       RowBox[{"-", "51229.90254079473`"}]},
      {"9032.456391594638`"},
      {"4.034858559252261`*^-9"},
      {"7.344700703741012`*^-9"},
      {"8.160828040265929`*^-9"},
      {
       RowBox[{"-", "42042.43537758661`"}]},
      {"39828.735679574354`"},
      {"37698.20175893289`"},
      {"42042.43537757858`"},
      {
       RowBox[{"-", "249.7497262012914`"}]},
      {"3076.343680268479`"},
      {
       RowBox[{"-", "3.852689235704182`*^-9"}]}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.665818461791885*^9, 3.665818473837757*^9}, 
   3.665818568494573*^9, 3.665818666794723*^9, 3.665819195356143*^9, 
   3.6658192531423798`*^9, 3.6658193052901573`*^9, 3.665819430666198*^9, 
   3.665819745770836*^9, 3.6658198784128227`*^9, 3.665820002573872*^9, 
   3.66582022534439*^9, 3.665820269738641*^9, 3.665820379279245*^9, 
   3.665820818113863*^9, {3.6658208777285233`*^9, 3.665820878792663*^9}, 
   3.665820911152914*^9, 3.665821415767662*^9, 3.66582158637994*^9, 
   3.665821700080957*^9, 3.665821932995723*^9, {3.665822091618211*^9, 
   3.665822096434669*^9}, 3.665822169724329*^9, 3.6659815004420633`*^9, 
   3.6659841039297523`*^9, 3.665986756333231*^9, 3.6659871177265177`*^9, 
   3.665987451705027*^9, 3.665988810749756*^9, 3.6659894088307056`*^9, 
   3.6659897610463057`*^9, 3.665989802644212*^9, 3.665991237172103*^9, 
   3.66599163649263*^9, 3.665991673699986*^9, 3.665991804786628*^9, 
   3.66599216065373*^9, 3.66599223947161*^9, 3.666112390039447*^9, 
   3.666112953359177*^9, 3.6661134023031263`*^9, 3.666113434713831*^9, 
   3.666115302880859*^9, 3.666124124367134*^9, 3.666129869404887*^9, 
   3.666130361031248*^9, 3.66637773139601*^9, 3.666460166260347*^9, 
   3.666460216550387*^9, 3.66647369125513*^9, 3.666473755313726*^9, 
   3.666473832919179*^9, 3.66649968609026*^9, 3.6665027418698273`*^9, 
   3.666504103576886*^9, 3.666505874661335*^9, 3.666507997981112*^9, 
   3.6665089492368813`*^9, 3.6665423392438803`*^9, 3.666571965348123*^9, 
   3.666629434693994*^9, 3.66671481371625*^9, 3.6667171683724117`*^9, 
   3.666766437483242*^9, 3.6667665002017097`*^9, 3.666842192929147*^9, 
   3.6668452552229633`*^9, 3.666845414280883*^9, 3.6668514332247887`*^9, 
   3.666852509589905*^9, 3.6668528710524473`*^9, 3.6668589102303123`*^9, 
   3.6669373292339907`*^9, 3.666937359404911*^9, 3.6669378578748903`*^9, 
   3.666939823590703*^9, 3.667244803172515*^9, 3.667411583066992*^9, 
   3.667411698555161*^9, 3.6681816027316103`*^9, 3.668182009824155*^9, 
   3.66863176874304*^9, 3.668746639360221*^9, 3.668749819465564*^9, {
   3.6687512456988287`*^9, 3.668751270590952*^9}, 3.668752074767188*^9, 
   3.66892280721789*^9, 3.6689230624081*^9, 3.6692728016843443`*^9, 
   3.669433051321369*^9, 3.6697392480896807`*^9, 3.669749724027055*^9, 
   3.6703442687033873`*^9, {3.672690030972054*^9, 3.672690056939542*^9}, 
   3.672690843169675*^9, 3.672691497347739*^9, 3.673802473296879*^9, 
   3.673802512988328*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dForces", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dEnergy", "[", "restpts", "]"}], ",", " ", 
      RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", " ", "\[Rule]", " ", "pts"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665818397348877*^9, 3.665818401149044*^9}, {
  3.665819465805282*^9, 3.665819480092683*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dForces", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.665819486010705*^9, 3.665819493766698*^9}, {
  3.665989264661373*^9, 3.66598926525727*^9}, {3.665989758117057*^9, 
  3.6659897589996233`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "141170.4518276522`"}], "422.1508033335716`", 
      "1.1604333366227772`*^-15", 
      RowBox[{"-", "502.53257587782747`"}], "82330.99639169476`", 
      RowBox[{"-", "1.3827376515849872`*^-14"}], "5.03831600060489`*^-11", 
      "8.443506327278752`*^-10", "159880.51816094713`", "141335.59253277612`", 
      RowBox[{"-", "2335.2964394329465`"}], 
      RowBox[{"-", "159880.51816094713`"}], "337.39187075384496`", 
      RowBox[{"-", "80417.85075559623`"}], "9.283466692982218`*^-15"},
     {"422.1508033335716`", 
      RowBox[{"-", "151486.38708920055`"}], "9.423358663037362`*^-17", 
      RowBox[{"-", "76149.23240189509`"}], "81.6916199123008`", 
      RowBox[{"-", "1.825320255637944`*^-16"}], 
      RowBox[{"-", "7.863084666875025`*^-10"}], "2.289582224934203`*^-12", 
      "7531.909576378666`", 
      RowBox[{"-", "563.3816310522234`"}], "151742.08697385096`", 
      RowBox[{"-", "7531.909576378666`"}], "76290.46322961454`", 
      RowBox[{"-", "337.39150456272745`"}], "7.538686930429889`*^-16"},
     {"1.1604333366227772`*^-15", "9.423358663037362`*^-17", 
      RowBox[{"-", "151515.15151515152`"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "149704.82025017333`"}], 
      RowBox[{"-", "7115.7369386573555`"}], "1.1452074986391143`*^-15", 
      "149704.82025017333`", "7115.7369386573555`", "151515.15151515152`", 
      "9.32280875074233`*^-17", 
      RowBox[{"-", "1.1480499374184519`*^-15"}], "2.565206575048261`*^-33"},
     {
      RowBox[{"-", "502.53257587782747`"}], 
      RowBox[{"-", "76149.23240189509`"}], "0.`", 
      RowBox[{"-", "75716.47975492738`"}], 
      RowBox[{"-", "506.0734863285992`"}], "1.1307722706791499`*^-15", 
      RowBox[{"-", "2.442082870714867`*^-12"}], 
      RowBox[{"-", "4.0568654571287897`*^-10"}], 
      RowBox[{"-", "6555.31944976634`"}], "76219.0123308052`", 
      "76655.3058882241`", "6555.31944976634`", "0", "0", "0"},
     {"82330.99639169476`", "81.6916199123008`", "0.`", 
      RowBox[{"-", "506.0734863285992`"}], 
      RowBox[{"-", "69525.57368778726`"}], 
      RowBox[{"-", "1.3924806024625899`*^-14"}], "4.330459573810181`*^-10", 
      "3.34142634222717`*^-11", "80724.96481774293`", 
      RowBox[{"-", "81824.92290536659`"}], "69443.88206787492`", 
      RowBox[{"-", "80724.96481774293`"}], "0", "0", "0"},
     {
      RowBox[{"-", "1.3827376515849872`*^-14"}], 
      RowBox[{"-", "1.825320255637944`*^-16"}], "0.`", 
      "1.1307722706791499`*^-15", 
      RowBox[{"-", "1.3924806024625899`*^-14"}], 
      RowBox[{"-", "75757.57575757576`"}], "6062.1013282858485`", 
      RowBox[{"-", "74651.26912539876`"}], 
      RowBox[{"-", "1.3571085731582402`*^-14"}], 
      RowBox[{"-", "6062.1013282858485`"}], "74651.26912539876`", 
      "75757.57575757576`", "0", "0", "0"},
     {"5.03831600060489`*^-11", 
      RowBox[{"-", "7.863084666875025`*^-10"}], 
      RowBox[{"-", "149704.82025017333`"}], 
      RowBox[{"-", "2.442082870714867`*^-12"}], "4.330459573810181`*^-10", 
      "6062.1013282858485`", 
      RowBox[{"-", "151515.15151515152`"}], "2.7265640616575598`*^-25", 
      "4.956041030448817`*^-11", "151515.15151515146`", 
      "7.771749339171969`*^-10", "149714.41120889477`", 
      "1.6486161233246542`*^-12", 
      RowBox[{"-", "4.239124246107129`*^-10"}], 
      RowBox[{"-", "6071.692287007328`"}]},
     {"8.443506327278752`*^-10", "2.289582224934203`*^-12", 
      RowBox[{"-", "7115.7369386573555`"}], 
      RowBox[{"-", "4.0568654571287897`*^-10"}], "3.34142634222717`*^-11", 
      RowBox[{"-", "74651.26912539876`"}], "2.7265640616575598`*^-25", 
      RowBox[{"-", "151515.15151515152`"}], "5.5067392079189894`*^-11", 
      RowBox[{"-", "8.441065759160974`*^-10"}], "151515.1515151515`", 
      "6997.629833230516`", "4.0544248890110097`*^-10", 
      RowBox[{"-", "2.2557773901980708`*^-11"}], "74769.37623082552`"},
     {"159880.51816094713`", "7531.909576378666`", "1.1452074986391143`*^-15", 
      RowBox[{"-", "6555.31944976634`"}], "80724.96481774293`", 
      RowBox[{"-", "1.3571085731582402`*^-14"}], "4.956041030448817`*^-11", 
      "5.5067392079189894`*^-11", 
      RowBox[{"-", "141505.6212634528`"}], 
      RowBox[{"-", "159729.8560106306`"}], 
      RowBox[{"-", "9387.226754568619`"}], "141505.6212634528`", 
      "6404.657299449731`", 
      RowBox[{"-", "78869.64763955305`"}], "9.161659989112915`*^-15"},
     {"141335.59253277612`", 
      RowBox[{"-", "563.3816310522234`"}], "149704.82025017333`", 
      "76219.0123308052`", 
      RowBox[{"-", "81824.92290536659`"}], 
      RowBox[{"-", "6062.1013282858485`"}], "151515.15151515146`", 
      RowBox[{"-", "8.441065759160974`*^-10"}], 
      RowBox[{"-", "159729.8560106306`"}], 
      RowBox[{"-", "444462.8345302588`"}], "1636.662339401878`", 
      "10015.444801735786`", "75393.0781515261`", "80751.64219701778`", 
      "6071.692287007328`"},
     {
      RowBox[{"-", "2335.2964394329465`"}], "151742.08697385096`", 
      "7115.7369386573555`", "76655.3058882241`", "69443.88206787492`", 
      "74651.26912539876`", "7.771749339171969`*^-10", "151515.1515151515`", 
      RowBox[{"-", "9387.226754568619`"}], "1636.662339401878`", 
      RowBox[{"-", "444685.63941575075`"}], "2389.596921338043`", 
      RowBox[{"-", "75956.67178819381`"}], "71984.51885887347`", 
      RowBox[{"-", "74769.37623082552`"}]},
     {
      RowBox[{"-", "159880.51816094713`"}], 
      RowBox[{"-", "7531.909576378666`"}], "151515.15151515152`", 
      "6555.31944976634`", 
      RowBox[{"-", "80724.96481774293`"}], "75757.57575757576`", 
      "149714.41120889477`", "6997.629833230516`", "141505.6212634528`", 
      "10015.444801735786`", "2389.596921338043`", 
      RowBox[{"-", "444535.9242937558`"}], 
      RowBox[{"-", "6404.657299449731`"}], "78869.64763955305`", 
      "75757.57575757576`"},
     {"337.39187075384496`", "76290.46322961454`", "9.32280875074233`*^-17", 
      "0", "0", "0", "1.6486161233246542`*^-12", "4.0544248890110097`*^-10", 
      "6404.657299449731`", "75393.0781515261`", 
      RowBox[{"-", "75956.67178819381`"}], 
      RowBox[{"-", "6404.657299449731`"}], 
      RowBox[{"-", "75730.47002227994`"}], 
      RowBox[{"-", "333.79144142112824`"}], "7.458247000593864`*^-16"},
     {
      RowBox[{"-", "80417.85075559623`"}], 
      RowBox[{"-", "337.39150456272745`"}], 
      RowBox[{"-", "1.1480499374184519`*^-15"}], "0", "0", "0", 
      RowBox[{"-", "4.239124246107129`*^-10"}], 
      RowBox[{"-", "2.2557773901980708`*^-11"}], 
      RowBox[{"-", "78869.64763955305`"}], "80751.64219701778`", 
      "71984.51885887347`", "78869.64763955305`", 
      RowBox[{"-", "333.79144142112824`"}], 
      RowBox[{"-", "71647.12735431072`"}], 
      RowBox[{"-", "9.184399499347615`*^-15"}]},
     {"9.283466692982218`*^-15", "7.538686930429889`*^-16", 
      "2.565206575048261`*^-33", "0", "0", "0", 
      RowBox[{"-", "6071.692287007328`"}], "74769.37623082552`", 
      "9.161659989112915`*^-15", "6071.692287007328`", 
      RowBox[{"-", "74769.37623082552`"}], "75757.57575757576`", 
      "7.458247000593864`*^-16", 
      RowBox[{"-", "9.184399499347615`*^-15"}], 
      RowBox[{"-", "75757.57575757576`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665819494316019*^9, 3.6658197457988777`*^9, 3.665819878449224*^9, 
   3.6658200026146812`*^9, 3.665820225369669*^9, 3.66582026977431*^9, 
   3.665820379308507*^9, {3.665820877339468*^9, 3.665820878830647*^9}, 
   3.66582091118386*^9, 3.6658214157959747`*^9, 3.6658215864095488`*^9, 
   3.66582170012844*^9, 3.6658219330462427`*^9, {3.6658220917277412`*^9, 
   3.6658220966145563`*^9}, 3.66582216989219*^9, 3.665981500822032*^9, 
   3.665984104103979*^9, 3.665986756510659*^9, 3.665987117913021*^9, 
   3.665987451892099*^9, 3.665988810946394*^9, 3.665989265832843*^9, 
   3.6659894090013227`*^9, 3.665989761214164*^9, 3.665989802928381*^9, 
   3.6659912374825974`*^9, 3.66599163680555*^9, {3.665991673989674*^9, 
   3.665991706995091*^9}, 3.66599176918725*^9, 3.6659918053252707`*^9, 
   3.665992161127952*^9, 3.666112390497651*^9, 3.6661129540599403`*^9, 
   3.666113402467512*^9, 3.666113434886098*^9, 3.666115303036511*^9, 
   3.6661241246399717`*^9, 3.6661298696976643`*^9, 3.666130361216258*^9, 
   3.6663777318918543`*^9, 3.666460166417659*^9, 3.666460217016794*^9, 
   3.666473691930655*^9, 3.66647375546032*^9, 3.666473833077437*^9, 
   3.666499686455896*^9, 3.666502742128141*^9, 3.666504103846704*^9, 
   3.666505874933177*^9, 3.666507998262681*^9, 3.66650894951017*^9, 
   3.666542339412682*^9, 3.666571965549282*^9, 3.666629435057513*^9, 
   3.6667148138789682`*^9, 3.666717168535828*^9, 3.666766437859003*^9, 
   3.666766500489286*^9, 3.666842193129088*^9, 3.666845255592387*^9, 
   3.666845414672682*^9, 3.66685143339793*^9, 3.666852509755856*^9, 
   3.666852871223268*^9, 3.666858910510088*^9, 3.6669373296421633`*^9, 
   3.666937359788526*^9, 3.666937858043984*^9, 3.666939823745625*^9, 
   3.667244803543956*^9, 3.667411583335947*^9, 3.667411698859833*^9, 
   3.6681816030822144`*^9, 3.668182009980668*^9, 3.6686317690231028`*^9, 
   3.668746639735202*^9, 3.668749819754383*^9, {3.668751245867876*^9, 
   3.668751270747736*^9}, 3.6687520749418583`*^9, 3.668922807655776*^9, 
   3.668923062622285*^9, 3.669272801961437*^9, 3.669433051707533*^9, 
   3.66973924824771*^9, 3.669749724349262*^9, 3.670344268985132*^9, {
   3.672690031168705*^9, 3.672690057224166*^9}, 3.672691497750311*^9, 
   3.673802473574696*^9, 3.6738025133088827`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rayleigh", " ", "=", " ", "0.0"}], ";"}]], "Input",
 CellChangeTimes->{{3.666715760544108*^9, 3.6667157754665613`*^9}, 
   3.6667664967255287`*^9, 3.6668454085840893`*^9, {3.6668524991021767`*^9, 
   3.666852508395296*^9}, {3.6681820021928377`*^9, 3.668182002477705*^9}, {
   3.668749829799849*^9, 3.668749829949445*^9}, 3.668923058606982*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.665984057256852*^9, {3.665987449073557*^9, 3.6659874492202806`*^9}, {
   3.665989375327712*^9, 3.665989385968883*^9}, {3.6659897789775333`*^9, 
   3.665989787816156*^9}, {3.666715531660207*^9, 3.666715548139943*^9}, {
   3.6667155944145393`*^9, 3.666715669531475*^9}, {3.666715749854607*^9, 
   3.6667157550957117`*^9}, {3.666715787024631*^9, 3.666715827324765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invmasses", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "0.012", ",", " ", "0.012", ",", " ", "0.012", ",", " ", "0.024", ",", 
      "0.024", ",", "0.024", ",", " ", "0.012", ",", " ", "0.012", ",", " ", 
      "0.012", ",", " ", "0.012", ",", " ", "0.012", ",", " ", "0.012", ",", 
      " ", "0.024", ",", "0.024", ",", "0.024"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665986678862368*^9, 3.665986747691082*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invmasses", " ", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.012`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.012`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.012`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.024`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.024`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.024`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.012`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.012`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.024`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.024`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.024`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665984070260168*^9, 3.6659841041510363`*^9, 3.6659867565600843`*^9, {
   3.665987096860158*^9, 3.66598711797351*^9}, 3.665987451953442*^9, 
   3.665988810990713*^9, 3.665989409047825*^9, 3.6659897612528267`*^9, 
   3.665989803073517*^9, 3.66599123769427*^9, 3.665991637212249*^9, 
   3.665991674196629*^9, 3.665991805718596*^9, 3.665992161337792*^9, 
   3.666112390714347*^9, 3.6661129545225363`*^9, 3.66611340250389*^9, 
   3.66611343493856*^9, 3.666115303074355*^9, 3.6661241247799807`*^9, 
   3.6661298697471027`*^9, 3.6661303613493233`*^9, 3.6663777322261553`*^9, 
   3.66646016646819*^9, 3.666460217117044*^9, 3.666473692137288*^9, 
   3.666473755576033*^9, 3.666473833108302*^9, 3.666499686641493*^9, 
   3.666502742307807*^9, 3.6665041041832743`*^9, 3.666505875329616*^9, 
   3.666507998566485*^9, 3.666508949709326*^9, 3.666542339441934*^9, 
   3.6665719655813932`*^9, 3.666629435205286*^9, 3.666714813950289*^9, 
   3.666717168581793*^9, 3.666766438081914*^9, 3.666766500735134*^9, 
   3.666842193165846*^9, 3.666845255939577*^9, 3.666845414902789*^9, 
   3.666851433445643*^9, 3.66685250979493*^9, 3.6668528712680283`*^9, 
   3.666858910786313*^9, {3.666937330386547*^9, 3.666937360032557*^9}, 
   3.666937858090844*^9, 3.6669398237834873`*^9, 3.6672448037299423`*^9, 
   3.667411583581725*^9, 3.667411699422639*^9, 3.6681816033329163`*^9, 
   3.668182010039822*^9, 3.668631769228538*^9, 3.668746639905718*^9, 
   3.668749820226378*^9, {3.668751245937681*^9, 3.668751270783656*^9}, 
   3.668752074983103*^9, 3.6689228080522842`*^9, 3.6689230628754587`*^9, 
   3.669272802279983*^9, 3.669433051936325*^9, 3.6697392482885303`*^9, 
   3.6697497246199102`*^9, 3.670344269243042*^9, {3.6726900312888603`*^9, 
   3.672690057312936*^9}, 3.6726914981479053`*^9, 3.6738024737714157`*^9, 
   3.673802513637494*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Step", "[", "inp_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"posguess", ",", " ", "eqns", ",", " ", "sol"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"posguess", " ", "=", " ", 
      RowBox[{"inp", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"eqns", " ", "=", " ", 
        RowBox[{"Thread", "[", " ", 
         RowBox[{"restpts", "-", 
          RowBox[{"(", 
           RowBox[{"posguess", "+", 
            RowBox[{"timestep", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"inp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"timestep", "*", 
                RowBox[{"invmasses", ".", 
                 RowBox[{"dEnergy", "[", "restpts", "]"}]}]}], "+", 
               RowBox[{"rayleigh", "*", 
                RowBox[{"invmasses", ".", 
                 RowBox[{"dForces", "[", "restpts", "]"}], ".", 
                 RowBox[{"(", 
                  RowBox[{"restpts", "-", " ", "posguess"}], ")"}]}]}]}], 
              ")"}]}]}], ")"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{"Thread", "[", 
       RowBox[{"restpts", " ", "-", " ", "posguess", " ", "-", " ", 
        RowBox[{"timestep", "*", 
         RowBox[{"inp", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", " ", 
        RowBox[{"timestep", "*", "timestep", "*", 
         RowBox[{"invmasses", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dEnergy", "[", "restpts", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
             RowBox[{
              RowBox[{"dForces", "[", "restpts", "]"}], ".", 
              RowBox[{"(", 
               RowBox[{"restpts", "-", "posguess"}], ")"}]}]}]}], ")"}]}]}]}],
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eqns", ",", 
            RowBox[{"{", "restpts", "}"}]}], "]"}], "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"restpts", "\[Rule]", "posguess"}], "]"}]}], "]"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eqns", ",", " ", 
            RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"restpts", "\[Rule]", "posguess"}], "]"}]}], "]"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{"eqns", ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"restpts", ",", "posguess"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"restpts", "/.", "sol"}], ",", 
       RowBox[{
        RowBox[{"inp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"timestep", "*", 
         RowBox[{"invmasses", ".", 
          RowBox[{"dEnergy", "[", 
           RowBox[{"restpts", "/.", "sol"}], "]"}]}]}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6661133909459887`*^9, 3.666113391200819*^9}, {
   3.666113429299081*^9, 3.666113432779141*^9}, {3.66645729696414*^9, 
   3.666457300249012*^9}, {3.666500946868992*^9, 3.666501021032815*^9}, {
   3.6665020705097513`*^9, 3.666502123560763*^9}, {3.666502201463656*^9, 
   3.6665023651887302`*^9}, 3.66650248825574*^9, {3.6665025236756887`*^9, 
   3.666502560406445*^9}, {3.666502610204982*^9, 3.666502706471566*^9}, {
   3.666509114855842*^9, 3.666509119501731*^9}, {3.666717744947791*^9, 
   3.666717746208692*^9}, {3.666718191308469*^9, 3.666718242010659*^9}, {
   3.6668434634198503`*^9, 3.6668434645594997`*^9}, {3.666843525344792*^9, 
   3.6668435494150877`*^9}, {3.666843632319791*^9, 3.6668437738429623`*^9}, 
   3.6668444473462543`*^9, {3.666845124103323*^9, 3.666845151698298*^9}, {
   3.666852436785735*^9, 3.666852440088503*^9}, {3.666853165412726*^9, 
   3.666853167663986*^9}, {3.666854027991631*^9, 3.6668540873060513`*^9}, {
   3.666854120753264*^9, 3.666854250889319*^9}, {3.666854282398582*^9, 
   3.666854322803748*^9}, {3.66685647899442*^9, 3.666856506304409*^9}, {
   3.666858746645891*^9, 3.666858751495479*^9}, {3.666861075315736*^9, 
   3.666861093992433*^9}, 3.6668611495777617`*^9, 3.668182089371738*^9, {
   3.668746854728492*^9, 3.668746858092985*^9}, {3.668751308370121*^9, 
   3.668751309790139*^9}, {3.668751510125621*^9, 3.668751513029649*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newpts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0", ",", 
     "0", ",", "10", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "9"}], ",", "0"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", " ", "0", ",", " ", "0", 
     ",", " ", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.668182229855485*^9, 3.668182230612989*^9}, 
   3.668182284352306*^9, 3.672723307370821*^9, {3.672723372804064*^9, 
   3.672723373529932*^9}}],

Cell[CellGroupData[{

Cell[BoxData["curpts"], "Input",
 CellChangeTimes->{{3.6681822935899343`*^9, 3.6681822942846613`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10", ",", "1", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0.129388`", 
   ",", "0.198451`", ",", "10.0678`", ",", "0.129388`", ",", "0.198451`", ",",
    "5.32823`*^-14", ",", "0.939582`", ",", 
   RowBox[{"-", "9.77863`"}], ",", "1.0416000000000001`*^-13"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.668182294563002*^9, 3.668631769452467*^9, 3.668746640104899*^9, 
   3.668749820354826*^9, {3.6687512459715548`*^9, 3.668751270818191*^9}, 
   3.6687520750205097`*^9, 3.668922808402351*^9, 3.66892306306616*^9, 
   3.66927280247469*^9, 3.66943305213037*^9, 3.6697392483234587`*^9, 
   3.6697497249752293`*^9, 3.6703442694314547`*^9, {3.672690031346843*^9, 
   3.6726900573688383`*^9}, 3.672691498387188*^9, 3.673802473956963*^9, 
   3.6738025140258913`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalE", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.6681825779766817`*^9, 3.668182581896802*^9}, {
  3.668183574304394*^9, 3.6681835749981318`*^9}, {3.672723290880045*^9, 
  3.6727232916169777`*^9}}],

Cell[BoxData["34227.039434557504`"], "Output",
 CellChangeTimes->{
  3.668182582658366*^9, 3.6681835754709053`*^9, 3.668631769542738*^9, 
   3.668746640189302*^9, 3.66874982044576*^9, {3.668751245995556*^9, 
   3.668751270837284*^9}, 3.668752075040188*^9, 3.66892280855445*^9, 
   3.66892306314217*^9, 3.669272802560979*^9, 3.6694330522064943`*^9, 
   3.6697392483577347`*^9, 3.669749725121557*^9, 3.6703442695435677`*^9, {
   3.6726900314028273`*^9, 3.6726900574139557`*^9}, 3.672691498464181*^9, 
   3.67272329276754*^9, 3.6727233773241787`*^9, 3.673802474045105*^9, 
   3.6738025141300163`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Step", "[", 
    RowBox[{"{", 
     RowBox[{"curpts", ",", " ", "vels"}], "}"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.668181733765348*^9, 3.6681817527995996`*^9}, {
  3.6681820987119217`*^9, 3.668182101813828*^9}, {3.668923107512109*^9, 
  3.6689231075971403`*^9}, {3.668923174782515*^9, 3.668923174940215*^9}, {
  3.669272820646551*^9, 3.669272820801038*^9}, {3.669436556341549*^9, 
  3.669436556496994*^9}, {3.6697392569880037`*^9, 3.669739259015113*^9}, {
  3.669749715870297*^9, 3.66974971602521*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"10.011494588717113`"},
      {"0.9579635674650958`"},
      {"0.018042772501525924`"},
      {
       RowBox[{"-", "0.07869977359789526`"}]},
      {"10.00473275707213`"},
      {"0.0075626419430224025`"},
      {"0.13732455775696029`"},
      {"0.2017104436415838`"},
      {"10.023026063027237`"},
      {"0.1671760344061441`"},
      {"0.22158605673533294`"},
      {"0.03183584866768133`"},
      {"0.9338434118374592`"},
      {
       RowBox[{"-", "9.752078892756156`"}]},
      {"0.0022279896643013523`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6681817542529097`*^9, 3.668181758087675*^9}, {
   3.668182007002658*^9, 3.668182010672641*^9}, {3.668182092940421*^9, 
   3.668182102924376*^9}, 3.668631769967188*^9, 3.668746640625041*^9, 
   3.668746866176816*^9, 3.668749820992379*^9, {3.668751246636978*^9, 
   3.668751271355145*^9}, 3.668751326023732*^9, {3.668752074267742*^9, 
   3.668752078966434*^9}, 3.668922812610489*^9, 3.668923063578289*^9, 
   3.668923109059095*^9, {3.669272803017302*^9, 3.6692728224110413`*^9}, 
   3.669433052699903*^9, 3.6694365584097548`*^9, {3.669739248751996*^9, 
   3.669739259930752*^9}, {3.6697497169590607`*^9, 3.669749725828024*^9}, 
   3.670344270098349*^9, {3.6726900319232683`*^9, 3.6726900579038267`*^9}, 
   3.672691498972378*^9, 3.6738024746333227`*^9, 3.673802514610799*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "1", ",", "1", ",", "    ", "1", ",", "10", ",", "1", ",", 
     "    ", "0", ",", "0", ",", "10", ",", "    ", "0", ",", "0", ",", "0", 
     ",", "    ", "0", ",", 
     RowBox[{"-", "10"}], ",", " ", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", " ", "0", ",", " ", "0", 
     ",", " ", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6664738141031923`*^9, 3.66647381486491*^9}, {
   3.666474517849339*^9, 3.666474530371999*^9}, 3.666474599816292*^9, {
   3.666502753312029*^9, 3.666502753472618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "pts_", "]"}], " ", ":=", 
  RowBox[{"pts", " ", "-", " ", "curpts", " ", "-", " ", 
   RowBox[{"timestep", "*", "vels"}], " ", "-", " ", 
   RowBox[{"timestep", "*", "timestep", "*", 
    RowBox[{"invmasses", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dEnergy", "[", "pts", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
        RowBox[{
         RowBox[{"dForces", "[", "pts", "]"}], ".", 
         RowBox[{"(", 
          RowBox[{"pts", "-", "curpts"}], ")"}]}]}]}], ")"}]}]}]}]}]], "Input",\

 CellChangeTimes->{{3.6668530247177877`*^9, 3.6668530973770847`*^9}, {
   3.6668546505801973`*^9, 3.6668547516935387`*^9}, 3.6668548142070627`*^9, {
   3.6668578168701897`*^9, 3.666857828002372*^9}, {3.666859030472598*^9, 
   3.666859033486137*^9}}],

Cell[CellGroupData[{

Cell[BoxData["timestep"], "Input",
 CellChangeTimes->{{3.668183536965329*^9, 3.6681835376207943`*^9}}],

Cell[BoxData["0.01`"], "Output",
 CellChangeTimes->{
  3.6681835379799423`*^9, 3.668631770221793*^9, 3.668746640870826*^9, 
   3.668749821215106*^9, {3.6687512467012167`*^9, 3.668751271432111*^9}, 
   3.668752079169689*^9, 3.668922812882996*^9, 3.668923064044965*^9, 
   3.669272803267415*^9, 3.669433053188332*^9, 3.669739248783668*^9, 
   3.669749726100177*^9, 3.67034427034964*^9, {3.672690032159319*^9, 
   3.672690058005352*^9}, 3.6726914992623377`*^9, 3.673802474900175*^9, 
   3.673802514894259*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6668590495898867`*^9, 3.6668590566453533`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "0.023981099904897718`"}]},
      {"0.05976840219696489`"},
      {
       RowBox[{"-", "0.010000000000009689`"}]},
      {"0.11295176609790736`"},
      {
       RowBox[{"-", "0.021677895339827558`"}]},
      {
       RowBox[{"-", "9.683660542205426`*^-15"}]},
      {
       RowBox[{"-", "8.826273045769994`*^-15"}]},
      {
       RowBox[{"-", "9.797718192317006`*^-15"}]},
      {"0.050450922453103786`"},
      {
       RowBox[{"-", "0.04779448281548923`"}]},
      {
       RowBox[{"-", "0.04523784211071946`"}]},
      {
       RowBox[{"-", "0.0504509224530943`"}]},
      {"0.0005993993428831113`"},
      {
       RowBox[{"-", "0.007383224832643975`"}]},
      {"9.24645416569004`*^-15"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6668590523883266`*^9, 3.666859057295719*^9}, {
   3.666937330909051*^9, 3.6669373604347343`*^9}, 3.666937858309168*^9, 
   3.666939823953334*^9, 3.66724480411343*^9, 3.667411584091875*^9, 
   3.667411699973851*^9, 3.668181603758623*^9, 3.668182010916916*^9, 
   3.668631770443063*^9, 3.668746641138542*^9, 3.668749821426751*^9, {
   3.6687512468607817`*^9, 3.668751271592808*^9}, 3.668752079338028*^9, 
   3.6689228131126947`*^9, 3.668923064284225*^9, 3.669272803488264*^9, 
   3.669433053489243*^9, 3.669739249013486*^9, 3.669749726439042*^9, 
   3.670344270577859*^9, {3.672690032374168*^9, 3.672690058257786*^9}, 
   3.672691499550867*^9, 3.673802475122819*^9, 3.673802515114472*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gradG", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"g", "[", "restpts", "]"}], ",", " ", 
     RowBox[{"{", "restpts", "}"}]}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"restpts", "\[Rule]", "pts"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.666854758038537*^9, 3.6668548073161793`*^9}, {
  3.666858321058577*^9, 3.666858322960808*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gradG", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6668609340237293`*^9, 3.666860958270793*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1.1694045421931827`", 
      RowBox[{"-", "0.000506580964000286`"}], 
      RowBox[{"-", "1.3925200039473327`*^-21"}], "0.000603039091053393`", 
      RowBox[{"-", "0.09879719567003373`"}], "1.6592851819019848`*^-20", 
      RowBox[{"-", "6.045979200725868`*^-17"}], 
      RowBox[{"-", "1.0132207592734504`*^-15"}], 
      RowBox[{"-", "0.1918566217931366`"}], 
      RowBox[{"-", "0.16960271103933136`"}], "0.002802355727319536`", 
      "0.1918566217931366`", 
      RowBox[{"-", "0.00040487024490461394`"}], "0.09650142090671548`", 
      RowBox[{"-", "1.1140160031578662`*^-20"}]},
     {
      RowBox[{"-", "0.000506580964000286`"}], "1.1817836645070408`", 
      RowBox[{"-", "1.1308030395644835`*^-22"}], "0.09137907888227413`", 
      RowBox[{"-", "0.00009802994389476097`"}], "2.190384306765533`*^-22", 
      "9.43570160025003`*^-16", 
      RowBox[{"-", "2.747498669921044`*^-18"}], 
      RowBox[{"-", "0.009038291491654402`"}], "0.0006760579572626681`", 
      RowBox[{"-", "0.18209050436862118`"}], "0.009038291491654402`", 
      RowBox[{"-", "0.09154855587553745`"}], "0.00040486980547527294`", 
      RowBox[{"-", "9.046424316515868`*^-22"}]},
     {
      RowBox[{"-", "1.3925200039473327`*^-21"}], 
      RowBox[{"-", "1.1308030395644835`*^-22"}], "1.1818181818181819`", "0.`",
       "0.`", "0.`", "0.17964578430020803`", "0.008538884326388827`", 
      RowBox[{"-", "1.3742489983669373`*^-21"}], 
      RowBox[{"-", "0.17964578430020803`"}], 
      RowBox[{"-", "0.008538884326388827`"}], 
      RowBox[{"-", "0.18181818181818185`"}], 
      RowBox[{"-", "1.1187370500890798`*^-22"}], "1.3776599249021424`*^-21", 
      RowBox[{"-", "3.078247890057913`*^-39"}]},
     {"0.001206078182106786`", "0.18275815776454826`", "0.`", 
      "1.1817195514118257`", "0.0012145763671886382`", 
      RowBox[{"-", "2.71385344962996`*^-21"}], "5.860998889715681`*^-18", 
      "9.736477097109097`*^-16", "0.01573276667943922`", 
      RowBox[{"-", "0.1829256295939325`"}], 
      RowBox[{"-", "0.18397273413173787`"}], 
      RowBox[{"-", "0.01573276667943922`"}], "0", "0", "0"},
     {
      RowBox[{"-", "0.19759439134006745`"}], 
      RowBox[{"-", "0.00019605988778952194`"}], "0.`", 
      "0.0012145763671886382`", "1.1668613768506895`", 
      "3.341953445910216`*^-20", 
      RowBox[{"-", "1.0393102977144434`*^-15"}], 
      RowBox[{"-", "8.019423221345209`*^-17"}], 
      RowBox[{"-", "0.19373991556258308`"}], "0.19637981497287985`", 
      RowBox[{"-", "0.16666531696289982`"}], "0.19373991556258308`", "0", "0",
       "0"},
     {"3.3185703638039696`*^-20", "4.380768613531066`*^-22", "0.`", 
      RowBox[{"-", "2.71385344962996`*^-21"}], "3.341953445910216`*^-20", 
      "1.1818181818181819`", 
      RowBox[{"-", "0.014549043187886038`"}], "0.17916304590095702`", 
      "3.257060575579777`*^-20", "0.014549043187886038`", 
      RowBox[{"-", "0.17916304590095702`"}], 
      RowBox[{"-", "0.18181818181818182`"}], "0", "0", "0"},
     {
      RowBox[{"-", "6.045979200725868`*^-17"}], "9.43570160025003`*^-16", 
      "0.17964578430020803`", "2.9304994448578406`*^-18", 
      RowBox[{"-", "5.196551488572217`*^-16"}], 
      RowBox[{"-", "0.007274521593943019`"}], "1.1818181818181819`", 
      RowBox[{"-", "3.271876873989072`*^-31"}], 
      RowBox[{"-", "5.947249236538581`*^-17"}], 
      RowBox[{"-", "0.18181818181818177`"}], 
      RowBox[{"-", "9.326099207006363`*^-16"}], 
      RowBox[{"-", "0.17965729345067374`"}], 
      RowBox[{"-", "1.978339347989585`*^-18"}], "5.086949095328555`*^-16", 
      "0.007286030744408794`"},
     {
      RowBox[{"-", "1.0132207592734504`*^-15"}], 
      RowBox[{"-", "2.747498669921044`*^-18"}], "0.008538884326388827`", 
      "4.868238548554548`*^-16", 
      RowBox[{"-", "4.0097116106726043`*^-17"}], "0.08958152295047851`", 
      RowBox[{"-", "3.271876873989072`*^-31"}], "1.1818181818181819`", 
      RowBox[{"-", "6.608087049502788`*^-17"}], "1.012927891099317`*^-15", 
      RowBox[{"-", "0.18181818181818182`"}], 
      RowBox[{"-", "0.00839715579987662`"}], 
      RowBox[{"-", "4.865309866813212`*^-16"}], "2.7069328682376852`*^-17", 
      RowBox[{"-", "0.08972325147699065`"}]},
     {
      RowBox[{"-", "0.1918566217931366`"}], 
      RowBox[{"-", "0.009038291491654402`"}], 
      RowBox[{"-", "1.3742489983669373`*^-21"}], "0.00786638333971961`", 
      RowBox[{"-", "0.09686995778129154`"}], "1.6285302877898884`*^-20", 
      RowBox[{"-", "5.947249236538581`*^-17"}], 
      RowBox[{"-", "6.608087049502788`*^-17"}], "1.1698067455161434`", 
      "0.19167582721275675`", "0.011264672105482345`", 
      RowBox[{"-", "0.1698067455161434`"}], 
      RowBox[{"-", "0.007685588759339677`"}], "0.09464357716746366`", 
      RowBox[{"-", "1.09939919869355`*^-20"}]},
     {
      RowBox[{"-", "0.16960271103933136`"}], "0.0006760579572626681`", 
      RowBox[{"-", "0.17964578430020803`"}], 
      RowBox[{"-", "0.09146281479696625`"}], "0.09818990748643992`", 
      "0.007274521593943019`", 
      RowBox[{"-", "0.18181818181818177`"}], "1.012927891099317`*^-15", 
      "0.19167582721275675`", "1.5333554014363107`", 
      RowBox[{"-", "0.001963994807282254`"}], 
      RowBox[{"-", "0.012018533762082945`"}], 
      RowBox[{"-", "0.09047169378183133`"}], 
      RowBox[{"-", "0.09690197063642135`"}], 
      RowBox[{"-", "0.007286030744408794`"}]},
     {"0.002802355727319536`", 
      RowBox[{"-", "0.18209050436862118`"}], 
      RowBox[{"-", "0.008538884326388827`"}], 
      RowBox[{"-", "0.09198636706586893`"}], 
      RowBox[{"-", "0.08333265848144991`"}], 
      RowBox[{"-", "0.08958152295047851`"}], 
      RowBox[{"-", "9.326099207006363`*^-16"}], 
      RowBox[{"-", "0.18181818181818182`"}], "0.011264672105482345`", 
      RowBox[{"-", "0.001963994807282254`"}], "1.5336227672989011`", 
      RowBox[{"-", "0.002867516305605652`"}], "0.09114800614583259`", 
      RowBox[{"-", "0.08638142263064817`"}], "0.08972325147699065`"},
     {"0.1918566217931366`", "0.009038291491654402`", 
      RowBox[{"-", "0.18181818181818185`"}], 
      RowBox[{"-", "0.00786638333971961`"}], "0.09686995778129154`", 
      RowBox[{"-", "0.09090909090909091`"}], 
      RowBox[{"-", "0.17965729345067374`"}], 
      RowBox[{"-", "0.00839715579987662`"}], 
      RowBox[{"-", "0.1698067455161434`"}], 
      RowBox[{"-", "0.012018533762082945`"}], 
      RowBox[{"-", "0.002867516305605652`"}], "1.5334431091525071`", 
      "0.007685588759339677`", 
      RowBox[{"-", "0.09464357716746366`"}], 
      RowBox[{"-", "0.09090909090909091`"}]},
     {
      RowBox[{"-", "0.0008097404898092279`"}], 
      RowBox[{"-", "0.1830971117510749`"}], 
      RowBox[{"-", "2.2374741001781596`*^-22"}], "0", "0", "0", 
      RowBox[{"-", "3.95667869597917`*^-18"}], 
      RowBox[{"-", "9.730619733626424`*^-16"}], 
      RowBox[{"-", "0.015371177518679354`"}], 
      RowBox[{"-", "0.18094338756366266`"}], "0.18229601229166517`", 
      "0.015371177518679354`", "1.1817531280534719`", 
      "0.0008010994594107078`", 
      RowBox[{"-", "1.7899792801425277`*^-21"}]},
     {"0.19300284181343097`", "0.0008097396109505459`", 
      "2.755319849804285`*^-21", "0", "0", "0", "1.017389819065711`*^-15", 
      "5.4138657364753703`*^-17", "0.18928715433492732`", 
      RowBox[{"-", "0.1938039412728427`"}], 
      RowBox[{"-", "0.17276284526129634`"}], 
      RowBox[{"-", "0.18928715433492732`"}], "0.0008010994594107078`", 
      "1.1719531056503458`", "2.204255879843428`*^-20"},
     {
      RowBox[{"-", "2.2280320063157324`*^-20"}], 
      RowBox[{"-", "1.8092848633031737`*^-21"}], 
      RowBox[{"-", "6.156495780115827`*^-39"}], "0", "0", "0", 
      "0.014572061488817588`", 
      RowBox[{"-", "0.1794465029539813`"}], 
      RowBox[{"-", "2.1987983973871`*^-20"}], 
      RowBox[{"-", "0.014572061488817588`"}], "0.1794465029539813`", 
      RowBox[{"-", "0.18181818181818182`"}], 
      RowBox[{"-", "1.7899792801425277`*^-21"}], "2.204255879843428`*^-20", 
      "1.1818181818181819`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.666860951326481*^9, 3.6668609614199142`*^9}, {
   3.666937334142239*^9, 3.666937363794285*^9}, 3.6669378616657887`*^9, 
   3.6669398267289667`*^9, 3.66724480714235*^9, 3.6674115871325893`*^9, 
   3.667411703058395*^9, 3.6681816068641977`*^9, 3.668182011249004*^9, 
   3.6686317708131847`*^9, 3.668746641583186*^9, 3.668749821912529*^9, {
   3.668751249962438*^9, 3.6687512745900784`*^9}, 3.6687520823860683`*^9, 
   3.668922816244742*^9, 3.668923064806143*^9, 3.669272803926001*^9, 
   3.66943305409689*^9, 3.6697392496118793`*^9, 3.669749727266025*^9, 
   3.6703442711257257`*^9, {3.672690032788204*^9, 3.672690058996966*^9}, 
   3.67269150004226*^9, 3.6738024755071173`*^9, 3.673802515533517*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nest", "[", 
    RowBox[{"Step", ",", 
     RowBox[{"{", 
      RowBox[{"curpts", ",", " ", "vels"}], "}"}], ",", "10"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6659840853155193`*^9, 3.66598409748312*^9}, {
   3.665987121227507*^9, 3.6659871341604233`*^9}, {3.665987492871923*^9, 
   3.665987493045212*^9}, {3.6659877581465807`*^9, 3.665987760191353*^9}, {
   3.6659886596253643`*^9, 3.665988660239181*^9}, 3.6659922234173937`*^9, {
   3.665992765757283*^9, 3.6659927866433973`*^9}, {3.6661155233681517`*^9, 
   3.66611552349955*^9}, {3.666124350296587*^9, 3.666124350382831*^9}, {
   3.666473817443035*^9, 3.666473818109035*^9}, {3.6665008935767183`*^9, 
   3.66650092696308*^9}, {3.6665009980951757`*^9, 3.666500998189147*^9}, 
   3.666505887222032*^9, 3.6665060498753643`*^9, {3.666509108333197*^9, 
   3.6665091280772133`*^9}, {3.66654397929148*^9, 3.666543980504159*^9}, {
   3.666544020136197*^9, 3.666544020798596*^9}, {3.666544101295693*^9, 
   3.666544101369035*^9}, {3.666572324806629*^9, 3.666572324861766*^9}, {
   3.666572551799692*^9, 3.666572552020434*^9}, {3.6666294285859756`*^9, 
   3.66662943141321*^9}, {3.666766525738744*^9, 3.666766526063079*^9}, {
   3.666766581750284*^9, 3.6667665820164557`*^9}, {3.6667666706047983`*^9, 
   3.666766670761277*^9}, {3.666845358603414*^9, 3.666845360435956*^9}, {
   3.6668454913302803`*^9, 3.666845492087768*^9}, {3.6668456282713013`*^9, 
   3.666845628520873*^9}, {3.66685650987668*^9, 3.666856510297221*^9}, {
   3.6668576031670732`*^9, 3.666857603768651*^9}, {3.666861114470673*^9, 
   3.6668611148679123`*^9}, {3.6668611582447987`*^9, 3.666861158363306*^9}, {
   3.666861648162531*^9, 3.666861648318825*^9}, 3.666937340096219*^9, {
   3.6669378557683153`*^9, 3.666937855880427*^9}, 3.668181556711906*^9, 
   3.668181789777465*^9, {3.668747939305223*^9, 3.66874793946207*^9}, {
   3.6687514565166817`*^9, 3.66875146120437*^9}, 3.668752097430111*^9, {
   3.6727024038866253`*^9, 3.672702404124695*^9}}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.673802475812126*^9, 3.673802517496282*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.673802475812126*^9, 3.673802517833479*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"FindRoot", "::", "lstol"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"The line search decreased the step size to within \
tolerance specified by AccuracyGoal and PrecisionGoal but was unable to find \
a sufficient decrease in the merit function. You may need more than \
\[NoBreak]\\!\\(\\*RowBox[{\\\"MachinePrecision\\\"}]\\)\[NoBreak] digits of \
working precision to meet these tolerances. \\!\\(\\*ButtonBox[\\\"\
\[RightSkeleton]\\\", ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/FindRoot/lstol\\\", ButtonNote -> \
\\\"FindRoot::lstol\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.673802475812126*^9, 3.6738025181774387`*^9}],

Cell[BoxData[
 RowBox[{
  StyleBox[
   RowBox[{"General", "::", "stop"}], "MessageName"], 
  RowBox[{
  ":", " "}], "\<\"Further output of \
\[NoBreak]\\!\\(\\*StyleBox[RowBox[{\\\"FindRoot\\\", \\\"::\\\", \\\"lstol\\\
\"}], \\\"MessageName\\\"]\\)\[NoBreak] will be suppressed during this \
calculation. \\!\\(\\*ButtonBox[\\\"\[RightSkeleton]\\\", \
ButtonStyle->\\\"Link\\\", ButtonFrame->None, \
ButtonData:>\\\"paclet:ref/message/General/stop\\\", ButtonNote -> \
\\\"General::stop\\\"]\\)\"\>"}]], "Message", "MSG",
 CellChangeTimes->{3.673802475812126*^9, 3.673802518195788*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"8.78116013918988`"},
      {"0.6964681691397012`"},
      {"0.5846848943028803`"},
      {
       RowBox[{"-", "0.1593084063798294`"}]},
      {"8.332908807475967`"},
      {"0.3219257243420795`"},
      {"0.6773311770307443`"},
      {"0.2602238331211956`"},
      {"8.51070461363667`"},
      {"0.9500063366534266`"},
      {"0.2574385725532362`"},
      {"0.724682481634843`"},
      {"0.9494471006317369`"},
      {
       RowBox[{"-", "7.7459959571042365`"}]},
      {"0.2735302965093463`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.668749823077414*^9, {3.668751251055368*^9, 3.668751275653103*^9}, 
   3.668751523444075*^9, 3.6687515924093723`*^9, {3.668752094347638*^9, 
   3.6687521055318213`*^9}, 3.668922823756384*^9, 3.668923065671069*^9, 
   3.669272804744688*^9, 3.669433055056695*^9, 3.669739250477005*^9, 
   3.6697497290964603`*^9, 3.670344272033584*^9, {3.6726900337645817`*^9, 
   3.6726900603760233`*^9}, 3.672691501119883*^9, 3.6727020448793097`*^9, 
   3.6727024091319838`*^9, 3.673802478291013*^9, 3.67380251916787*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.666716348617876*^9, 3.6667163489336853`*^9}, {
   3.666717035314753*^9, 3.66671704549354*^9}, 3.666717717066113*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ForceWithDamping", "[", "curpts", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.66671633219099*^9, 3.6667163558307333`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"ForceWithDamping", "[", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "1", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0.129388`",
      ",", "0.198451`", ",", "10.0678`", ",", "0.129388`", ",", "0.198451`", 
     ",", "5.32823`*^-14", ",", "0.939582`", ",", 
     RowBox[{"-", "9.77863`"}], ",", "1.0416000000000001`*^-13"}], "}"}], 
   "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6667163381978397`*^9, 3.6667163563367558`*^9}, {
   3.666717042753112*^9, 3.6667170496287527`*^9}, 3.666717169337453*^9, 
   3.6667664410636883`*^9, 3.666766503463526*^9, 3.666842193986274*^9, 
   3.666845263829164*^9, 3.666845586273381*^9, 3.6668514395679693`*^9, 
   3.6668525134977827`*^9, 3.666852875224268*^9, 3.666858914629799*^9, 
   3.666937381451256*^9, 3.666937865027441*^9, 3.666939829745964*^9, 
   3.66724481052213*^9, 3.667411590408072*^9, 3.6674117072355433`*^9, 
   3.6681816401025867`*^9, 3.668182011644587*^9, 3.6686317714154797`*^9, 
   3.66874664220055*^9, 3.668749823330186*^9, {3.668751251090993*^9, 
   3.66875127568813*^9}, 3.668922823941242*^9, 3.6689230657984247`*^9, 
   3.669272804933408*^9, 3.6694330551527367`*^9, 3.669739250517321*^9, 
   3.669749729278366*^9, 3.670344272407187*^9, {3.672690033823655*^9, 
   3.6726900604514027`*^9}, 3.6726915013169527`*^9, 3.6738024784819307`*^9, 
   3.6738025193942013`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vels"], "Input",
 CellChangeTimes->{{3.666717054716774*^9, 3.6667170552200623`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.666717056122448*^9, 3.6667171693841743`*^9, 3.666766441137082*^9, 
   3.666766503535741*^9, 3.666842193999991*^9, 3.666845263905096*^9, 
   3.66684558638177*^9, 3.6668514395876913`*^9, 3.666852513527775*^9, 
   3.666852875244174*^9, 3.66685891470642*^9, 3.666937381520225*^9, 
   3.666937865041233*^9, 3.666939829764538*^9, 3.667244810610694*^9, 
   3.667411590484604*^9, 3.6674117073532877`*^9, 3.668181640173543*^9, 
   3.6681820116685534`*^9, 3.6686317714908333`*^9, 3.6687466422755947`*^9, 
   3.668749823382642*^9, {3.668751251110314*^9, 3.668751275704158*^9}, 
   3.668922824015745*^9, 3.668923065868294*^9, 3.6692728050007563`*^9, 
   3.6694330553269377`*^9, 3.6697392505340014`*^9, 3.669749729324997*^9, 
   3.670344272475767*^9, {3.672690033861966*^9, 3.672690060487598*^9}, 
   3.672691501396223*^9, 3.6738024785615797`*^9, 3.6738025194674873`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["curpts"], "Input",
 CellChangeTimes->{{3.6667171132276154`*^9, 3.666717114467517*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10", ",", "1", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0.129388`", 
   ",", "0.198451`", ",", "10.0678`", ",", "0.129388`", ",", "0.198451`", ",",
    "5.32823`*^-14", ",", "0.939582`", ",", 
   RowBox[{"-", "9.77863`"}], ",", "1.0416000000000001`*^-13"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.666717114871607*^9, 3.66671716944665*^9, 3.6667664412084713`*^9, 
   3.666766503606761*^9, 3.666842194013589*^9, 3.6668452639907618`*^9, 
   3.666845586429584*^9, 3.666851439607072*^9, 3.6668525135583687`*^9, 
   3.666852875263726*^9, 3.666858914778141*^9, 3.66693738158987*^9, 
   3.6669378650566683`*^9, 3.666939829783738*^9, 3.667244810694151*^9, 
   3.667411590568014*^9, 3.667411707588085*^9, 3.668181640240093*^9, 
   3.668182011691989*^9, 3.668631771582182*^9, 3.668746642348928*^9, 
   3.6687498234563313`*^9, {3.668751251129984*^9, 3.6687512757202806`*^9}, 
   3.668922824085533*^9, 3.668923066047847*^9, 3.669272805066401*^9, 
   3.6694330554412394`*^9, 3.669739250551803*^9, 3.669749729466095*^9, 
   3.6703442725634604`*^9, {3.672690033899015*^9, 3.672690060525784*^9}, 
   3.672691501422202*^9, 3.673802478642069*^9, 3.673802519541462*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "pts_", "]"}], ":=", 
  RowBox[{"pts", ".", "pts"}]}]], "Input",
 CellChangeTimes->{{3.666721190434939*^9, 3.6667212085204973`*^9}, {
  3.666721293793591*^9, 3.666721296285798*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.6667212116787663`*^9, 3.66672121362638*^9}}],

Cell[BoxData["398.977263959514`"], "Output",
 CellChangeTimes->{
  3.666721214610682*^9, 3.666721298807755*^9, 3.666766441337688*^9, 
   3.6667665037330513`*^9, 3.666842194032798*^9, 3.666845264125248*^9, 
   3.666845586576663*^9, 3.666851439630018*^9, 3.6668525135885897`*^9, 
   3.666852875289297*^9, 3.66685891490311*^9, 3.666937381717162*^9, 
   3.666937865075481*^9, 3.6669398298078938`*^9, 3.66724481083318*^9, 
   3.667411590703656*^9, 3.6674117077431393`*^9, 3.6681816403605003`*^9, 
   3.668182011808394*^9, 3.668631771710287*^9, 3.668746642476677*^9, 
   3.6687498235831537`*^9, {3.66875125115488*^9, 3.668751275743544*^9}, 
   3.668922824220359*^9, 3.668923066182373*^9, 3.669272805185937*^9, 
   3.669433055673568*^9, 3.669739250574815*^9, 3.669749729609089*^9, 
   3.670344272731201*^9, {3.672690033948841*^9, 3.672690060568774*^9}, 
   3.672691501550696*^9, 3.67380247876849*^9, 3.6738025196984873`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dx", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"x", "[", "restpts", "]"}], ",", " ", 
      RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", " ", "\[Rule]", " ", "pts"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666721343030663*^9, 3.666721345762867*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dx", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.66672135157502*^9, 3.666721356243746*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "20", ",", "2", ",", "0", ",", "0", ",", "20", ",", "0", ",", "0.258776`", 
   ",", "0.396902`", ",", "20.1356`", ",", "0.258776`", ",", "0.396902`", ",",
    "1.065646`*^-13", ",", "1.879164`", ",", 
   RowBox[{"-", "19.55726`"}], ",", "2.0832000000000002`*^-13"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6667213567064867`*^9, 3.6667664414685802`*^9, 3.666766503856605*^9, 
   3.66684219405191*^9, 3.666845264255756*^9, 3.666845586717194*^9, 
   3.666851439657269*^9, 3.666852513616905*^9, 3.666852875317292*^9, 
   3.666858915027257*^9, 3.666937381848566*^9, 3.666937865094223*^9, 
   3.666939829830903*^9, 3.6672448109558277`*^9, 3.667411590840631*^9, 
   3.667411707862885*^9, 3.668181640482473*^9, 3.668182011834434*^9, 
   3.66863177188127*^9, 3.6687466426026173`*^9, 3.668749823714664*^9, {
   3.668751251179262*^9, 3.6687512757665787`*^9}, 3.668922824343731*^9, 
   3.668923066309099*^9, 3.6692728053061447`*^9, 3.669433055802697*^9, 
   3.669739250596809*^9, 3.669749729693084*^9, 3.6703442728605127`*^9, {
   3.672690033996475*^9, 3.672690060607119*^9}, 3.672691501680772*^9, 
   3.673802478956184*^9, 3.673802519857892*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"lbfgs", "[", "pts_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"pts", ".", "pts"}]}], " ", "-", " ", 
     RowBox[{"initpts", ".", "pts"}], " ", "-", " ", 
     RowBox[{"timestep", "*", 
      RowBox[{"vels", ".", "pts"}]}], " ", "+", " ", 
     RowBox[{"timestep", "*", "timestep", "*", 
      RowBox[{"invmasses", ".", 
       RowBox[{"totalE", "[", "pts", "]"}]}]}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.666723023575582*^9, 3.6667230919889507`*^9}, {
   3.6667231572214937`*^9, 3.666723160103044*^9}, {3.666723239338273*^9, 
   3.666723240196122*^9}, {3.6667234558963413`*^9, 3.6667234571590347`*^9}, 
   3.666723517992552*^9, {3.6667235563958673`*^9, 3.666723557150576*^9}, {
   3.666723675497199*^9, 3.666723678071383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lbfgs", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"pts", ".", 
       RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "pts"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], ")"}], 
     ".", "pts"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"timestep", "*", 
       RowBox[{
        RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], ")"}], 
     ".", "pts"}], " ", "+", "  ", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"totalE", "[", "pts", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.666723690474118*^9, 3.666723724082052*^9}, {
  3.666723795343644*^9, 3.666723800584779*^9}, {3.666723830629931*^9, 
  3.6667238503883*^9}, {3.666725635439498*^9, 3.666725661915677*^9}, {
  3.6669374116573267`*^9, 3.666937459399238*^9}, {3.666937514086603*^9, 
  3.666937523190756*^9}, {3.666937598677124*^9, 3.666937607446209*^9}, {
  3.6669376624536877`*^9, 3.666937698803301*^9}, {3.6669378921590633`*^9, 
  3.666937927083921*^9}, {3.666938033152603*^9, 3.6669380400734043`*^9}, {
  3.66693827004189*^9, 3.666938333582788*^9}, {3.66693857293532*^9, 
  3.666938579504608*^9}, {3.666939472916561*^9, 3.666939473742936*^9}, {
  3.6669395553493633`*^9, 3.6669395560974903`*^9}, {3.666939613379067*^9, 
  3.66693961443364*^9}, {3.6669396751272793`*^9, 3.6669396754068327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dlbfgs", "[", "pts_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"lbfgs", "[", "restpts", "]"}], ",", " ", 
     RowBox[{"{", "restpts", "}"}]}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"restpts", "\[Rule]", "pts"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6667235247896442`*^9, 3.666723590770801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dlbfgs", "[", "newpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.666723614389599*^9, 3.666723620273654*^9}, 
   3.666723668693323*^9, 3.666723859642591*^9, {3.666937487935793*^9, 
   3.666937489294228*^9}, {3.6669379708209867`*^9, 3.6669379715672693`*^9}, {
   3.66693819397215*^9, 3.666938214813146*^9}, {3.666938317682509*^9, 
   3.6669383191059837`*^9}, {3.666939517223405*^9, 3.666939518703384*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "0.7890036043447749`"}]},
      {"22.722839754373872`"},
      {"97.65151515151516`"},
      {"56.397082178616294`"},
      {"0.04432972898858113`"},
      {"49.24242424242424`"},
      {"4.365192142572846`"},
      {
       RowBox[{"-", "17.29914876651806`"}]},
      {
       RowBox[{"-", "4.8485378107256185`"}]},
      {
       RowBox[{"-", "33.54551314108681`"}]},
      {
       RowBox[{"-", "38.54318738351104`"}]},
      {
       RowBox[{"-", "31.104492492309184`"}]},
      {
       RowBox[{"-", "46.72500757575758`"}]},
      {
       RowBox[{"-", "9.223750000000011`"}]},
      {"49.2424242424199`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.666723860236327*^9, 3.666725667752487*^9, 3.666766441715454*^9, 
   3.666766504046898*^9, 3.6668421940794487`*^9, 3.666845264497367*^9, 
   3.666845586956581*^9, 3.666851439701762*^9, 3.6668525136626368`*^9, 
   3.666852875351915*^9, 3.6668589152684393`*^9, 3.666937382035151*^9, {
   3.666937481048664*^9, 3.6669374898307858`*^9}, 3.666937531325054*^9, 
   3.666937611138939*^9, {3.666937681007558*^9, 3.6669377042788067`*^9}, 
   3.666937865131073*^9, {3.666937915465835*^9, 3.6669379310814943`*^9}, 
   3.6669379719811163`*^9, 3.666938136187799*^9, {3.666938196946293*^9, 
   3.6669382163785543`*^9}, {3.666938313799996*^9, 3.666938343100062*^9}, 
   3.666938583693412*^9, {3.6669394998582993`*^9, 3.666939519339058*^9}, 
   3.666939572967387*^9, 3.666939617803487*^9, 3.6669396783838873`*^9, 
   3.666939829878798*^9, 3.667244811205585*^9, 3.667411591141035*^9, 
   3.6674117083979673`*^9, 3.6681816407649937`*^9, 3.6681820118847513`*^9, 
   3.6686317721335278`*^9, 3.668746642864822*^9, 3.6687498240681763`*^9, {
   3.668751251227334*^9, 3.6687512758131847`*^9}, 3.6689228246148643`*^9, 
   3.668923066559667*^9, 3.66927280555431*^9, 3.669433056058352*^9, 
   3.669739250648704*^9, 3.6697497300204077`*^9, 3.670344273179611*^9, {
   3.672690034080346*^9, 3.672690060679793*^9}, 3.6726915019410477`*^9, 
   3.673802479399375*^9, 3.67380252014017*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "newpts"}], " ", "-", 
   " ", 
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], " ", "-", 
   " ", 
   RowBox[{"timestep", "*", 
    RowBox[{
     RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], "-", 
   RowBox[{"timestep", "*", "timestep", "*", 
    RowBox[{"dEnergy", "[", "newpts", "]"}]}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.666937538598843*^9, 3.666937554374917*^9}, {
  3.666938144674685*^9, 3.666938162930912*^9}, {3.6669383233495293`*^9, 
  3.666938323943779*^9}, {3.6669395239025307`*^9, 3.666939536351832*^9}, {
  3.6669395764699907`*^9, 3.666939588039373*^9}, {3.666939623604697*^9, 
  3.666939651846723*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "0.7890036043447708`"}]},
      {"22.722839754373872`"},
      {"97.65151515151514`"},
      {"56.397082178616294`"},
      {"0.044329728988600436`"},
      {"49.24242424242424`"},
      {"4.365192142572846`"},
      {
       RowBox[{"-", "17.29914876651806`"}]},
      {
       RowBox[{"-", "4.848537810725588`"}]},
      {
       RowBox[{"-", "33.54551314108681`"}]},
      {
       RowBox[{"-", "38.54318738351104`"}]},
      {
       RowBox[{"-", "31.104492492309184`"}]},
      {
       RowBox[{"-", "46.72500757575758`"}]},
      {
       RowBox[{"-", "9.223749999999995`"}]},
      {"49.2424242424199`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6669375511791286`*^9, 3.666937554725295*^9}, 
   3.6669378651373463`*^9, {3.6669381457168493`*^9, 3.6669381634740868`*^9}, 
   3.666938324269133*^9, 3.666939537015512*^9, 3.6669395894406347`*^9, {
   3.6669396546517973`*^9, 3.666939679610159*^9}, 3.666939829912664*^9, 
   3.6672448112861233`*^9, 3.667411591264752*^9, 3.66741170850848*^9, 
   3.668181640869781*^9, 3.668182011922449*^9, 3.668631772266329*^9, 
   3.668746642951612*^9, 3.668749824110026*^9, {3.668751251259914*^9, 
   3.668751275845175*^9}, 3.668922824758082*^9, 3.668923066694669*^9, 
   3.669272805686026*^9, 3.6694330561436243`*^9, 3.669739250678195*^9, 
   3.669749730149707*^9, 3.670344273312066*^9, {3.672690034129683*^9, 
   3.672690060726224*^9}, 3.672691502073287*^9, 3.673802479552972*^9, 
   3.673802520234434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"curpts", " ", "-", " ", "initpts", " ", "-", " ", 
  RowBox[{"timestep", "*", "vels"}]}]], "Input",
 CellChangeTimes->{{3.666725731095141*^9, 3.666725739739278*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.01`"}], ",", "1.`", ",", 
   RowBox[{"-", "0.01`"}], ",", 
   RowBox[{"-", "0.01`"}], ",", "0.`", ",", "0.`", ",", "0.129388`", ",", 
   "0.198451`", ",", "0.06780000000000008`", ",", "0.129388`", ",", 
   "0.198451`", ",", "5.32823`*^-14", ",", "0.939582`", ",", 
   "0.2213700000000003`", ",", "1.0416000000000001`*^-13"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6667257405860567`*^9, 3.6667664417876863`*^9, 3.666766504116605*^9, 
   3.666842194092228*^9, 3.666845264571073*^9, 3.666845587039381*^9, 
   3.666851439721498*^9, 3.666852513684059*^9, 3.666852875370261*^9, 
   3.666858915340221*^9, 3.666937382106311*^9, 3.666937865151355*^9, 
   3.666939829931164*^9, 3.66724481142703*^9, 3.6674115914084682`*^9, 
   3.667411708585384*^9, 3.668181640938435*^9, 3.668182011946327*^9, 
   3.6686317722867413`*^9, 3.668746643025494*^9, 3.668749824277441*^9, {
   3.668751251279557*^9, 3.6687512758643227`*^9}, 3.668922824841043*^9, 
   3.6689230667151546`*^9, 3.669272805702976*^9, 3.669433056217214*^9, 
   3.669739250695875*^9, 3.669749730339196*^9, 3.670344273338708*^9, {
   3.672690034162896*^9, 3.672690060750457*^9}, 3.672691502094678*^9, 
   3.673802479578363*^9, 3.6738025204035482`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nmg", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{"pts", " ", "-", " ", "curpts", " ", "-", " ", 
    RowBox[{"timestep", "*", "vels"}], " ", "-", " ", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"invmasses", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dEnergy", "[", "pts", "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
         RowBox[{
          RowBox[{"dForces", "[", "pts", "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"pts", "-", "curpts"}], ")"}]}]}]}], ")"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666939062096562*^9, 3.666939116147279*^9}, {
  3.666939751007389*^9, 3.666939751150943*^9}, {3.66693980816261*^9, 
  3.666939840385544*^9}, {3.667247780181148*^9, 3.667247789370351*^9}, {
  3.6672479518975067`*^9, 3.667248017522286*^9}, {3.667248058139872*^9, 
  3.667248072686468*^9}, {3.6672481107280073`*^9, 3.6672481109379673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nmg", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.66724803524609*^9, 3.6672480406431093`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.009468043252136127`"}], ",", "0.2726740770524865`", ",", 
   "1.1718181818181819`", ",", "1.353529972286791`", ",", 
   "0.0010639134957255436`", ",", "1.1818181818181819`", ",", 
   "0.052382305710874155`", ",", 
   RowBox[{"-", "0.20758978519821675`"}], ",", 
   RowBox[{"-", "0.05818245372870656`"}], ",", 
   RowBox[{"-", "0.4025461576930417`"}], ",", 
   RowBox[{"-", "0.4625182486021325`"}], ",", 
   RowBox[{"-", "0.37325390990771024`"}], ",", 
   RowBox[{"-", "1.1214001818181818`"}], ",", 
   RowBox[{"-", "0.2213700000000003`"}], ",", "1.1818181818180777`"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.667248041516643*^9, 3.66724807640327*^9}, 
   3.667411591700429*^9, 3.667411709213274*^9, 3.66818164129781*^9, 
   3.668182012119328*^9, 3.668631772672543*^9, 3.668746643381341*^9, 
   3.668749824578856*^9, {3.668751251448625*^9, 3.6687512760338717`*^9}, 
   3.668922825242133*^9, 3.668923066992585*^9, 3.669272806058338*^9, 
   3.669433056571457*^9, 3.6697392508675947`*^9, 3.669749730714342*^9, 
   3.6703442737240143`*^9, {3.67269003446141*^9, 3.672690060941641*^9}, 
   3.672691502527645*^9, 3.673802479920985*^9, 3.673802520687438*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "pts"}], " ", "-", " ", 
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], " ", "-", 
   " ", 
   RowBox[{"timestep", "*", 
    RowBox[{
     RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], " ", "-", 
   " ", 
   RowBox[{"timestep", "*", "timestep", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dEnergy", "[", "pts", "]"}], "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
       RowBox[{
        RowBox[{"dForces", "[", "pts", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"pts", "-", "curpts"}], ")"}]}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.666939867456808*^9, 3.6669399343614264`*^9}, 
   3.667245159783498*^9, {3.667245190636443*^9, 3.667245194067382*^9}, {
   3.667245234303206*^9, 3.667245252855585*^9}, {3.667245294443718*^9, 
   3.6672453072835293`*^9}, {3.667247464450075*^9, 3.667247470165167*^9}, {
   3.6672476380011272`*^9, 3.667247650339162*^9}, {3.667247731676862*^9, 
   3.6672477365221663`*^9}, {3.6672482005836067`*^9, 3.66724821638837*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.666939937238564*^9, 3.666939941080081*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.7890036043447708`"}], ",", "22.722839754373872`", ",", 
   "97.65151515151514`", ",", "56.397082178616294`", ",", 
   "0.044329728988600436`", ",", "49.24242424242424`", ",", 
   "4.365192142572846`", ",", 
   RowBox[{"-", "17.29914876651806`"}], ",", 
   RowBox[{"-", "4.848537810725588`"}], ",", 
   RowBox[{"-", "33.54551314108681`"}], ",", 
   RowBox[{"-", "38.54318738351104`"}], ",", 
   RowBox[{"-", "31.104492492309184`"}], ",", 
   RowBox[{"-", "46.72500757575758`"}], ",", 
   RowBox[{"-", "9.223749999999995`"}], ",", "49.2424242424199`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.666939942913967*^9, 3.667244811632201*^9, {3.6672452450473948`*^9, 
   3.667245257402076*^9}, 3.667245309700705*^9, 3.6672474736995277`*^9, 
   3.667247658835248*^9, 3.667247739716487*^9, 3.667248222106861*^9, 
   3.6674115919208593`*^9, 3.6674117096793413`*^9, 3.668181641509776*^9, 
   3.668182012306383*^9, 3.668631773007915*^9, 3.6687466437248163`*^9, 
   3.6687498249091387`*^9, {3.668751251654791*^9, 3.668751276213264*^9}, 
   3.668922825574814*^9, 3.668923067297344*^9, 3.669272806329186*^9, 
   3.669433056990664*^9, 3.669739251132262*^9, 3.669749731157578*^9, 
   3.6703442740116873`*^9, {3.672690034684301*^9, 3.672690061206129*^9}, 
   3.672691502891111*^9, 3.6738024802103024`*^9, 3.673802520900099*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nmG", "[", "pts_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], 
     RowBox[{"pts", ".", 
      RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "pts"}]}], " ", "-", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], ")"}], 
     ".", "pts"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"timestep", "*", 
       RowBox[{
        RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], ")"}], 
     ".", "pts"}], " ", "-", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "*", 
        RowBox[{"totalE", "[", "pts", "]"}]}], "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pts", " ", ".", 
           RowBox[{"dEnergy", "[", "pts", "]"}]}], " ", "+", 
          RowBox[{"totalE", "[", "pts", "]"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"dEnergy", "[", "pts", "]"}], ".", "curpts"}]}], ")"}]}]}],
       ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.666939118265952*^9, 3.666939230029084*^9}, {
  3.666939690790188*^9, 3.666939691682616*^9}, {3.6672453578334293`*^9, 
  3.667245361660577*^9}, {3.667245403493235*^9, 3.6672454339737186`*^9}, {
  3.667245528368675*^9, 3.667245571814782*^9}, {3.667245603792947*^9, 
  3.667245698022902*^9}, {3.667247168493371*^9, 3.66724717654322*^9}, {
  3.667247228711647*^9, 3.667247231331262*^9}, {3.667247407687026*^9, 
  3.667247422211431*^9}, {3.667247492495037*^9, 3.667247504620207*^9}, {
  3.667247749067319*^9, 3.6672477581414433`*^9}, {3.667248238841921*^9, 
  3.667248247696961*^9}, {3.667248340790682*^9, 3.6672484079908648`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"newg", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"nmG", "[", "restpts", "]"}], ",", " ", 
     RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"restpts", "\[Rule]", "pts"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6669392361537733`*^9, 3.66693926490868*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"newg", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.666939280658733*^9, 3.6669392848439302`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.7890036043447749`"}], ",", "22.722839754373872`", ",", 
   "97.65151515151516`", ",", "56.397082178616294`", ",", 
   "0.04432972898858113`", ",", "49.24242424242424`", ",", 
   "4.365192142572846`", ",", 
   RowBox[{"-", "17.29914876651806`"}], ",", 
   RowBox[{"-", "4.8485378107256185`"}], ",", 
   RowBox[{"-", "33.54551314108681`"}], ",", 
   RowBox[{"-", "38.54318738351104`"}], ",", 
   RowBox[{"-", "31.104492492309184`"}], ",", 
   RowBox[{"-", "46.72500757575758`"}], ",", 
   RowBox[{"-", "9.223750000000011`"}], ",", "49.2424242424199`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6669392856885033`*^9, 3.666939765166807*^9, 3.666939830024782*^9, 
   3.667244811901258*^9, {3.667247437186533*^9, 3.667247448646081*^9}, 
   3.667247511413335*^9, 3.667247766461513*^9, {3.6672483532941017`*^9, 
   3.667248410906561*^9}, 3.6674115922982273`*^9, 3.667411710016515*^9, 
   3.6681816419199743`*^9, 3.668182012386773*^9, 3.668631773281184*^9, 
   3.6687466438994827`*^9, 3.6687498250813837`*^9, {3.668751251897584*^9, 
   3.6687512764387817`*^9}, 3.668922825987637*^9, 3.668923067545588*^9, 
   3.669272806571888*^9, 3.6694330571737556`*^9, 3.669739251245453*^9, 
   3.669749731472065*^9, 3.670344274348193*^9, {3.672690034785162*^9, 
   3.672690061454274*^9}, 3.67269150312607*^9, 3.673802480444805*^9, 
   3.6738025211275*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.669433061507038*^9, 3.669433062611011*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nmG", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.66943376545543*^9, 3.669433772554268*^9}}],

Cell[BoxData[
 RowBox[{"-", "12536.54478840434`"}]], "Output",
 CellChangeTimes->{
  3.669433773890955*^9, 3.669739251296472*^9, 3.669749731733007*^9, 
   3.670344274446645*^9, {3.672690034882066*^9, 3.67269006163863*^9}, 
   3.672691503426367*^9, 3.6738024806651506`*^9, 3.673802521276621*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"newg", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.669435894559766*^9, 3.669435914710512*^9}, {
  3.6697405634610157`*^9, 3.6697405706122093`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "1.998424992074809`"}]},
      {"4.980700183080404`"},
      {
       RowBox[{"-", "0.8333333333341406`"}]},
      {"4.706323587412806`"},
      {
       RowBox[{"-", "0.9032456391594638`"}]},
      {
       RowBox[{"-", "4.034858559252261`*^-13"}]},
      {
       RowBox[{"-", "7.344700703741012`*^-13"}]},
      {
       RowBox[{"-", "8.160828040265929`*^-13"}]},
      {"4.2042435377586616`"},
      {
       RowBox[{"-", "3.982873567957436`"}]},
      {
       RowBox[{"-", "3.769820175893289`"}]},
      {
       RowBox[{"-", "4.204243537757858`"}]},
      {"0.02497497262012914`"},
      {
       RowBox[{"-", "0.30763436802684796`"}]},
      {"3.852689235704182`*^-13"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669435900744658*^9, 3.669435915522599*^9}, 
   3.6697392513606853`*^9, {3.669740567045651*^9, 3.6697405710986757`*^9}, 
   3.669749731879434*^9, 3.6703442745615883`*^9, {3.6726900349691267`*^9, 
   3.6726900617488947`*^9}, 3.6726915035603247`*^9, 3.6738024807895107`*^9, 
   3.673802521495885*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dForces", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.669435904554016*^9, 3.669435907390428*^9}, {
  3.66974075506861*^9, 3.669740755831933*^9}, {3.669741685328231*^9, 
  3.66974173080162*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "141170.4518276522`"}], "422.1508033335716`", 
      "1.1604333366227772`*^-15", 
      RowBox[{"-", "502.53257587782747`"}], "82330.99639169476`", 
      RowBox[{"-", "1.3827376515849872`*^-14"}], "5.03831600060489`*^-11", 
      "8.443506327278752`*^-10", "159880.51816094713`", "141335.59253277612`", 
      RowBox[{"-", "2335.2964394329465`"}], 
      RowBox[{"-", "159880.51816094713`"}], "337.39187075384496`", 
      RowBox[{"-", "80417.85075559623`"}], "9.283466692982218`*^-15"},
     {"422.1508033335716`", 
      RowBox[{"-", "151486.38708920055`"}], "9.423358663037362`*^-17", 
      RowBox[{"-", "76149.23240189509`"}], "81.6916199123008`", 
      RowBox[{"-", "1.825320255637944`*^-16"}], 
      RowBox[{"-", "7.863084666875025`*^-10"}], "2.289582224934203`*^-12", 
      "7531.909576378666`", 
      RowBox[{"-", "563.3816310522234`"}], "151742.08697385096`", 
      RowBox[{"-", "7531.909576378666`"}], "76290.46322961454`", 
      RowBox[{"-", "337.39150456272745`"}], "7.538686930429889`*^-16"},
     {"1.1604333366227772`*^-15", "9.423358663037362`*^-17", 
      RowBox[{"-", "151515.15151515152`"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "149704.82025017333`"}], 
      RowBox[{"-", "7115.7369386573555`"}], "1.1452074986391143`*^-15", 
      "149704.82025017333`", "7115.7369386573555`", "151515.15151515152`", 
      "9.32280875074233`*^-17", 
      RowBox[{"-", "1.1480499374184519`*^-15"}], "2.565206575048261`*^-33"},
     {
      RowBox[{"-", "502.53257587782747`"}], 
      RowBox[{"-", "76149.23240189509`"}], "0.`", 
      RowBox[{"-", "75716.47975492738`"}], 
      RowBox[{"-", "506.0734863285992`"}], "1.1307722706791499`*^-15", 
      RowBox[{"-", "2.442082870714867`*^-12"}], 
      RowBox[{"-", "4.0568654571287897`*^-10"}], 
      RowBox[{"-", "6555.31944976634`"}], "76219.0123308052`", 
      "76655.3058882241`", "6555.31944976634`", "0", "0", "0"},
     {"82330.99639169476`", "81.6916199123008`", "0.`", 
      RowBox[{"-", "506.0734863285992`"}], 
      RowBox[{"-", "69525.57368778726`"}], 
      RowBox[{"-", "1.3924806024625899`*^-14"}], "4.330459573810181`*^-10", 
      "3.34142634222717`*^-11", "80724.96481774293`", 
      RowBox[{"-", "81824.92290536659`"}], "69443.88206787492`", 
      RowBox[{"-", "80724.96481774293`"}], "0", "0", "0"},
     {
      RowBox[{"-", "1.3827376515849872`*^-14"}], 
      RowBox[{"-", "1.825320255637944`*^-16"}], "0.`", 
      "1.1307722706791499`*^-15", 
      RowBox[{"-", "1.3924806024625899`*^-14"}], 
      RowBox[{"-", "75757.57575757576`"}], "6062.1013282858485`", 
      RowBox[{"-", "74651.26912539876`"}], 
      RowBox[{"-", "1.3571085731582402`*^-14"}], 
      RowBox[{"-", "6062.1013282858485`"}], "74651.26912539876`", 
      "75757.57575757576`", "0", "0", "0"},
     {"5.03831600060489`*^-11", 
      RowBox[{"-", "7.863084666875025`*^-10"}], 
      RowBox[{"-", "149704.82025017333`"}], 
      RowBox[{"-", "2.442082870714867`*^-12"}], "4.330459573810181`*^-10", 
      "6062.1013282858485`", 
      RowBox[{"-", "151515.15151515152`"}], "2.7265640616575598`*^-25", 
      "4.956041030448817`*^-11", "151515.15151515146`", 
      "7.771749339171969`*^-10", "149714.41120889477`", 
      "1.6486161233246542`*^-12", 
      RowBox[{"-", "4.239124246107129`*^-10"}], 
      RowBox[{"-", "6071.692287007328`"}]},
     {"8.443506327278752`*^-10", "2.289582224934203`*^-12", 
      RowBox[{"-", "7115.7369386573555`"}], 
      RowBox[{"-", "4.0568654571287897`*^-10"}], "3.34142634222717`*^-11", 
      RowBox[{"-", "74651.26912539876`"}], "2.7265640616575598`*^-25", 
      RowBox[{"-", "151515.15151515152`"}], "5.5067392079189894`*^-11", 
      RowBox[{"-", "8.441065759160974`*^-10"}], "151515.1515151515`", 
      "6997.629833230516`", "4.0544248890110097`*^-10", 
      RowBox[{"-", "2.2557773901980708`*^-11"}], "74769.37623082552`"},
     {"159880.51816094713`", "7531.909576378666`", "1.1452074986391143`*^-15", 
      RowBox[{"-", "6555.31944976634`"}], "80724.96481774293`", 
      RowBox[{"-", "1.3571085731582402`*^-14"}], "4.956041030448817`*^-11", 
      "5.5067392079189894`*^-11", 
      RowBox[{"-", "141505.6212634528`"}], 
      RowBox[{"-", "159729.8560106306`"}], 
      RowBox[{"-", "9387.226754568619`"}], "141505.6212634528`", 
      "6404.657299449731`", 
      RowBox[{"-", "78869.64763955305`"}], "9.161659989112915`*^-15"},
     {"141335.59253277612`", 
      RowBox[{"-", "563.3816310522234`"}], "149704.82025017333`", 
      "76219.0123308052`", 
      RowBox[{"-", "81824.92290536659`"}], 
      RowBox[{"-", "6062.1013282858485`"}], "151515.15151515146`", 
      RowBox[{"-", "8.441065759160974`*^-10"}], 
      RowBox[{"-", "159729.8560106306`"}], 
      RowBox[{"-", "444462.8345302588`"}], "1636.662339401878`", 
      "10015.444801735786`", "75393.0781515261`", "80751.64219701778`", 
      "6071.692287007328`"},
     {
      RowBox[{"-", "2335.2964394329465`"}], "151742.08697385096`", 
      "7115.7369386573555`", "76655.3058882241`", "69443.88206787492`", 
      "74651.26912539876`", "7.771749339171969`*^-10", "151515.1515151515`", 
      RowBox[{"-", "9387.226754568619`"}], "1636.662339401878`", 
      RowBox[{"-", "444685.63941575075`"}], "2389.596921338043`", 
      RowBox[{"-", "75956.67178819381`"}], "71984.51885887347`", 
      RowBox[{"-", "74769.37623082552`"}]},
     {
      RowBox[{"-", "159880.51816094713`"}], 
      RowBox[{"-", "7531.909576378666`"}], "151515.15151515152`", 
      "6555.31944976634`", 
      RowBox[{"-", "80724.96481774293`"}], "75757.57575757576`", 
      "149714.41120889477`", "6997.629833230516`", "141505.6212634528`", 
      "10015.444801735786`", "2389.596921338043`", 
      RowBox[{"-", "444535.9242937558`"}], 
      RowBox[{"-", "6404.657299449731`"}], "78869.64763955305`", 
      "75757.57575757576`"},
     {"337.39187075384496`", "76290.46322961454`", "9.32280875074233`*^-17", 
      "0", "0", "0", "1.6486161233246542`*^-12", "4.0544248890110097`*^-10", 
      "6404.657299449731`", "75393.0781515261`", 
      RowBox[{"-", "75956.67178819381`"}], 
      RowBox[{"-", "6404.657299449731`"}], 
      RowBox[{"-", "75730.47002227994`"}], 
      RowBox[{"-", "333.79144142112824`"}], "7.458247000593864`*^-16"},
     {
      RowBox[{"-", "80417.85075559623`"}], 
      RowBox[{"-", "337.39150456272745`"}], 
      RowBox[{"-", "1.1480499374184519`*^-15"}], "0", "0", "0", 
      RowBox[{"-", "4.239124246107129`*^-10"}], 
      RowBox[{"-", "2.2557773901980708`*^-11"}], 
      RowBox[{"-", "78869.64763955305`"}], "80751.64219701778`", 
      "71984.51885887347`", "78869.64763955305`", 
      RowBox[{"-", "333.79144142112824`"}], 
      RowBox[{"-", "71647.12735431072`"}], 
      RowBox[{"-", "9.184399499347615`*^-15"}]},
     {"9.283466692982218`*^-15", "7.538686930429889`*^-16", 
      "2.565206575048261`*^-33", "0", "0", "0", 
      RowBox[{"-", "6071.692287007328`"}], "74769.37623082552`", 
      "9.161659989112915`*^-15", "6071.692287007328`", 
      RowBox[{"-", "74769.37623082552`"}], "75757.57575757576`", 
      "7.458247000593864`*^-16", 
      RowBox[{"-", "9.184399499347615`*^-15"}], 
      RowBox[{"-", "75757.57575757576`"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669740756951247*^9, {3.66974168975613*^9, 3.6697417006196623`*^9}, 
   3.6697417312759237`*^9, 3.669749732171694*^9, 3.670344274782833*^9, {
   3.672690035153378*^9, 3.6726900619501677`*^9}, 3.672691503789469*^9, 
   3.6738024810194273`*^9, 3.6738025216495237`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vels"], "Input",
 CellChangeTimes->{{3.669436093342153*^9, 3.6694360946832533`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.669436095357416*^9, 3.669739251385571*^9, 3.6697497323070927`*^9, 
   3.670344274802273*^9, {3.6726900351863527`*^9, 3.6726900619673157`*^9}, 
   3.6726915038682737`*^9, 3.6738024810519047`*^9, 3.6738025216696453`*^9}]
}, Open  ]]
},
WindowSize->{927, 1028},
WindowMargins->{{Automatic, -10}, {Automatic, -10}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 92, 2, 32, "Input"],
Cell[495, 17, 545, 15, 32, "Input"],
Cell[1043, 34, 428, 9, 32, "Input"],
Cell[1474, 45, 2675, 86, 121, "Input"],
Cell[CellGroupData[{
Cell[4174, 135, 398, 10, 55, "Input"],
Cell[4575, 147, 2272, 33, 32, "Output"],
Cell[6850, 182, 2272, 33, 32, "Output"]
}, Open  ]],
Cell[9137, 218, 736, 14, 32, "Input"],
Cell[9876, 234, 471, 8, 32, "Input"],
Cell[10350, 244, 720, 17, 55, "Input"],
Cell[11073, 263, 244, 6, 55, "Input"],
Cell[11320, 271, 1237, 36, 143, "Input"],
Cell[12560, 309, 3307, 94, 165, "Input"],
Cell[CellGroupData[{
Cell[15892, 407, 1127, 23, 77, "Input"],
Cell[17022, 432, 2867, 51, 80, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[19926, 488, 1078, 22, 77, "Input"],
Cell[21007, 512, 3305, 57, 80, "Output"]
}, Open  ]],
Cell[24327, 572, 847, 26, 55, "Input"],
Cell[25177, 600, 1390, 36, 77, "Input"],
Cell[CellGroupData[{
Cell[26592, 640, 130, 2, 32, "Input"],
Cell[26725, 644, 113, 1, 65, "Output"]
}, Open  ]],
Cell[26853, 648, 452, 12, 32, "Input"],
Cell[CellGroupData[{
Cell[27330, 664, 164, 3, 32, "Input"],
Cell[27497, 669, 3637, 72, 296, "Output"]
}, Open  ]],
Cell[31149, 744, 487, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[31661, 761, 263, 5, 32, "Input"],
Cell[31927, 768, 9999, 181, 323, "Output"]
}, Open  ]],
Cell[41941, 952, 378, 6, 32, "Input"],
Cell[42322, 960, 417, 6, 32, "Input"],
Cell[42742, 968, 504, 11, 55, "Input"],
Cell[CellGroupData[{
Cell[43271, 983, 72, 1, 32, "Input"],
Cell[43346, 986, 4220, 72, 281, "Output"]
}, Open  ]],
Cell[47581, 1061, 4924, 111, 363, "Input"],
Cell[52508, 1174, 754, 17, 55, "Input"],
Cell[CellGroupData[{
Cell[53287, 1195, 102, 1, 32, "Input"],
Cell[53392, 1198, 807, 15, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[54236, 1218, 234, 4, 32, "Input"],
Cell[54473, 1224, 597, 9, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[55107, 1238, 622, 12, 32, "Input"],
Cell[55732, 1252, 1918, 45, 281, "Output"]
}, Open  ]],
Cell[57665, 1300, 831, 19, 55, "Input"],
Cell[58499, 1321, 868, 21, 77, "Input"],
Cell[CellGroupData[{
Cell[59392, 1346, 102, 1, 32, "Input"],
Cell[59497, 1349, 506, 8, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[60040, 1362, 162, 3, 32, "Input"],
Cell[60205, 1367, 2037, 52, 293, "Output"]
}, Open  ]],
Cell[62257, 1422, 432, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[62714, 1437, 164, 3, 32, "Input"],
Cell[62881, 1442, 9259, 178, 323, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[72177, 1625, 2072, 32, 32, "Input"],
Cell[74252, 1659, 731, 13, 76, "Message"],
Cell[74986, 1674, 731, 13, 76, "Message"],
Cell[75720, 1689, 733, 13, 76, "Message"],
Cell[76456, 1704, 586, 12, 23, "Message"],
Cell[77045, 1718, 1634, 42, 281, "Output"]
}, Open  ]],
Cell[78694, 1763, 165, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[78884, 1769, 177, 4, 32, "Input"],
Cell[79064, 1775, 1410, 25, 74, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[80511, 1805, 98, 1, 32, "Input"],
Cell[80612, 1808, 1096, 18, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[81745, 1831, 100, 1, 32, "Input"],
Cell[81848, 1834, 1204, 20, 60, "Output"]
}, Open  ]],
Cell[83067, 1857, 225, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[83317, 1866, 126, 2, 32, "Input"],
Cell[83446, 1870, 917, 13, 32, "Output"]
}, Open  ]],
Cell[84378, 1886, 427, 12, 32, "Input"],
Cell[CellGroupData[{
Cell[84830, 1902, 125, 2, 32, "Input"],
Cell[84958, 1906, 1182, 20, 60, "Output"]
}, Open  ]],
Cell[86155, 1929, 886, 20, 55, "Input"],
Cell[87044, 1951, 1550, 34, 55, "Input"],
Cell[88597, 1987, 393, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[89015, 2001, 458, 7, 32, "Input"],
Cell[89476, 2010, 2620, 60, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[92133, 2075, 786, 19, 77, "Input"],
Cell[92922, 2096, 2056, 52, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[95015, 2153, 189, 3, 32, "Input"],
Cell[95207, 2158, 1258, 22, 60, "Output"]
}, Open  ]],
Cell[96480, 2183, 1023, 23, 77, "Input"],
Cell[CellGroupData[{
Cell[97528, 2210, 128, 2, 32, "Input"],
Cell[97659, 2214, 1212, 22, 55, "Output"]
}, Open  ]],
Cell[98886, 2239, 1231, 29, 77, "Input"],
Cell[CellGroupData[{
Cell[100142, 2272, 125, 2, 32, "Input"],
Cell[100270, 2276, 1372, 25, 55, "Output"]
}, Open  ]],
Cell[101657, 2304, 1893, 47, 121, "Input"],
Cell[103553, 2353, 388, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[103966, 2367, 130, 2, 32, "Input"],
Cell[104099, 2371, 1397, 26, 55, "Output"]
}, Open  ]],
Cell[105511, 2400, 146, 2, 77, "Input"],
Cell[CellGroupData[{
Cell[105682, 2406, 126, 2, 32, "Input"],
Cell[105811, 2410, 294, 5, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[106142, 2420, 214, 4, 32, "Input"],
Cell[106359, 2426, 1628, 47, 293, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[108024, 2478, 260, 5, 32, "Input"],
Cell[108287, 2485, 8012, 153, 323, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[116336, 2643, 98, 1, 32, "Input"],
Cell[116437, 2646, 456, 9, 89, "Output"]
}, Open  ]]
}
]
*)

