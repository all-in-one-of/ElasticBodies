(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[         0,          0]
NotebookDataLength[     98424,       2406]
NotebookOptionsPosition[     93500,       2242]
NotebookOutlinePosition[     93842,       2257]
CellTagsIndexPosition[     93799,       2254]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[BoxData[
 RowBox[{
  RowBox[{"Remove", "[", "\"\<Global`*\>\"", "]"}], ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getpt", "[", 
    RowBox[{"pts_", ",", "i_"}], "]"}], ":=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", "*", "i"}], "-", "2"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{
       RowBox[{"3", "*", "i"}], "-", "1"}], "\[RightDoubleBracket]"}], ",", 
     RowBox[{"pts", "\[LeftDoubleBracket]", 
      RowBox[{"3", "*", "i"}], "\[RightDoubleBracket]"}]}], "}"}]}], 
  ";"}]], "Input"],

Cell[BoxData[
 RowBox[{
  RowBox[{"restpts", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "x1", ",", " ", "y1", ",", " ", "z1", ",", "x2", ",", " ", "y2", ",", " ",
      "z2", ",", " ", "x3", ",", " ", "y3", ",", " ", "z3", ",", " ", "x4", 
     ",", "y4", ",", " ", "z4", ",", " ", "x5", ",", " ", "y5", ",", " ", 
     "z5"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6658152745253477`*^9, 3.665815297897182*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"getTet", "[", 
    RowBox[{"pts_", ",", "verts_"}], "]"}], ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], "]"}], "]"}], ",", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "]"}], "]"}], ",", " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "-", "2"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{
        RowBox[{"3", "*", 
         RowBox[{"verts", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], "-", "1"}], "]"}], "]"}], ",", 
     " ", 
     RowBox[{"pts", "[", 
      RowBox[{"[", 
       RowBox[{"3", "*", 
        RowBox[{"verts", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], "]"}], "]"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665815730104158*^9, 3.66581575230119*^9}, {
  3.665815790800848*^9, 3.6658157951131983`*^9}, {3.665815849368854*^9, 
  3.665816044707925*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"getTet", "[", 
  RowBox[{"restpts", ",", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  "]"}], "\[IndentingNewLine]", 
 RowBox[{"getTet", "[", 
  RowBox[{"restpts", ",", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "4"}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.6658162181968327`*^9, 3.665816300674715*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x1", ",", "y1", ",", "z1", ",", "x2", ",", "y2", ",", "z2", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6658208775426207`*^9, 3.665820878567718*^9}, 
   3.6658209109989357`*^9, 3.6658214155524893`*^9, 3.665821586118829*^9, 
   3.665821699819633*^9, 3.66582193278861*^9, 3.6658220430223923`*^9, {
   3.665822091344653*^9, 3.665822096214492*^9}, 3.665822169563464*^9, 
   3.665981499752554*^9, 3.665984103756639*^9, 3.6659867561279984`*^9, 
   3.665987117504649*^9, 3.665987451552433*^9, 3.665988810540255*^9, 
   3.665989408664394*^9, 3.665989760814486*^9, 3.6659898015170393`*^9, 
   3.665991236204561*^9, 3.665991635144369*^9, 3.665991672720278*^9, 
   3.665991803744759*^9, 3.6659921591109447`*^9, 3.666112389081355*^9, 
   3.6661129515744867`*^9, 3.666113402097589*^9, 3.666113434488449*^9, 
   3.666115302699024*^9, 3.6661241234701653`*^9, 3.6661298691719103`*^9, 
   3.666130360871798*^9, 3.6663777301759367`*^9, 3.666460166125717*^9, 
   3.6664602159593077`*^9, 3.666473689612382*^9, 3.6664737551781673`*^9, 
   3.666473832716537*^9, 3.6664996854490232`*^9, 3.66650274105967*^9, 
   3.666504102218132*^9, 3.6665058734515343`*^9, 3.666507996663196*^9, 
   3.666508948233672*^9, 3.666542339125325*^9, 3.6665719651721363`*^9, 
   3.666629434005*^9, 3.666714813570574*^9, 3.66671716821647*^9, 
   3.666766436780038*^9, 3.666766499422347*^9, 3.666842192809412*^9, 
   3.666845254292904*^9, 3.666845413243699*^9, 3.6668514330892763`*^9, 
   3.666852509472953*^9, 3.6668528709228363`*^9, 3.6668589092081747`*^9, {
   3.666937328377039*^9, 3.666937358161375*^9}, 3.666937857772015*^9, 
   3.666939823438548*^9, 3.667244802435692*^9, 3.6674115821316833`*^9, 
   3.6674116977229853`*^9, 3.668181601971574*^9, 3.668182009707719*^9, 
   3.668631767839622*^9, 3.66874663866039*^9, 3.6687498182769213`*^9, {
   3.668751245561908*^9, 3.668751270476294*^9}, 3.66875207465353*^9, 
   3.6689228063336163`*^9, 3.6689230615486937`*^9, 3.669272801109858*^9, 
   3.669433050606574*^9, 3.669739247945409*^9, 3.669749723099596*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "x5", ",", "y5", ",", "z5", ",", "x1", ",", "y1", ",", "z1", ",", "x3", ",",
    "y3", ",", "z3", ",", "x4", ",", "y4", ",", "z4"}], "}"}]], "Output",
 CellChangeTimes->{{3.6658208775426207`*^9, 3.665820878567718*^9}, 
   3.6658209109989357`*^9, 3.6658214155524893`*^9, 3.665821586118829*^9, 
   3.665821699819633*^9, 3.66582193278861*^9, 3.6658220430223923`*^9, {
   3.665822091344653*^9, 3.665822096214492*^9}, 3.665822169563464*^9, 
   3.665981499752554*^9, 3.665984103756639*^9, 3.6659867561279984`*^9, 
   3.665987117504649*^9, 3.665987451552433*^9, 3.665988810540255*^9, 
   3.665989408664394*^9, 3.665989760814486*^9, 3.6659898015170393`*^9, 
   3.665991236204561*^9, 3.665991635144369*^9, 3.665991672720278*^9, 
   3.665991803744759*^9, 3.6659921591109447`*^9, 3.666112389081355*^9, 
   3.6661129515744867`*^9, 3.666113402097589*^9, 3.666113434488449*^9, 
   3.666115302699024*^9, 3.6661241234701653`*^9, 3.6661298691719103`*^9, 
   3.666130360871798*^9, 3.6663777301759367`*^9, 3.666460166125717*^9, 
   3.6664602159593077`*^9, 3.666473689612382*^9, 3.6664737551781673`*^9, 
   3.666473832716537*^9, 3.6664996854490232`*^9, 3.66650274105967*^9, 
   3.666504102218132*^9, 3.6665058734515343`*^9, 3.666507996663196*^9, 
   3.666508948233672*^9, 3.666542339125325*^9, 3.6665719651721363`*^9, 
   3.666629434005*^9, 3.666714813570574*^9, 3.66671716821647*^9, 
   3.666766436780038*^9, 3.666766499422347*^9, 3.666842192809412*^9, 
   3.666845254292904*^9, 3.666845413243699*^9, 3.6668514330892763`*^9, 
   3.666852509472953*^9, 3.6668528709228363`*^9, 3.6668589092081747`*^9, {
   3.666937328377039*^9, 3.666937358161375*^9}, 3.666937857772015*^9, 
   3.666939823438548*^9, 3.667244802435692*^9, 3.6674115821316833`*^9, 
   3.6674116977229853`*^9, 3.668181601971574*^9, 3.668182009707719*^9, 
   3.668631767839622*^9, 3.66874663866039*^9, 3.6687498182769213`*^9, {
   3.668751245561908*^9, 3.668751270476294*^9}, 3.66875207465353*^9, 
   3.6689228063336163`*^9, 3.6689230615486937`*^9, 3.669272801109858*^9, 
   3.669433050606574*^9, 3.669739247945409*^9, 3.669749723104788*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"initpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "    ", "0", ",", "10", ",", "0", ",", 
     "    ", "0", ",", "0", ",", "10", ",", "    ", "0", ",", "0", ",", "0", 
     ",", "    ", "0", ",", 
     RowBox[{"-", "10"}], ",", " ", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.665816311656629*^9, 3.665816350641182*^9}, {
   3.665817974600679*^9, 3.665817987549389*^9}, 3.6658184661127367`*^9, {
   3.6658185628709583`*^9, 3.665818565348721*^9}, {3.665819245929906*^9, 
   3.665819249886527*^9}, {3.665819901786521*^9, 3.665819901955181*^9}, {
   3.6658202611975803`*^9, 3.665820266356933*^9}, {3.665821690124372*^9, 
   3.665821690537157*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"timestep", " ", "=", " ", "0.01"}], ";"}]], "Input",
 CellChangeTimes->{
  3.6659921550961437`*^9, 3.666504099840654*^9, 3.666505871040512*^9, {
   3.666507994378394*^9, 3.666507994550542*^9}, {3.666717165801146*^9, 
   3.666717166048462*^9}, {3.666766430281699*^9, 3.666766430699895*^9}, {
   3.666845243594295*^9, 3.6668452473228827`*^9}, {3.66685249240371*^9, 
   3.666852492518807*^9}, {3.667411692241757*^9, 3.667411692408163*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"curpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "    ", "0", ",", "10", ",", "0", ",", 
     "    ", "0", ",", "0", ",", "10", ",", "    ", "0", ",", "0", ",", "0", 
     ",", "    ", "0", ",", 
     RowBox[{"-", "10"}], ",", " ", "0"}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.66657195354919*^9, 3.666571958185171*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"mu", " ", "=", " ", "675450000.0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda", " ", "=", " ", "3449700000.0"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tet1", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tet2", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{"5", ",", "1", ",", "3", ",", "4"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.665816365927237*^9, 3.665816382066884*^9}, {
  3.665818997808136*^9, 3.665819033116259*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"TetRefShapeMatrix", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "1", "]"}], "]"}]}]}], " ", "}"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "2", "]"}], "]"}]}]}], "}"}], ",", 
     "\[IndentingNewLine]", " ", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "1"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "2"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", " ", 
       RowBox[{
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "3"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}], " ", "-", 
        RowBox[{
         RowBox[{"getpt", "[", 
          RowBox[{"pts", ",", " ", "4"}], "]"}], "[", 
         RowBox[{"[", "3", "]"}], "]"}]}]}], "}"}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F1", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"TetRefShapeMatrix", "[", 
     RowBox[{"getTet", "[", 
      RowBox[{"pts", ",", " ", "tet1"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"TetRefShapeMatrix", "[", 
      RowBox[{"getTet", "[", 
       RowBox[{"initpts", ",", "tet1"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F1", "[", "curpts", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.665816993282148*^9, 3.6658169947169657`*^9}, {
   3.6658170335648727`*^9, 3.665817040210581*^9}, {3.6658171220183268`*^9, 
   3.665817152491205*^9}, {3.6658171857781477`*^9, 3.6658172151875477`*^9}, 
   3.665817651536282*^9, {3.66581878982029*^9, 3.6658188147528677`*^9}, {
   3.665818969158842*^9, 3.665818984063986*^9}, {3.665819053795548*^9, 
   3.665819066985045*^9}, {3.665819126457912*^9, 3.665819147188525*^9}, 
   3.665820464810173*^9, {3.665820594750372*^9, 3.665820704710857*^9}, {
   3.6658208043554277`*^9, 3.665820821634694*^9}, {3.6658220848217363`*^9, 
   3.665822085018384*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6658208776071987`*^9, 3.665820878665946*^9}, 
   3.665820911061158*^9, 3.6658214156577*^9, 3.665821586270327*^9, 
   3.665821699938002*^9, {3.665821929745879*^9, 3.6658219328860073`*^9}, {
   3.665822068566183*^9, 3.665822096290595*^9}, 3.665822169631205*^9, 
   3.6659815001156673`*^9, 3.665984103848712*^9, 3.665986756257407*^9, 
   3.66598711762694*^9, 3.665987451616212*^9, 3.665988810636813*^9, 
   3.665989408746138*^9, 3.665989760962449*^9, 3.665989801935042*^9, 
   3.6659912365537233`*^9, 3.6659916356050367`*^9, 3.6659916731674023`*^9, 
   3.665991804400981*^9, 3.665992159565637*^9, 3.666112389545637*^9, 
   3.6661129523940077`*^9, 3.666113402233933*^9, 3.66611343462683*^9, 
   3.666115302771503*^9, 3.66612412388372*^9, 3.666129869266058*^9, 
   3.6661303609468307`*^9, 3.666377730716422*^9, 3.66646016618712*^9, 
   3.666460216134433*^9, 3.666473690095275*^9, 3.6664737552537737`*^9, 
   3.666473832854155*^9, 3.666499685763027*^9, 3.666502741446466*^9, 
   3.66650410281299*^9, 3.666505873838737*^9, 3.666507997241647*^9, 
   3.666508948662949*^9, 3.6665423391762953`*^9, 3.666571965270358*^9, 
   3.666629434355438*^9, 3.6667148136302147`*^9, 3.666717168285803*^9, 
   3.666766437151308*^9, 3.6667664997833*^9, 3.6668421928567142`*^9, 
   3.666845254686414*^9, 3.6668454136320457`*^9, 3.66685143314261*^9, 
   3.6668525095203753`*^9, 3.6668528709736633`*^9, 3.666858909577849*^9, 
   3.6669373287686853`*^9, 3.666937358851318*^9, 3.666937857818572*^9, 
   3.666939823524315*^9, 3.667244802813081*^9, 3.6674115825498543`*^9, 
   3.667411698098057*^9, 3.668181602320546*^9, 3.668182009759986*^9, 
   3.668631768252915*^9, 3.668746639030415*^9, 3.6687498187441187`*^9, {
   3.668751245626354*^9, 3.6687512705234747`*^9}, 3.668752074701642*^9, 
   3.668922806716629*^9, 3.668923061910617*^9, 3.669272801469314*^9, 
   3.669433050983214*^9, 3.669739248011902*^9, 3.669749723480019*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"F2", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"TetRefShapeMatrix", "[", 
     RowBox[{"getTet", "[", 
      RowBox[{"pts", ",", " ", "tet2"}], "]"}], "]"}], ".", 
    RowBox[{"Inverse", "[", 
     RowBox[{"TetRefShapeMatrix", "[", 
      RowBox[{"getTet", "[", 
       RowBox[{"initpts", ",", " ", "tet2"}], "]"}], "]"}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"F2", "[", "curpts", "]"}], "//", "MatrixForm"}]}], "Input",
 CellChangeTimes->{{3.6658172182160254`*^9, 3.665817237521982*^9}, {
  3.6658176589945803`*^9, 3.6658177049778843`*^9}, {3.66581882657384*^9, 
  3.6658188330337152`*^9}, {3.665819077498995*^9, 3.665819086996098*^9}, {
  3.6658191684777718`*^9, 3.665819182354837*^9}, {3.6658194257764397`*^9, 
  3.665819427245984*^9}, {3.6658202113303003`*^9, 3.665820229385047*^9}, {
  3.665820508982215*^9, 3.665820512211378*^9}, {3.6658205894468412`*^9, 
  3.665820590133255*^9}, {3.665820764783145*^9, 3.665820767984336*^9}, {
  3.66582209397727*^9, 3.6658220941876707`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"1", "0", "0"},
     {"0", "1", "0"},
     {"0", "0", "1"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665818833512567*^9, 3.66581908815532*^9, {3.665819175068791*^9, 
   3.665819195263817*^9}, 3.6658192530311747`*^9, 3.665819305222872*^9, 
   3.665819430589574*^9, 3.665819745706252*^9, 3.66581987834511*^9, 
   3.6658200024965553`*^9, {3.6658202129389133`*^9, 3.665820229743659*^9}, 
   3.665820269648944*^9, 3.6658203792174797`*^9, 3.665820513345636*^9, 
   3.665820590574997*^9, 3.665820768483539*^9, 3.665820817900959*^9, {
   3.665820877646851*^9, 3.665820878693112*^9}, 3.6658209110849447`*^9, 
   3.665821415667962*^9, 3.665821586294506*^9, 3.665821699974869*^9, 
   3.665821932904676*^9, {3.665822091483528*^9, 3.665822096318234*^9}, 
   3.665822169655383*^9, 3.665981500186666*^9, 3.665984103873178*^9, 
   3.6659867562807713`*^9, 3.6659871176598988`*^9, 3.665987451644825*^9, 
   3.665988810669218*^9, 3.6659894087753363`*^9, 3.6659897609878473`*^9, 
   3.6659898020107527`*^9, 3.665991236654931*^9, 3.665991636097868*^9, 
   3.665991673481059*^9, 3.665991804498921*^9, 3.665992160033626*^9, 
   3.6661123896355124`*^9, 3.666112952551796*^9, 3.666113402251965*^9, 
   3.666113434656604*^9, 3.666115302799309*^9, 3.666124123957518*^9, 
   3.66612986930678*^9, 3.666130360979907*^9, 3.666377731007221*^9, 
   3.666460166212109*^9, 3.666460216269622*^9, 3.6664736902849092`*^9, 
   3.666473755264332*^9, 3.666473832876745*^9, 3.666499685834056*^9, 
   3.666502741517104*^9, 3.666504103166453*^9, 3.666505873924302*^9, 
   3.666507997633595*^9, 3.6665089487788553`*^9, 3.666542339197195*^9, 
   3.6665719652783403`*^9, 3.666629434422462*^9, 3.666714813658804*^9, 
   3.666717168318541*^9, 3.6667664372326393`*^9, 3.666766499852458*^9, 
   3.666842192874434*^9, 3.666845254772057*^9, 3.666845413746859*^9, 
   3.66685143316658*^9, 3.666852509539097*^9, 3.666852870996531*^9, 
   3.6668589096585217`*^9, 3.6669373288487577`*^9, 3.66693735894473*^9, 
   3.666937857833106*^9, 3.6669398235440283`*^9, 3.6672448028988237`*^9, 
   3.667411582633834*^9, 3.66741169818213*^9, 3.668181602395892*^9, 
   3.6681820097768517`*^9, 3.668631768352181*^9, 3.668746639106731*^9, 
   3.668749818926696*^9, {3.66875124565226*^9, 3.668751270542398*^9}, 
   3.668752074720738*^9, 3.6689228068019037`*^9, 3.668923062006242*^9, 
   3.6692728014873533`*^9, 3.6694330510619497`*^9, 3.66973924803344*^9, 
   3.669749723554797*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"EnergyDensity", "[", "F_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"mu", "/", "2.0"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Tr", "[", 
        RowBox[{
         RowBox[{"Transpose", "[", "F", "]"}], ".", "F"}], "]"}], " ", "-", 
       "3"}], ")"}]}], " ", "-", " ", 
    RowBox[{"mu", "*", 
     RowBox[{"Log", "[", 
      RowBox[{"Det", "[", "F", "]"}], "]"}]}], " ", "+", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"lambda", "/", "2.0"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"Log", "[", 
       RowBox[{"Det", "[", "F", "]"}], "]"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"Log", "[", 
       RowBox[{"Det", "[", "F", "]"}], "]"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{3.665819873359787*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Tet1Vol", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.0", "/", "6.0"}], ")"}], "*", 
     RowBox[{"Det", "[", 
      RowBox[{"TetRefShapeMatrix", "[", 
       RowBox[{"getTet", "[", 
        RowBox[{"initpts", ",", "tet1"}], "]"}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Tet2Vol", " ", "=", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1.0", "/", "6.0"}], ")"}], "*", 
     RowBox[{"Det", "[", 
      RowBox[{"TetRefShapeMatrix", "[", 
       RowBox[{"getTet", "[", 
        RowBox[{"initpts", ",", "tet2"}], "]"}], "]"}], "]"}]}], ")"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"totalE", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"Tet1Vol", "*", 
    RowBox[{"EnergyDensity", "[", 
     RowBox[{"F1", "[", "pts", "]"}], "]"}]}], " ", "+", 
   RowBox[{"Tet2Vol", "*", 
    RowBox[{"EnergyDensity", "[", 
     RowBox[{"F2", "[", "pts", "]"}], "]"}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6658177667574253`*^9, 3.66581779469621*^9}, {
  3.66581782870572*^9, 3.6658179404396753`*^9}, {3.665818634359209*^9, 
  3.66581866382008*^9}, {3.6658192957892714`*^9, 3.665819302609071*^9}, {
  3.665819687134677*^9, 3.66581973747373*^9}, {3.665821410360219*^9, 
  3.665821411632032*^9}, {3.6658221644905567`*^9, 3.66582216578117*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dEnergy", "[", "pts_", "]"}], " ", ":=", " ", 
   RowBox[{
    RowBox[{"-", 
     RowBox[{"D", "[", 
      RowBox[{
       RowBox[{"totalE", "[", "restpts", "]"}], ",", " ", 
       RowBox[{"{", "restpts", "}"}]}], "]"}]}], "/.", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", "\[Rule]", " ", "pts"}], "]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6658184079700108`*^9, 3.6658184467332163`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dEnergy", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.665818449502461*^9, 3.665818473385376*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.665818461791885*^9, 3.665818473837757*^9}, 
   3.665818568494573*^9, 3.665818666794723*^9, 3.665819195356143*^9, 
   3.6658192531423798`*^9, 3.6658193052901573`*^9, 3.665819430666198*^9, 
   3.665819745770836*^9, 3.6658198784128227`*^9, 3.665820002573872*^9, 
   3.66582022534439*^9, 3.665820269738641*^9, 3.665820379279245*^9, 
   3.665820818113863*^9, {3.6658208777285233`*^9, 3.665820878792663*^9}, 
   3.665820911152914*^9, 3.665821415767662*^9, 3.66582158637994*^9, 
   3.665821700080957*^9, 3.665821932995723*^9, {3.665822091618211*^9, 
   3.665822096434669*^9}, 3.665822169724329*^9, 3.6659815004420633`*^9, 
   3.6659841039297523`*^9, 3.665986756333231*^9, 3.6659871177265177`*^9, 
   3.665987451705027*^9, 3.665988810749756*^9, 3.6659894088307056`*^9, 
   3.6659897610463057`*^9, 3.665989802644212*^9, 3.665991237172103*^9, 
   3.66599163649263*^9, 3.665991673699986*^9, 3.665991804786628*^9, 
   3.66599216065373*^9, 3.66599223947161*^9, 3.666112390039447*^9, 
   3.666112953359177*^9, 3.6661134023031263`*^9, 3.666113434713831*^9, 
   3.666115302880859*^9, 3.666124124367134*^9, 3.666129869404887*^9, 
   3.666130361031248*^9, 3.66637773139601*^9, 3.666460166260347*^9, 
   3.666460216550387*^9, 3.66647369125513*^9, 3.666473755313726*^9, 
   3.666473832919179*^9, 3.66649968609026*^9, 3.6665027418698273`*^9, 
   3.666504103576886*^9, 3.666505874661335*^9, 3.666507997981112*^9, 
   3.6665089492368813`*^9, 3.6665423392438803`*^9, 3.666571965348123*^9, 
   3.666629434693994*^9, 3.66671481371625*^9, 3.6667171683724117`*^9, 
   3.666766437483242*^9, 3.6667665002017097`*^9, 3.666842192929147*^9, 
   3.6668452552229633`*^9, 3.666845414280883*^9, 3.6668514332247887`*^9, 
   3.666852509589905*^9, 3.6668528710524473`*^9, 3.6668589102303123`*^9, 
   3.6669373292339907`*^9, 3.666937359404911*^9, 3.6669378578748903`*^9, 
   3.666939823590703*^9, 3.667244803172515*^9, 3.667411583066992*^9, 
   3.667411698555161*^9, 3.6681816027316103`*^9, 3.668182009824155*^9, 
   3.66863176874304*^9, 3.668746639360221*^9, 3.668749819465564*^9, {
   3.6687512456988287`*^9, 3.668751270590952*^9}, 3.668752074767188*^9, 
   3.66892280721789*^9, 3.6689230624081*^9, 3.6692728016843443`*^9, 
   3.669433051321369*^9, 3.6697392480896807`*^9, 3.669749724027055*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dForces", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"dEnergy", "[", "restpts", "]"}], ",", " ", 
      RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", " ", "\[Rule]", " ", "pts"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665818397348877*^9, 3.665818401149044*^9}, {
  3.665819465805282*^9, 3.665819480092683*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dForces", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.665819486010705*^9, 3.665819493766698*^9}, {
  3.665989264661373*^9, 3.66598926525727*^9}, {3.665989758117057*^9, 
  3.6659897589996233`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.6002`*^10"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.1499`*^10"}], "1.6002`*^10", "0.`", "1.1499`*^10", 
      "0.`", "5.7495`*^9", "0.`"},
     {"0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "2.2515`*^9", "0.`", "1.12575`*^9", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "2.2515`*^9", "0.`", 
      "2.2515`*^9", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "1.12575`*^9", "1.12575`*^9", "0.`", "0", "0", "0"},
     {
      RowBox[{"-", "5.7495`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.001`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "5.7495`*^9", "8.001`*^9", "5.7495`*^9", 
      "0", "0", "0"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`", "1.12575`*^9", 
      "1.12575`*^9", "0", "0", "0"},
     {"0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "2.2515`*^9", "0.`", 
      "2.2515`*^9", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "2.2515`*^9", "0.`", "0.`", 
      "0.`", "1.12575`*^9"},
     {
      RowBox[{"-", "1.1499`*^10"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.6002`*^10"}], "1.1499`*^10", "0.`", "1.6002`*^10", 
      "0.`", "5.7495`*^9", "0.`"},
     {"1.6002`*^10", "0.`", "2.2515`*^9", "1.12575`*^9", "5.7495`*^9", "0.`", 
      "2.2515`*^9", "0.`", "1.1499`*^10", 
      RowBox[{"-", "2.0505`*^10"}], "0.`", 
      RowBox[{"-", "1.37505`*^10"}], "1.12575`*^9", 
      RowBox[{"-", "5.7495`*^9"}], "0.`"},
     {"0.`", "2.2515`*^9", "0.`", "1.12575`*^9", "8.001`*^9", "1.12575`*^9", 
      "0.`", "2.2515`*^9", "0.`", "0.`", 
      RowBox[{"-", "2.0505`*^10"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "8.001`*^9", 
      RowBox[{"-", "1.12575`*^9"}]},
     {"1.1499`*^10", "0.`", "2.2515`*^9", "0.`", "5.7495`*^9", "1.12575`*^9", 
      "2.2515`*^9", "0.`", "1.6002`*^10", 
      RowBox[{"-", "1.37505`*^10"}], "0.`", 
      RowBox[{"-", "2.0505`*^10"}], "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "1.12575`*^9"},
     {"0.`", "1.12575`*^9", "0.`", "0", "0", "0", "0.`", "0.`", "0.`", 
      "1.12575`*^9", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`"},
     {"5.7495`*^9", "0.`", "0.`", "0", "0", "0", "0.`", "0.`", "5.7495`*^9", 
      RowBox[{"-", "5.7495`*^9"}], "8.001`*^9", 
      RowBox[{"-", "5.7495`*^9"}], "0.`", 
      RowBox[{"-", "8.001`*^9"}], "0.`"},
     {"0.`", "0.`", "0.`", "0", "0", "0", "0.`", "1.12575`*^9", "0.`", "0.`", 
      
      RowBox[{"-", "1.12575`*^9"}], "1.12575`*^9", "0.`", "0.`", 
      RowBox[{"-", "1.12575`*^9"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665819494316019*^9, 3.6658197457988777`*^9, 3.665819878449224*^9, 
   3.6658200026146812`*^9, 3.665820225369669*^9, 3.66582026977431*^9, 
   3.665820379308507*^9, {3.665820877339468*^9, 3.665820878830647*^9}, 
   3.66582091118386*^9, 3.6658214157959747`*^9, 3.6658215864095488`*^9, 
   3.66582170012844*^9, 3.6658219330462427`*^9, {3.6658220917277412`*^9, 
   3.6658220966145563`*^9}, 3.66582216989219*^9, 3.665981500822032*^9, 
   3.665984104103979*^9, 3.665986756510659*^9, 3.665987117913021*^9, 
   3.665987451892099*^9, 3.665988810946394*^9, 3.665989265832843*^9, 
   3.6659894090013227`*^9, 3.665989761214164*^9, 3.665989802928381*^9, 
   3.6659912374825974`*^9, 3.66599163680555*^9, {3.665991673989674*^9, 
   3.665991706995091*^9}, 3.66599176918725*^9, 3.6659918053252707`*^9, 
   3.665992161127952*^9, 3.666112390497651*^9, 3.6661129540599403`*^9, 
   3.666113402467512*^9, 3.666113434886098*^9, 3.666115303036511*^9, 
   3.6661241246399717`*^9, 3.6661298696976643`*^9, 3.666130361216258*^9, 
   3.6663777318918543`*^9, 3.666460166417659*^9, 3.666460217016794*^9, 
   3.666473691930655*^9, 3.66647375546032*^9, 3.666473833077437*^9, 
   3.666499686455896*^9, 3.666502742128141*^9, 3.666504103846704*^9, 
   3.666505874933177*^9, 3.666507998262681*^9, 3.66650894951017*^9, 
   3.666542339412682*^9, 3.666571965549282*^9, 3.666629435057513*^9, 
   3.6667148138789682`*^9, 3.666717168535828*^9, 3.666766437859003*^9, 
   3.666766500489286*^9, 3.666842193129088*^9, 3.666845255592387*^9, 
   3.666845414672682*^9, 3.66685143339793*^9, 3.666852509755856*^9, 
   3.666852871223268*^9, 3.666858910510088*^9, 3.6669373296421633`*^9, 
   3.666937359788526*^9, 3.666937858043984*^9, 3.666939823745625*^9, 
   3.667244803543956*^9, 3.667411583335947*^9, 3.667411698859833*^9, 
   3.6681816030822144`*^9, 3.668182009980668*^9, 3.6686317690231028`*^9, 
   3.668746639735202*^9, 3.668749819754383*^9, {3.668751245867876*^9, 
   3.668751270747736*^9}, 3.6687520749418583`*^9, 3.668922807655776*^9, 
   3.668923062622285*^9, 3.669272801961437*^9, 3.669433051707533*^9, 
   3.66973924824771*^9, 3.669749724349262*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"rayleigh", " ", "=", " ", "0.0"}], ";"}]], "Input",
 CellChangeTimes->{{3.666715760544108*^9, 3.6667157754665613`*^9}, 
   3.6667664967255287`*^9, 3.6668454085840893`*^9, {3.6668524991021767`*^9, 
   3.666852508395296*^9}, {3.6681820021928377`*^9, 3.668182002477705*^9}, {
   3.668749829799849*^9, 3.668749829949445*^9}, 3.668923058606982*^9}],

Cell[BoxData[""], "Input",
 CellChangeTimes->{
  3.665984057256852*^9, {3.665987449073557*^9, 3.6659874492202806`*^9}, {
   3.665989375327712*^9, 3.665989385968883*^9}, {3.6659897789775333`*^9, 
   3.665989787816156*^9}, {3.666715531660207*^9, 3.666715548139943*^9}, {
   3.6667155944145393`*^9, 3.666715669531475*^9}, {3.666715749854607*^9, 
   3.6667157550957117`*^9}, {3.666715787024631*^9, 3.666715827324765*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invmasses", "=", 
   RowBox[{"DiagonalMatrix", "[", 
    RowBox[{"{", 
     RowBox[{
     "0.012", ",", " ", "0.012", ",", " ", "0.012", ",", " ", "0.024", ",", 
      "0.024", ",", "0.024", ",", " ", "0.012", ",", " ", "0.012", ",", " ", 
      "0.012", ",", " ", "0.012", ",", " ", "0.012", ",", " ", "0.012", ",", 
      " ", "0.024", ",", "0.024", ",", "0.024"}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.665986678862368*^9, 3.665986747691082*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"invmasses", " ", "//", "MatrixForm"}]], "Input"],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0.012`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.012`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.012`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.024`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.024`", "0.`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.024`", "0.`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`", "0.`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`", "0.`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`", "0.`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.012`",
       "0.`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.012`", "0.`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.012`", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.024`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.024`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", "0.`", "0.`", "0.`", "0.024`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.665984070260168*^9, 3.6659841041510363`*^9, 3.6659867565600843`*^9, {
   3.665987096860158*^9, 3.66598711797351*^9}, 3.665987451953442*^9, 
   3.665988810990713*^9, 3.665989409047825*^9, 3.6659897612528267`*^9, 
   3.665989803073517*^9, 3.66599123769427*^9, 3.665991637212249*^9, 
   3.665991674196629*^9, 3.665991805718596*^9, 3.665992161337792*^9, 
   3.666112390714347*^9, 3.6661129545225363`*^9, 3.66611340250389*^9, 
   3.66611343493856*^9, 3.666115303074355*^9, 3.6661241247799807`*^9, 
   3.6661298697471027`*^9, 3.6661303613493233`*^9, 3.6663777322261553`*^9, 
   3.66646016646819*^9, 3.666460217117044*^9, 3.666473692137288*^9, 
   3.666473755576033*^9, 3.666473833108302*^9, 3.666499686641493*^9, 
   3.666502742307807*^9, 3.6665041041832743`*^9, 3.666505875329616*^9, 
   3.666507998566485*^9, 3.666508949709326*^9, 3.666542339441934*^9, 
   3.6665719655813932`*^9, 3.666629435205286*^9, 3.666714813950289*^9, 
   3.666717168581793*^9, 3.666766438081914*^9, 3.666766500735134*^9, 
   3.666842193165846*^9, 3.666845255939577*^9, 3.666845414902789*^9, 
   3.666851433445643*^9, 3.66685250979493*^9, 3.6668528712680283`*^9, 
   3.666858910786313*^9, {3.666937330386547*^9, 3.666937360032557*^9}, 
   3.666937858090844*^9, 3.6669398237834873`*^9, 3.6672448037299423`*^9, 
   3.667411583581725*^9, 3.667411699422639*^9, 3.6681816033329163`*^9, 
   3.668182010039822*^9, 3.668631769228538*^9, 3.668746639905718*^9, 
   3.668749820226378*^9, {3.668751245937681*^9, 3.668751270783656*^9}, 
   3.668752074983103*^9, 3.6689228080522842`*^9, 3.6689230628754587`*^9, 
   3.669272802279983*^9, 3.669433051936325*^9, 3.6697392482885303`*^9, 
   3.6697497246199102`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Step", "[", "inp_", "]"}], " ", ":=", " ", 
  RowBox[{"Module", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"posguess", ",", " ", "eqns", ",", " ", "sol"}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"posguess", " ", "=", " ", 
      RowBox[{"inp", "[", 
       RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"eqns", " ", "=", " ", 
        RowBox[{"Thread", "[", " ", 
         RowBox[{"restpts", "-", 
          RowBox[{"(", 
           RowBox[{"posguess", "+", 
            RowBox[{"timestep", "*", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"inp", "[", 
                RowBox[{"[", "2", "]"}], "]"}], "+", 
               RowBox[{"timestep", "*", 
                RowBox[{"invmasses", ".", 
                 RowBox[{"dEnergy", "[", "restpts", "]"}]}]}], "+", 
               RowBox[{"rayleigh", "*", 
                RowBox[{"invmasses", ".", 
                 RowBox[{"dForces", "[", "restpts", "]"}], ".", 
                 RowBox[{"(", 
                  RowBox[{"restpts", "-", " ", "posguess"}], ")"}]}]}]}], 
              ")"}]}]}], ")"}]}], "]"}]}], ";"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"eqns", " ", "=", " ", 
      RowBox[{"Thread", "[", 
       RowBox[{"restpts", " ", "-", " ", "posguess", " ", "-", " ", 
        RowBox[{"timestep", "*", 
         RowBox[{"inp", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], " ", "-", " ", 
        RowBox[{"timestep", "*", "timestep", "*", 
         RowBox[{"invmasses", ".", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"dEnergy", "[", "restpts", "]"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
             RowBox[{
              RowBox[{"dForces", "[", "restpts", "]"}], ".", 
              RowBox[{"(", 
               RowBox[{"restpts", "-", "posguess"}], ")"}]}]}]}], ")"}]}]}]}],
        " ", "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"MatrixForm", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eqns", ",", 
            RowBox[{"{", "restpts", "}"}]}], "]"}], "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"restpts", "\[Rule]", "posguess"}], "]"}]}], "]"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{"Print", "[", 
        RowBox[{"Eigenvalues", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eqns", ",", " ", 
            RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", 
          RowBox[{"Thread", "[", 
           RowBox[{"restpts", "\[Rule]", "posguess"}], "]"}]}], "]"}], "]"}], 
       ";"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{"sol", "=", 
      RowBox[{"FindRoot", "[", 
       RowBox[{"eqns", ",", 
        RowBox[{"Thread", "[", 
         RowBox[{"{", 
          RowBox[{"restpts", ",", "posguess"}], "}"}], "]"}]}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{
       RowBox[{"restpts", "/.", "sol"}], ",", 
       RowBox[{
        RowBox[{"inp", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "+", 
        RowBox[{"timestep", "*", 
         RowBox[{"invmasses", ".", 
          RowBox[{"dEnergy", "[", 
           RowBox[{"restpts", "/.", "sol"}], "]"}]}]}]}]}], "}"}]}]}], 
   "\[IndentingNewLine]", "]"}]}]], "Input",
 CellChangeTimes->{{3.6661133909459887`*^9, 3.666113391200819*^9}, {
   3.666113429299081*^9, 3.666113432779141*^9}, {3.66645729696414*^9, 
   3.666457300249012*^9}, {3.666500946868992*^9, 3.666501021032815*^9}, {
   3.6665020705097513`*^9, 3.666502123560763*^9}, {3.666502201463656*^9, 
   3.6665023651887302`*^9}, 3.66650248825574*^9, {3.6665025236756887`*^9, 
   3.666502560406445*^9}, {3.666502610204982*^9, 3.666502706471566*^9}, {
   3.666509114855842*^9, 3.666509119501731*^9}, {3.666717744947791*^9, 
   3.666717746208692*^9}, {3.666718191308469*^9, 3.666718242010659*^9}, {
   3.6668434634198503`*^9, 3.6668434645594997`*^9}, {3.666843525344792*^9, 
   3.6668435494150877`*^9}, {3.666843632319791*^9, 3.6668437738429623`*^9}, 
   3.6668444473462543`*^9, {3.666845124103323*^9, 3.666845151698298*^9}, {
   3.666852436785735*^9, 3.666852440088503*^9}, {3.666853165412726*^9, 
   3.666853167663986*^9}, {3.666854027991631*^9, 3.6668540873060513`*^9}, {
   3.666854120753264*^9, 3.666854250889319*^9}, {3.666854282398582*^9, 
   3.666854322803748*^9}, {3.66685647899442*^9, 3.666856506304409*^9}, {
   3.666858746645891*^9, 3.666858751495479*^9}, {3.666861075315736*^9, 
   3.666861093992433*^9}, 3.6668611495777617`*^9, 3.668182089371738*^9, {
   3.668746854728492*^9, 3.668746858092985*^9}, {3.668751308370121*^9, 
   3.668751309790139*^9}, {3.668751510125621*^9, 3.668751513029649*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "1", ",", "1", ",", "    ", "1", ",", "10", ",", "1", ",", 
     "    ", "0", ",", "0", ",", "10", ",", "    ", "0", ",", "0", ",", "0", 
     ",", "    ", "0", ",", 
     RowBox[{"-", "10"}], ",", " ", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", " ", "0", ",", " ", "0", 
     ",", " ", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.668182229855485*^9, 3.668182230612989*^9}, 
   3.668182284352306*^9}],

Cell[CellGroupData[{

Cell[BoxData["curpts"], "Input",
 CellChangeTimes->{{3.6681822935899343`*^9, 3.6681822942846613`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10", ",", "0", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0", ",", "0",
    ",", "10", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "10"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.668182294563002*^9, 3.668631769452467*^9, 3.668746640104899*^9, 
   3.668749820354826*^9, {3.6687512459715548`*^9, 3.668751270818191*^9}, 
   3.6687520750205097`*^9, 3.668922808402351*^9, 3.66892306306616*^9, 
   3.66927280247469*^9, 3.66943305213037*^9, 3.6697392483234587`*^9, 
   3.6697497249752293`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"totalE", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.6681825779766817`*^9, 3.668182581896802*^9}, {
  3.668183574304394*^9, 3.6681835749981318`*^9}}],

Cell[BoxData["0.`"], "Output",
 CellChangeTimes->{
  3.668182582658366*^9, 3.6681835754709053`*^9, 3.668631769542738*^9, 
   3.668746640189302*^9, 3.66874982044576*^9, {3.668751245995556*^9, 
   3.668751270837284*^9}, 3.668752075040188*^9, 3.66892280855445*^9, 
   3.66892306314217*^9, 3.669272802560979*^9, 3.6694330522064943`*^9, 
   3.6697392483577347`*^9, 3.669749725121557*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Step", "[", 
    RowBox[{"{", 
     RowBox[{"curpts", ",", " ", "vels"}], "}"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], " ", "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.668181733765348*^9, 3.6681817527995996`*^9}, {
  3.6681820987119217`*^9, 3.668182101813828*^9}, {3.668923107512109*^9, 
  3.6689231075971403`*^9}, {3.668923174782515*^9, 3.668923174940215*^9}, {
  3.669272820646551*^9, 3.669272820801038*^9}, {3.669436556341549*^9, 
  3.669436556496994*^9}, {3.6697392569880037`*^9, 3.669739259015113*^9}, {
  3.669749715870297*^9, 3.66974971602521*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"10.005622488149331`"},
      {
       RowBox[{"-", "0.0020827827579498995`"}]},
      {"0.008124482338106632`"},
      {"0.008540437869234089`"},
      {"10.00083162594348`"},
      {"0.0010421927909410986`"},
      {
       RowBox[{"-", "0.00187249455852789`"}]},
      {"0.00041821090918087335`"},
      {"10.000623156620707`"},
      {"0.005625118809357461`"},
      {"0.000832307561799189`"},
      {"0.0006262963747892191`"},
      {"0.0027093373325037698`"},
      {
       RowBox[{"-", "9.999167097370849`"}]},
      {"0.00020993653803918013`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6681817542529097`*^9, 3.668181758087675*^9}, {
   3.668182007002658*^9, 3.668182010672641*^9}, {3.668182092940421*^9, 
   3.668182102924376*^9}, 3.668631769967188*^9, 3.668746640625041*^9, 
   3.668746866176816*^9, 3.668749820992379*^9, {3.668751246636978*^9, 
   3.668751271355145*^9}, 3.668751326023732*^9, {3.668752074267742*^9, 
   3.668752078966434*^9}, 3.668922812610489*^9, 3.668923063578289*^9, 
   3.668923109059095*^9, {3.669272803017302*^9, 3.6692728224110413`*^9}, 
   3.669433052699903*^9, 3.6694365584097548`*^9, {3.669739248751996*^9, 
   3.669739259930752*^9}, {3.6697497169590607`*^9, 3.669749725828024*^9}}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"newpts", " ", "=", " ", 
   RowBox[{"{", " ", 
    RowBox[{
    "10", ",", "1", ",", "1", ",", "    ", "1", ",", "10", ",", "1", ",", 
     "    ", "0", ",", "0", ",", "10", ",", "    ", "0", ",", "0", ",", "0", 
     ",", "    ", "0", ",", 
     RowBox[{"-", "10"}], ",", " ", "1"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"vels", " ", "=", " ", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0", ",", " ", "0", ",", " ", "0", 
     ",", " ", "0"}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6664738141031923`*^9, 3.66647381486491*^9}, {
   3.666474517849339*^9, 3.666474530371999*^9}, 3.666474599816292*^9, {
   3.666502753312029*^9, 3.666502753472618*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "pts_", "]"}], " ", ":=", 
  RowBox[{"pts", " ", "-", " ", "curpts", " ", "-", " ", 
   RowBox[{"timestep", "*", "vels"}], " ", "-", " ", 
   RowBox[{"timestep", "*", "timestep", "*", 
    RowBox[{"invmasses", ".", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"dEnergy", "[", "pts", "]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
        RowBox[{
         RowBox[{"dForces", "[", "pts", "]"}], ".", 
         RowBox[{"(", 
          RowBox[{"pts", "-", "curpts"}], ")"}]}]}]}], ")"}]}]}]}]}]], "Input",\

 CellChangeTimes->{{3.6668530247177877`*^9, 3.6668530973770847`*^9}, {
   3.6668546505801973`*^9, 3.6668547516935387`*^9}, 3.6668548142070627`*^9, {
   3.6668578168701897`*^9, 3.666857828002372*^9}, {3.666859030472598*^9, 
   3.666859033486137*^9}}],

Cell[CellGroupData[{

Cell[BoxData["timestep"], "Input",
 CellChangeTimes->{{3.668183536965329*^9, 3.6681835376207943`*^9}}],

Cell[BoxData["0.01`"], "Output",
 CellChangeTimes->{
  3.6681835379799423`*^9, 3.668631770221793*^9, 3.668746640870826*^9, 
   3.668749821215106*^9, {3.6687512467012167`*^9, 3.668751271432111*^9}, 
   3.668752079169689*^9, 3.668922812882996*^9, 3.668923064044965*^9, 
   3.669272803267415*^9, 3.669433053188332*^9, 3.669739248783668*^9, 
   3.669749726100177*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6668590495898867`*^9, 3.6668590566453533`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "0.009999999999999787`"}]},
      {"0.`"},
      {
       RowBox[{"-", "0.01`"}]},
      {
       RowBox[{"-", "0.01`"}]},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6668590523883266`*^9, 3.666859057295719*^9}, {
   3.666937330909051*^9, 3.6669373604347343`*^9}, 3.666937858309168*^9, 
   3.666939823953334*^9, 3.66724480411343*^9, 3.667411584091875*^9, 
   3.667411699973851*^9, 3.668181603758623*^9, 3.668182010916916*^9, 
   3.668631770443063*^9, 3.668746641138542*^9, 3.668749821426751*^9, {
   3.6687512468607817`*^9, 3.668751271592808*^9}, 3.668752079338028*^9, 
   3.6689228131126947`*^9, 3.668923064284225*^9, 3.669272803488264*^9, 
   3.669433053489243*^9, 3.669739249013486*^9, 3.669749726439042*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"gradG", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"g", "[", "restpts", "]"}], ",", " ", 
     RowBox[{"{", "restpts", "}"}]}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"restpts", "\[Rule]", "pts"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.666854758038537*^9, 3.6668548073161793`*^9}, {
  3.666858321058577*^9, 3.666858322960808*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"gradG", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6668609340237293`*^9, 3.666860958270793*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"19203.4`", "0.`", "0.`", "0.`", "6899.400000000001`", "0.`", "0.`", 
      "0.`", "13798.800000000001`", 
      RowBox[{"-", "19202.4`"}], "0.`", 
      RowBox[{"-", "13798.800000000001`"}], "0.`", 
      RowBox[{"-", "6899.400000000001`"}], "0.`"},
     {"0.`", "2702.8`", "0.`", "1350.9`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "1350.9`"}], "0.`", "0.`"},
     {"0.`", "0.`", "2702.8`", "0.`", "0.`", "0.`", "2701.8`", "0.`", "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0.`", "0.`"},
     {"0.`", "2701.8`", "0.`", "2702.8`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "2701.8`"}], 
      RowBox[{"-", "2701.8`"}], "0.`", "0", "0", "0"},
     {"13798.800000000001`", "0.`", "0.`", "0.`", "19203.4`", "0.`", "0.`", 
      "0.`", "13798.800000000001`", 
      RowBox[{"-", "13798.800000000001`"}], 
      RowBox[{"-", "19202.4`"}], 
      RowBox[{"-", "13798.800000000001`"}], "0", "0", "0"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "2702.8`", "0.`", "2701.8`", "0.`", 
      "0.`", 
      RowBox[{"-", "2701.8`"}], 
      RowBox[{"-", "2701.8`"}], "0", "0", "0"},
     {"0.`", "0.`", "2701.8`", "0.`", "0.`", "0.`", "2702.8`", "0.`", "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", "1350.9`", "0.`", "2702.8`", "0.`", 
      "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "1350.9`"}]},
     {"13798.800000000001`", "0.`", "0.`", "0.`", "6899.400000000001`", "0.`",
       "0.`", "0.`", "19203.4`", 
      RowBox[{"-", "13798.800000000001`"}], "0.`", 
      RowBox[{"-", "19202.4`"}], "0.`", 
      RowBox[{"-", "6899.400000000001`"}], "0.`"},
     {
      RowBox[{"-", "19202.4`"}], "0.`", 
      RowBox[{"-", "2701.8`"}], 
      RowBox[{"-", "1350.9`"}], 
      RowBox[{"-", "6899.400000000001`"}], "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "13798.800000000001`"}], "24607.000000000004`", "0.`", 
      "16500.600000000002`", 
      RowBox[{"-", "1350.9`"}], "6899.400000000001`", "0.`"},
     {"0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "1350.9`"}], 
      RowBox[{"-", "9601.2`"}], 
      RowBox[{"-", "1350.9`"}], "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0.`", "24607.000000000004`", "0.`", 
      "1350.9`", 
      RowBox[{"-", "9601.2`"}], "1350.9`"},
     {
      RowBox[{"-", "13798.800000000001`"}], "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "6899.400000000001`"}], 
      RowBox[{"-", "1350.9`"}], 
      RowBox[{"-", "2701.8`"}], "0.`", 
      RowBox[{"-", "19202.4`"}], "16500.600000000002`", "0.`", 
      "24607.000000000004`", "0.`", "6899.400000000001`", 
      RowBox[{"-", "1350.9`"}]},
     {"0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0", "0", "0", "0.`", "0.`", "0.`", 
      RowBox[{"-", "2701.8`"}], "2701.8`", "0.`", "2702.8`", "0.`", "0.`"},
     {
      RowBox[{"-", "13798.800000000001`"}], "0.`", "0.`", "0", "0", "0", 
      "0.`", "0.`", 
      RowBox[{"-", "13798.800000000001`"}], "13798.800000000001`", 
      RowBox[{"-", "19202.4`"}], "13798.800000000001`", "0.`", "19203.4`", 
      "0.`"},
     {"0.`", "0.`", "0.`", "0", "0", "0", "0.`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0.`", "2701.8`", 
      RowBox[{"-", "2701.8`"}], "0.`", "0.`", "2702.8`"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.666860951326481*^9, 3.6668609614199142`*^9}, {
   3.666937334142239*^9, 3.666937363794285*^9}, 3.6669378616657887`*^9, 
   3.6669398267289667`*^9, 3.66724480714235*^9, 3.6674115871325893`*^9, 
   3.667411703058395*^9, 3.6681816068641977`*^9, 3.668182011249004*^9, 
   3.6686317708131847`*^9, 3.668746641583186*^9, 3.668749821912529*^9, {
   3.668751249962438*^9, 3.6687512745900784`*^9}, 3.6687520823860683`*^9, 
   3.668922816244742*^9, 3.668923064806143*^9, 3.669272803926001*^9, 
   3.66943305409689*^9, 3.6697392496118793`*^9, 3.669749727266025*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Nest", "[", 
    RowBox[{"Step", ",", 
     RowBox[{"{", 
      RowBox[{"curpts", ",", " ", "vels"}], "}"}], ",", "2"}], "]"}], "[", 
   RowBox[{"[", "1", "]"}], "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.6659840853155193`*^9, 3.66598409748312*^9}, {
   3.665987121227507*^9, 3.6659871341604233`*^9}, {3.665987492871923*^9, 
   3.665987493045212*^9}, {3.6659877581465807`*^9, 3.665987760191353*^9}, {
   3.6659886596253643`*^9, 3.665988660239181*^9}, 3.6659922234173937`*^9, {
   3.665992765757283*^9, 3.6659927866433973`*^9}, {3.6661155233681517`*^9, 
   3.66611552349955*^9}, {3.666124350296587*^9, 3.666124350382831*^9}, {
   3.666473817443035*^9, 3.666473818109035*^9}, {3.6665008935767183`*^9, 
   3.66650092696308*^9}, {3.6665009980951757`*^9, 3.666500998189147*^9}, 
   3.666505887222032*^9, 3.6665060498753643`*^9, {3.666509108333197*^9, 
   3.6665091280772133`*^9}, {3.66654397929148*^9, 3.666543980504159*^9}, {
   3.666544020136197*^9, 3.666544020798596*^9}, {3.666544101295693*^9, 
   3.666544101369035*^9}, {3.666572324806629*^9, 3.666572324861766*^9}, {
   3.666572551799692*^9, 3.666572552020434*^9}, {3.6666294285859756`*^9, 
   3.66662943141321*^9}, {3.666766525738744*^9, 3.666766526063079*^9}, {
   3.666766581750284*^9, 3.6667665820164557`*^9}, {3.6667666706047983`*^9, 
   3.666766670761277*^9}, {3.666845358603414*^9, 3.666845360435956*^9}, {
   3.6668454913302803`*^9, 3.666845492087768*^9}, {3.6668456282713013`*^9, 
   3.666845628520873*^9}, {3.66685650987668*^9, 3.666856510297221*^9}, {
   3.6668576031670732`*^9, 3.666857603768651*^9}, {3.666861114470673*^9, 
   3.6668611148679123`*^9}, {3.6668611582447987`*^9, 3.666861158363306*^9}, {
   3.666861648162531*^9, 3.666861648318825*^9}, 3.666937340096219*^9, {
   3.6669378557683153`*^9, 3.666937855880427*^9}, 3.668181556711906*^9, 
   3.668181789777465*^9, {3.668747939305223*^9, 3.66874793946207*^9}, {
   3.6687514565166817`*^9, 3.66875146120437*^9}, 3.668752097430111*^9}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {"10.011239412235573`"},
      {
       RowBox[{"-", "0.004166869025117891`"}]},
      {"0.016249815615496203`"},
      {"0.017082145254536368`"},
      {"10.001662431036358`"},
      {"0.0020881910263690832`"},
      {
       RowBox[{"-", "0.0037441228502840236`"}]},
      {"0.0008385378105109226`"},
      {"10.001242542573175`"},
      {"0.011252355789604481`"},
      {"0.0016641655980873704`"},
      {"0.001253821217431961`"},
      {"0.005422564414972379`"},
      {
       RowBox[{"-", "9.998334099801333`"}]},
      {"0.00041945015652328563`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.668749823077414*^9, {3.668751251055368*^9, 3.668751275653103*^9}, 
   3.668751523444075*^9, 3.6687515924093723`*^9, {3.668752094347638*^9, 
   3.6687521055318213`*^9}, 3.668922823756384*^9, 3.668923065671069*^9, 
   3.669272804744688*^9, 3.669433055056695*^9, 3.669739250477005*^9, 
   3.6697497290964603`*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.666716348617876*^9, 3.6667163489336853`*^9}, {
   3.666717035314753*^9, 3.66671704549354*^9}, 3.666717717066113*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ForceWithDamping", "[", "curpts", "]"}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.66671633219099*^9, 3.6667163558307333`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"ForceWithDamping", "[", 
   RowBox[{"{", 
    RowBox[{
    "10", ",", "0", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0", ",", 
     "0", ",", "10", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "10"}], ",", "0"}], "}"}], "]"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6667163381978397`*^9, 3.6667163563367558`*^9}, {
   3.666717042753112*^9, 3.6667170496287527`*^9}, 3.666717169337453*^9, 
   3.6667664410636883`*^9, 3.666766503463526*^9, 3.666842193986274*^9, 
   3.666845263829164*^9, 3.666845586273381*^9, 3.6668514395679693`*^9, 
   3.6668525134977827`*^9, 3.666852875224268*^9, 3.666858914629799*^9, 
   3.666937381451256*^9, 3.666937865027441*^9, 3.666939829745964*^9, 
   3.66724481052213*^9, 3.667411590408072*^9, 3.6674117072355433`*^9, 
   3.6681816401025867`*^9, 3.668182011644587*^9, 3.6686317714154797`*^9, 
   3.66874664220055*^9, 3.668749823330186*^9, {3.668751251090993*^9, 
   3.66875127568813*^9}, 3.668922823941242*^9, 3.6689230657984247`*^9, 
   3.669272804933408*^9, 3.6694330551527367`*^9, 3.669739250517321*^9, 
   3.669749729278366*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vels"], "Input",
 CellChangeTimes->{{3.666717054716774*^9, 3.6667170552200623`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.666717056122448*^9, 3.6667171693841743`*^9, 3.666766441137082*^9, 
   3.666766503535741*^9, 3.666842193999991*^9, 3.666845263905096*^9, 
   3.66684558638177*^9, 3.6668514395876913`*^9, 3.666852513527775*^9, 
   3.666852875244174*^9, 3.66685891470642*^9, 3.666937381520225*^9, 
   3.666937865041233*^9, 3.666939829764538*^9, 3.667244810610694*^9, 
   3.667411590484604*^9, 3.6674117073532877`*^9, 3.668181640173543*^9, 
   3.6681820116685534`*^9, 3.6686317714908333`*^9, 3.6687466422755947`*^9, 
   3.668749823382642*^9, {3.668751251110314*^9, 3.668751275704158*^9}, 
   3.668922824015745*^9, 3.668923065868294*^9, 3.6692728050007563`*^9, 
   3.6694330553269377`*^9, 3.6697392505340014`*^9, 3.669749729324997*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["curpts"], "Input",
 CellChangeTimes->{{3.6667171132276154`*^9, 3.666717114467517*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "10", ",", "0", ",", "0", ",", "0", ",", "10", ",", "0", ",", "0", ",", "0",
    ",", "10", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "10"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.666717114871607*^9, 3.66671716944665*^9, 3.6667664412084713`*^9, 
   3.666766503606761*^9, 3.666842194013589*^9, 3.6668452639907618`*^9, 
   3.666845586429584*^9, 3.666851439607072*^9, 3.6668525135583687`*^9, 
   3.666852875263726*^9, 3.666858914778141*^9, 3.66693738158987*^9, 
   3.6669378650566683`*^9, 3.666939829783738*^9, 3.667244810694151*^9, 
   3.667411590568014*^9, 3.667411707588085*^9, 3.668181640240093*^9, 
   3.668182011691989*^9, 3.668631771582182*^9, 3.668746642348928*^9, 
   3.6687498234563313`*^9, {3.668751251129984*^9, 3.6687512757202806`*^9}, 
   3.668922824085533*^9, 3.668923066047847*^9, 3.669272805066401*^9, 
   3.6694330554412394`*^9, 3.669739250551803*^9, 3.669749729466095*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"x", "[", "pts_", "]"}], ":=", 
  RowBox[{"pts", ".", "pts"}]}]], "Input",
 CellChangeTimes->{{3.666721190434939*^9, 3.6667212085204973`*^9}, {
  3.666721293793591*^9, 3.666721296285798*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"x", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.6667212116787663`*^9, 3.66672121362638*^9}}],

Cell[BoxData["400"], "Output",
 CellChangeTimes->{
  3.666721214610682*^9, 3.666721298807755*^9, 3.666766441337688*^9, 
   3.6667665037330513`*^9, 3.666842194032798*^9, 3.666845264125248*^9, 
   3.666845586576663*^9, 3.666851439630018*^9, 3.6668525135885897`*^9, 
   3.666852875289297*^9, 3.66685891490311*^9, 3.666937381717162*^9, 
   3.666937865075481*^9, 3.6669398298078938`*^9, 3.66724481083318*^9, 
   3.667411590703656*^9, 3.6674117077431393`*^9, 3.6681816403605003`*^9, 
   3.668182011808394*^9, 3.668631771710287*^9, 3.668746642476677*^9, 
   3.6687498235831537`*^9, {3.66875125115488*^9, 3.668751275743544*^9}, 
   3.668922824220359*^9, 3.668923066182373*^9, 3.669272805185937*^9, 
   3.669433055673568*^9, 3.669739250574815*^9, 3.669749729609089*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"dx", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{
      RowBox[{"x", "[", "restpts", "]"}], ",", " ", 
      RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", " ", 
    RowBox[{"Thread", "[", 
     RowBox[{"restpts", " ", "\[Rule]", " ", "pts"}], "]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666721343030663*^9, 3.666721345762867*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dx", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.66672135157502*^9, 3.666721356243746*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "20", ",", "0", ",", "0", ",", "0", ",", "20", ",", "0", ",", "0", ",", "0",
    ",", "20", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
   RowBox[{"-", "20"}], ",", "0"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6667213567064867`*^9, 3.6667664414685802`*^9, 3.666766503856605*^9, 
   3.66684219405191*^9, 3.666845264255756*^9, 3.666845586717194*^9, 
   3.666851439657269*^9, 3.666852513616905*^9, 3.666852875317292*^9, 
   3.666858915027257*^9, 3.666937381848566*^9, 3.666937865094223*^9, 
   3.666939829830903*^9, 3.6672448109558277`*^9, 3.667411590840631*^9, 
   3.667411707862885*^9, 3.668181640482473*^9, 3.668182011834434*^9, 
   3.66863177188127*^9, 3.6687466426026173`*^9, 3.668749823714664*^9, {
   3.668751251179262*^9, 3.6687512757665787`*^9}, 3.668922824343731*^9, 
   3.668923066309099*^9, 3.6692728053061447`*^9, 3.669433055802697*^9, 
   3.669739250596809*^9, 3.669749729693084*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{"lbfgs", "[", "pts_", "]"}], ":=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "/", "2"}], ")"}], "*", 
      RowBox[{"pts", ".", "pts"}]}], " ", "-", " ", 
     RowBox[{"initpts", ".", "pts"}], " ", "-", " ", 
     RowBox[{"timestep", "*", 
      RowBox[{"vels", ".", "pts"}]}], " ", "+", " ", 
     RowBox[{"timestep", "*", "timestep", "*", 
      RowBox[{"invmasses", ".", 
       RowBox[{"totalE", "[", "pts", "]"}]}]}]}]}], ";"}], "*)"}]], "Input",
 CellChangeTimes->{{3.666723023575582*^9, 3.6667230919889507`*^9}, {
   3.6667231572214937`*^9, 3.666723160103044*^9}, {3.666723239338273*^9, 
   3.666723240196122*^9}, {3.6667234558963413`*^9, 3.6667234571590347`*^9}, 
   3.666723517992552*^9, {3.6667235563958673`*^9, 3.666723557150576*^9}, {
   3.666723675497199*^9, 3.666723678071383*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"lbfgs", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"pts", ".", 
       RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "pts"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], ")"}], 
     ".", "pts"}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"timestep", "*", 
       RowBox[{
        RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], ")"}], 
     ".", "pts"}], " ", "+", "  ", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"totalE", "[", "pts", "]"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.666723690474118*^9, 3.666723724082052*^9}, {
  3.666723795343644*^9, 3.666723800584779*^9}, {3.666723830629931*^9, 
  3.6667238503883*^9}, {3.666725635439498*^9, 3.666725661915677*^9}, {
  3.6669374116573267`*^9, 3.666937459399238*^9}, {3.666937514086603*^9, 
  3.666937523190756*^9}, {3.666937598677124*^9, 3.666937607446209*^9}, {
  3.6669376624536877`*^9, 3.666937698803301*^9}, {3.6669378921590633`*^9, 
  3.666937927083921*^9}, {3.666938033152603*^9, 3.6669380400734043`*^9}, {
  3.66693827004189*^9, 3.666938333582788*^9}, {3.66693857293532*^9, 
  3.666938579504608*^9}, {3.666939472916561*^9, 3.666939473742936*^9}, {
  3.6669395553493633`*^9, 3.6669395560974903`*^9}, {3.666939613379067*^9, 
  3.66693961443364*^9}, {3.6669396751272793`*^9, 3.6669396754068327`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"dlbfgs", "[", "pts_", "]"}], " ", ":=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"lbfgs", "[", "restpts", "]"}], ",", " ", 
     RowBox[{"{", "restpts", "}"}]}], "]"}], "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"restpts", "\[Rule]", "pts"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6667235247896442`*^9, 3.666723590770801*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dlbfgs", "[", "newpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.666723614389599*^9, 3.666723620273654*^9}, 
   3.666723668693323*^9, 3.666723859642591*^9, {3.666937487935793*^9, 
   3.666937489294228*^9}, {3.6669379708209867`*^9, 3.6669379715672693`*^9}, {
   3.66693819397215*^9, 3.666938214813146*^9}, {3.666938317682509*^9, 
   3.6669383191059837`*^9}, {3.666939517223405*^9, 3.666939518703384*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "69740.13231283537`"}]},
      {"344782.2632312836`"},
      {"225232.5`"},
      {"232165.1798979502`"},
      {
       RowBox[{"-", "69739.29897950204`"}]},
      {"112616.66666666667`"},
      {"231426.53690815516`"},
      {
       RowBox[{"-", "4980.963091844821`"}]},
      {
       RowBox[{"-", "57784.40598970691`"}]},
      {
       RowBox[{"-", "281236.16782660346`"}]},
      {
       RowBox[{"-", "269978.66782660346`"}]},
      {
       RowBox[{"-", "392515.59401029313`"}]},
      {
       RowBox[{"-", "112575.`"}]},
      {"0.`"},
      {"112616.66666666667`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.666723860236327*^9, 3.666725667752487*^9, 3.666766441715454*^9, 
   3.666766504046898*^9, 3.6668421940794487`*^9, 3.666845264497367*^9, 
   3.666845586956581*^9, 3.666851439701762*^9, 3.6668525136626368`*^9, 
   3.666852875351915*^9, 3.6668589152684393`*^9, 3.666937382035151*^9, {
   3.666937481048664*^9, 3.6669374898307858`*^9}, 3.666937531325054*^9, 
   3.666937611138939*^9, {3.666937681007558*^9, 3.6669377042788067`*^9}, 
   3.666937865131073*^9, {3.666937915465835*^9, 3.6669379310814943`*^9}, 
   3.6669379719811163`*^9, 3.666938136187799*^9, {3.666938196946293*^9, 
   3.6669382163785543`*^9}, {3.666938313799996*^9, 3.666938343100062*^9}, 
   3.666938583693412*^9, {3.6669394998582993`*^9, 3.666939519339058*^9}, 
   3.666939572967387*^9, 3.666939617803487*^9, 3.6669396783838873`*^9, 
   3.666939829878798*^9, 3.667244811205585*^9, 3.667411591141035*^9, 
   3.6674117083979673`*^9, 3.6681816407649937`*^9, 3.6681820118847513`*^9, 
   3.6686317721335278`*^9, 3.668746642864822*^9, 3.6687498240681763`*^9, {
   3.668751251227334*^9, 3.6687512758131847`*^9}, 3.6689228246148643`*^9, 
   3.668923066559667*^9, 3.66927280555431*^9, 3.669433056058352*^9, 
   3.669739250648704*^9, 3.6697497300204077`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "newpts"}], " ", "-", 
   " ", 
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], " ", "-", 
   " ", 
   RowBox[{"timestep", "*", 
    RowBox[{
     RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], "-", 
   RowBox[{"timestep", "*", "timestep", "*", 
    RowBox[{"dEnergy", "[", "newpts", "]"}]}]}], "//", 
  "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.666937538598843*^9, 3.666937554374917*^9}, {
  3.666938144674685*^9, 3.666938162930912*^9}, {3.6669383233495293`*^9, 
  3.666938323943779*^9}, {3.6669395239025307`*^9, 3.666939536351832*^9}, {
  3.6669395764699907`*^9, 3.666939588039373*^9}, {3.666939623604697*^9, 
  3.666939651846723*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "69740.13231283537`"}]},
      {"344782.2632312836`"},
      {"225232.5`"},
      {"232165.17989795023`"},
      {
       RowBox[{"-", "69739.29897950204`"}]},
      {"112616.66666666667`"},
      {"231426.53690815516`"},
      {
       RowBox[{"-", "4980.963091844821`"}]},
      {
       RowBox[{"-", "57784.40598970691`"}]},
      {
       RowBox[{"-", "281236.16782660346`"}]},
      {
       RowBox[{"-", "269978.66782660346`"}]},
      {
       RowBox[{"-", "392515.59401029313`"}]},
      {
       RowBox[{"-", "112575.`"}]},
      {"0.`"},
      {"112616.66666666667`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.6669375511791286`*^9, 3.666937554725295*^9}, 
   3.6669378651373463`*^9, {3.6669381457168493`*^9, 3.6669381634740868`*^9}, 
   3.666938324269133*^9, 3.666939537015512*^9, 3.6669395894406347`*^9, {
   3.6669396546517973`*^9, 3.666939679610159*^9}, 3.666939829912664*^9, 
   3.6672448112861233`*^9, 3.667411591264752*^9, 3.66741170850848*^9, 
   3.668181640869781*^9, 3.668182011922449*^9, 3.668631772266329*^9, 
   3.668746642951612*^9, 3.668749824110026*^9, {3.668751251259914*^9, 
   3.668751275845175*^9}, 3.668922824758082*^9, 3.668923066694669*^9, 
   3.669272805686026*^9, 3.6694330561436243`*^9, 3.669739250678195*^9, 
   3.669749730149707*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"curpts", " ", "-", " ", "initpts", " ", "-", " ", 
  RowBox[{"timestep", "*", "vels"}]}]], "Input",
 CellChangeTimes->{{3.666725731095141*^9, 3.666725739739278*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "0.01`"}], ",", "0.`", ",", 
   RowBox[{"-", "0.01`"}], ",", 
   RowBox[{"-", "0.01`"}], ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", ",", "0.`", 
   ",", "0.`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6667257405860567`*^9, 3.6667664417876863`*^9, 3.666766504116605*^9, 
   3.666842194092228*^9, 3.666845264571073*^9, 3.666845587039381*^9, 
   3.666851439721498*^9, 3.666852513684059*^9, 3.666852875370261*^9, 
   3.666858915340221*^9, 3.666937382106311*^9, 3.666937865151355*^9, 
   3.666939829931164*^9, 3.66724481142703*^9, 3.6674115914084682`*^9, 
   3.667411708585384*^9, 3.668181640938435*^9, 3.668182011946327*^9, 
   3.6686317722867413`*^9, 3.668746643025494*^9, 3.668749824277441*^9, {
   3.668751251279557*^9, 3.6687512758643227`*^9}, 3.668922824841043*^9, 
   3.6689230667151546`*^9, 3.669272805702976*^9, 3.669433056217214*^9, 
   3.669739250695875*^9, 3.669749730339196*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nmg", "[", "pts_", "]"}], ":=", " ", 
   RowBox[{"pts", " ", "-", " ", "curpts", " ", "-", " ", 
    RowBox[{"timestep", "*", "vels"}], " ", "-", " ", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"invmasses", ".", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"dEnergy", "[", "pts", "]"}], " ", "+", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
         RowBox[{
          RowBox[{"dForces", "[", "pts", "]"}], ".", 
          RowBox[{"(", 
           RowBox[{"pts", "-", "curpts"}], ")"}]}]}]}], ")"}]}]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.666939062096562*^9, 3.666939116147279*^9}, {
  3.666939751007389*^9, 3.666939751150943*^9}, {3.66693980816261*^9, 
  3.666939840385544*^9}, {3.667247780181148*^9, 3.667247789370351*^9}, {
  3.6672479518975067`*^9, 3.667248017522286*^9}, {3.667248058139872*^9, 
  3.667248072686468*^9}, {3.6672481107280073`*^9, 3.6672481109379673`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nmg", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.66724803524609*^9, 3.6672480406431093`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "836.8815877540245`"}], ",", "4137.387158775403`", ",", 
   "2702.79`", ",", "5571.964317550805`", ",", 
   RowBox[{"-", "1673.743175508049`"}], ",", "2702.8`", ",", 
   "2777.1184428978618`", ",", 
   RowBox[{"-", "59.771557102137855`"}], ",", 
   RowBox[{"-", "693.412871876483`"}], ",", 
   RowBox[{"-", "3374.834013919242`"}], ",", 
   RowBox[{"-", "3239.7440139192418`"}], ",", 
   RowBox[{"-", "4710.187128123517`"}], ",", 
   RowBox[{"-", "2701.8`"}], ",", "0.`", ",", "2702.8`"}], "}"}]], "Output",
 CellChangeTimes->{{3.667248041516643*^9, 3.66724807640327*^9}, 
   3.667411591700429*^9, 3.667411709213274*^9, 3.66818164129781*^9, 
   3.668182012119328*^9, 3.668631772672543*^9, 3.668746643381341*^9, 
   3.668749824578856*^9, {3.668751251448625*^9, 3.6687512760338717`*^9}, 
   3.668922825242133*^9, 3.668923066992585*^9, 3.669272806058338*^9, 
   3.669433056571457*^9, 3.6697392508675947`*^9, 3.669749730714342*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"g", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "pts"}], " ", "-", " ", 
   RowBox[{
    RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], " ", "-", 
   " ", 
   RowBox[{"timestep", "*", 
    RowBox[{
     RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], " ", "-", 
   " ", 
   RowBox[{"timestep", "*", "timestep", "*", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"dEnergy", "[", "pts", "]"}], "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
       RowBox[{
        RowBox[{"dForces", "[", "pts", "]"}], ".", 
        RowBox[{"(", 
         RowBox[{"pts", "-", "curpts"}], ")"}]}]}]}], ")"}]}]}]}]], "Input",
 CellChangeTimes->{{3.666939867456808*^9, 3.6669399343614264`*^9}, 
   3.667245159783498*^9, {3.667245190636443*^9, 3.667245194067382*^9}, {
   3.667245234303206*^9, 3.667245252855585*^9}, {3.667245294443718*^9, 
   3.6672453072835293`*^9}, {3.667247464450075*^9, 3.667247470165167*^9}, {
   3.6672476380011272`*^9, 3.667247650339162*^9}, {3.667247731676862*^9, 
   3.6672477365221663`*^9}, {3.6672482005836067`*^9, 3.66724821638837*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"g", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.666939937238564*^9, 3.666939941080081*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "69740.13231283537`"}], ",", "344782.2632312836`", ",", 
   "225232.5`", ",", "232165.17989795023`", ",", 
   RowBox[{"-", "69739.29897950204`"}], ",", "112616.66666666667`", ",", 
   "231426.53690815516`", ",", 
   RowBox[{"-", "4980.963091844821`"}], ",", 
   RowBox[{"-", "57784.40598970691`"}], ",", 
   RowBox[{"-", "281236.16782660346`"}], ",", 
   RowBox[{"-", "269978.66782660346`"}], ",", 
   RowBox[{"-", "392515.59401029313`"}], ",", 
   RowBox[{"-", "112575.`"}], ",", "0.`", ",", "112616.66666666667`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.666939942913967*^9, 3.667244811632201*^9, {3.6672452450473948`*^9, 
   3.667245257402076*^9}, 3.667245309700705*^9, 3.6672474736995277`*^9, 
   3.667247658835248*^9, 3.667247739716487*^9, 3.667248222106861*^9, 
   3.6674115919208593`*^9, 3.6674117096793413`*^9, 3.668181641509776*^9, 
   3.668182012306383*^9, 3.668631773007915*^9, 3.6687466437248163`*^9, 
   3.6687498249091387`*^9, {3.668751251654791*^9, 3.668751276213264*^9}, 
   3.668922825574814*^9, 3.668923067297344*^9, 3.669272806329186*^9, 
   3.669433056990664*^9, 3.669739251132262*^9, 3.669749731157578*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"nmG", "[", "pts_", "]"}], ":=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "/", "2"}], ")"}], 
     RowBox[{"pts", ".", 
      RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "pts"}]}], " ", "-", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "curpts"}], ")"}], 
     ".", "pts"}], " ", "-", " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"timestep", "*", 
       RowBox[{
        RowBox[{"Inverse", "[", "invmasses", "]"}], ".", "vels"}]}], ")"}], 
     ".", "pts"}], " ", "-", 
    RowBox[{"timestep", "*", "timestep", "*", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "1"}], "*", 
        RowBox[{"totalE", "[", "pts", "]"}]}], "+", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"rayleigh", "/", "timestep"}], ")"}], "*", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pts", " ", ".", 
           RowBox[{"dEnergy", "[", "pts", "]"}]}], " ", "+", 
          RowBox[{"totalE", "[", "pts", "]"}], " ", "-", " ", 
          RowBox[{
           RowBox[{"dEnergy", "[", "pts", "]"}], ".", "curpts"}]}], ")"}]}]}],
       ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.666939118265952*^9, 3.666939230029084*^9}, {
  3.666939690790188*^9, 3.666939691682616*^9}, {3.6672453578334293`*^9, 
  3.667245361660577*^9}, {3.667245403493235*^9, 3.6672454339737186`*^9}, {
  3.667245528368675*^9, 3.667245571814782*^9}, {3.667245603792947*^9, 
  3.667245698022902*^9}, {3.667247168493371*^9, 3.66724717654322*^9}, {
  3.667247228711647*^9, 3.667247231331262*^9}, {3.667247407687026*^9, 
  3.667247422211431*^9}, {3.667247492495037*^9, 3.667247504620207*^9}, {
  3.667247749067319*^9, 3.6672477581414433`*^9}, {3.667248238841921*^9, 
  3.667248247696961*^9}, {3.667248340790682*^9, 3.6672484079908648`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"newg", "[", "pts_", "]"}], ":=", " ", 
  RowBox[{
   RowBox[{"D", "[", 
    RowBox[{
     RowBox[{"nmG", "[", "restpts", "]"}], ",", " ", 
     RowBox[{"{", "restpts", "}"}]}], "]"}], " ", "/.", 
   RowBox[{"Thread", "[", 
    RowBox[{"restpts", "\[Rule]", "pts"}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6669392361537733`*^9, 3.66693926490868*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"newg", "[", "newpts", "]"}]], "Input",
 CellChangeTimes->{{3.666939280658733*^9, 3.6669392848439302`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", "69740.13231283537`"}], ",", "344782.2632312836`", ",", 
   "225232.5`", ",", "232165.1798979502`", ",", 
   RowBox[{"-", "69739.29897950204`"}], ",", "112616.66666666667`", ",", 
   "231426.53690815516`", ",", 
   RowBox[{"-", "4980.963091844821`"}], ",", 
   RowBox[{"-", "57784.40598970691`"}], ",", 
   RowBox[{"-", "281236.16782660346`"}], ",", 
   RowBox[{"-", "269978.66782660346`"}], ",", 
   RowBox[{"-", "392515.59401029313`"}], ",", 
   RowBox[{"-", "112575.`"}], ",", "0.`", ",", "112616.66666666667`"}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6669392856885033`*^9, 3.666939765166807*^9, 3.666939830024782*^9, 
   3.667244811901258*^9, {3.667247437186533*^9, 3.667247448646081*^9}, 
   3.667247511413335*^9, 3.667247766461513*^9, {3.6672483532941017`*^9, 
   3.667248410906561*^9}, 3.6674115922982273`*^9, 3.667411710016515*^9, 
   3.6681816419199743`*^9, 3.668182012386773*^9, 3.668631773281184*^9, 
   3.6687466438994827`*^9, 3.6687498250813837`*^9, {3.668751251897584*^9, 
   3.6687512764387817`*^9}, 3.668922825987637*^9, 3.668923067545588*^9, 
   3.669272806571888*^9, 3.6694330571737556`*^9, 3.669739251245453*^9, 
   3.669749731472065*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", "\[IndentingNewLine]"}]], "Input",
 CellChangeTimes->{{3.669433061507038*^9, 3.669433062611011*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"nmG", "[", "curpts", "]"}]], "Input",
 CellChangeTimes->{{3.66943376545543*^9, 3.669433772554268*^9}}],

Cell[BoxData[
 RowBox[{"-", "12508.33333333333`"}]], "Output",
 CellChangeTimes->{3.669433773890955*^9, 3.669739251296472*^9, 
  3.669749731733007*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"newg", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.669435894559766*^9, 3.669435914710512*^9}, {
  3.6697405634610157`*^9, 3.6697405706122093`*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", 
   TagBox[GridBox[{
      {
       RowBox[{"-", "0.8333333333333712`"}]},
      {"0.`"},
      {
       RowBox[{"-", "0.8333333333333333`"}]},
      {
       RowBox[{"-", "0.41666666666666663`"}]},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"},
      {"0.`"}
     },
     GridBoxAlignment->{
      "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}},
        "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[0.4]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    Column], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{{3.669435900744658*^9, 3.669435915522599*^9}, 
   3.6697392513606853`*^9, {3.669740567045651*^9, 3.6697405710986757`*^9}, 
   3.669749731879434*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"dForces", "[", "curpts", "]"}], "//", "MatrixForm"}]], "Input",
 CellChangeTimes->{{3.669435904554016*^9, 3.669435907390428*^9}, {
  3.66974075506861*^9, 3.669740755831933*^9}, {3.669741685328231*^9, 
  3.66974173080162*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", "1.6002`*^10"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.1499`*^10"}], "1.6002`*^10", "0.`", "1.1499`*^10", 
      "0.`", "5.7495`*^9", "0.`"},
     {"0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`", "0.`", "0.`", "0.`", "0.`", 
      "2.2515`*^9", "0.`", "1.12575`*^9", "0.`", "0.`"},
     {"0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "2.2515`*^9", "0.`", 
      "2.2515`*^9", "0.`", "0.`", "0.`"},
     {"0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`", "0.`", "0.`", "0.`", 
      "1.12575`*^9", "1.12575`*^9", "0.`", "0", "0", "0"},
     {
      RowBox[{"-", "5.7495`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "8.001`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "5.7495`*^9", "8.001`*^9", "5.7495`*^9", 
      "0", "0", "0"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`", "1.12575`*^9", 
      "1.12575`*^9", "0", "0", "0"},
     {"0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "2.2515`*^9", "0.`", 
      "2.2515`*^9", "0.`", "0.`", "0.`"},
     {"0.`", "0.`", "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "2.2515`*^9"}], "0.`", "0.`", "2.2515`*^9", "0.`", "0.`", 
      "0.`", "1.12575`*^9"},
     {
      RowBox[{"-", "1.1499`*^10"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "0.`", "0.`", "0.`", 
      RowBox[{"-", "1.6002`*^10"}], "1.1499`*^10", "0.`", "1.6002`*^10", 
      "0.`", "5.7495`*^9", "0.`"},
     {"1.6002`*^10", "0.`", "2.2515`*^9", "1.12575`*^9", "5.7495`*^9", "0.`", 
      "2.2515`*^9", "0.`", "1.1499`*^10", 
      RowBox[{"-", "2.0505`*^10"}], "0.`", 
      RowBox[{"-", "1.37505`*^10"}], "1.12575`*^9", 
      RowBox[{"-", "5.7495`*^9"}], "0.`"},
     {"0.`", "2.2515`*^9", "0.`", "1.12575`*^9", "8.001`*^9", "1.12575`*^9", 
      "0.`", "2.2515`*^9", "0.`", "0.`", 
      RowBox[{"-", "2.0505`*^10"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "8.001`*^9", 
      RowBox[{"-", "1.12575`*^9"}]},
     {"1.1499`*^10", "0.`", "2.2515`*^9", "0.`", "5.7495`*^9", "1.12575`*^9", 
      "2.2515`*^9", "0.`", "1.6002`*^10", 
      RowBox[{"-", "1.37505`*^10"}], "0.`", 
      RowBox[{"-", "2.0505`*^10"}], "0.`", 
      RowBox[{"-", "5.7495`*^9"}], "1.12575`*^9"},
     {"0.`", "1.12575`*^9", "0.`", "0", "0", "0", "0.`", "0.`", "0.`", 
      "1.12575`*^9", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", 
      RowBox[{"-", "1.12575`*^9"}], "0.`", "0.`"},
     {"5.7495`*^9", "0.`", "0.`", "0", "0", "0", "0.`", "0.`", "5.7495`*^9", 
      RowBox[{"-", "5.7495`*^9"}], "8.001`*^9", 
      RowBox[{"-", "5.7495`*^9"}], "0.`", 
      RowBox[{"-", "8.001`*^9"}], "0.`"},
     {"0.`", "0.`", "0.`", "0", "0", "0", "0.`", "1.12575`*^9", "0.`", "0.`", 
      
      RowBox[{"-", "1.12575`*^9"}], "1.12575`*^9", "0.`", "0.`", 
      RowBox[{"-", "1.12575`*^9"}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{
  3.669740756951247*^9, {3.66974168975613*^9, 3.6697417006196623`*^9}, 
   3.6697417312759237`*^9, 3.669749732171694*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["vels"], "Input",
 CellChangeTimes->{{3.669436093342153*^9, 3.6694360946832533`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "1", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", "0", 
   ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.669436095357416*^9, 3.669739251385571*^9, 
  3.6697497323070927`*^9}]
}, Open  ]]
},
WindowSize->{927, 1028},
WindowMargins->{{Automatic, -175}, {Automatic, 166}},
FrontEndVersion->"10.3 for Linux x86 (64-bit) (December 10, 2015)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[400, 13, 92, 2, 32, "Input"],
Cell[495, 17, 545, 15, 32, "Input"],
Cell[1043, 34, 428, 9, 32, "Input"],
Cell[1474, 45, 2675, 86, 121, "Input"],
Cell[CellGroupData[{
Cell[4174, 135, 398, 10, 55, "Input"],
Cell[4575, 147, 2124, 31, 32, "Output"],
Cell[6702, 180, 2124, 31, 32, "Output"]
}, Open  ]],
Cell[8841, 214, 736, 14, 32, "Input"],
Cell[9580, 230, 471, 8, 32, "Input"],
Cell[10054, 240, 410, 9, 32, "Input"],
Cell[10467, 251, 608, 17, 99, "Input"],
Cell[11078, 270, 3307, 94, 165, "Input"],
Cell[CellGroupData[{
Cell[14410, 368, 1127, 23, 77, "Input"],
Cell[15540, 393, 2537, 45, 77, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[18114, 443, 1078, 22, 77, "Input"],
Cell[19195, 467, 2950, 52, 77, "Output"]
}, Open  ]],
Cell[22160, 522, 847, 26, 55, "Input"],
Cell[23010, 550, 1390, 36, 77, "Input"],
Cell[24403, 588, 452, 12, 32, "Input"],
Cell[CellGroupData[{
Cell[24880, 604, 164, 3, 32, "Input"],
Cell[25047, 609, 3105, 64, 281, "Output"]
}, Open  ]],
Cell[28167, 676, 487, 13, 32, "Input"],
Cell[CellGroupData[{
Cell[28679, 693, 263, 5, 32, "Input"],
Cell[28945, 700, 5876, 112, 326, "Output"]
}, Open  ]],
Cell[34836, 815, 378, 6, 32, "Input"],
Cell[35217, 823, 417, 6, 32, "Input"],
Cell[35637, 831, 504, 11, 55, "Input"],
Cell[CellGroupData[{
Cell[36166, 846, 72, 1, 32, "Input"],
Cell[36241, 849, 4072, 70, 281, "Output"]
}, Open  ]],
Cell[40328, 922, 4924, 111, 363, "Input"],
Cell[45255, 1035, 734, 18, 55, "Input"],
Cell[CellGroupData[{
Cell[46014, 1057, 102, 1, 32, "Input"],
Cell[46119, 1060, 565, 11, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[46721, 1076, 183, 3, 32, "Input"],
Cell[46907, 1081, 382, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[47326, 1092, 622, 12, 32, "Input"],
Cell[47951, 1106, 1810, 44, 281, "Output"]
}, Open  ]],
Cell[49776, 1153, 831, 19, 55, "Input"],
Cell[50610, 1174, 868, 21, 77, "Input"],
Cell[CellGroupData[{
Cell[51503, 1199, 102, 1, 32, "Input"],
Cell[51608, 1202, 363, 6, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52008, 1213, 162, 3, 32, "Input"],
Cell[52173, 1218, 1484, 43, 281, "Output"]
}, Open  ]],
Cell[53672, 1264, 432, 11, 32, "Input"],
Cell[CellGroupData[{
Cell[54129, 1279, 164, 3, 32, "Input"],
Cell[54296, 1284, 4570, 97, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[58903, 1386, 2019, 31, 32, "Input"],
Cell[60925, 1419, 1497, 41, 281, "Output"]
}, Open  ]],
Cell[62437, 1463, 165, 2, 32, "Input"],
Cell[CellGroupData[{
Cell[62627, 1469, 177, 4, 32, "Input"],
Cell[62807, 1475, 1163, 21, 46, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[64007, 1501, 98, 1, 32, "Input"],
Cell[64108, 1504, 950, 16, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[65095, 1525, 100, 1, 32, "Input"],
Cell[65198, 1528, 966, 16, 32, "Output"]
}, Open  ]],
Cell[66179, 1547, 225, 5, 32, "Input"],
Cell[CellGroupData[{
Cell[66429, 1556, 126, 2, 32, "Input"],
Cell[66558, 1560, 760, 11, 32, "Output"]
}, Open  ]],
Cell[67333, 1574, 427, 12, 32, "Input"],
Cell[CellGroupData[{
Cell[67785, 1590, 125, 2, 32, "Input"],
Cell[67913, 1594, 942, 16, 32, "Output"]
}, Open  ]],
Cell[68870, 1613, 886, 20, 55, "Input"],
Cell[69759, 1635, 1550, 34, 55, "Input"],
Cell[71312, 1671, 393, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[71730, 1685, 458, 7, 32, "Input"],
Cell[72191, 1694, 2443, 58, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[74671, 1757, 786, 19, 77, "Input"],
Cell[75460, 1778, 1881, 50, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[77378, 1833, 189, 3, 32, "Input"],
Cell[77570, 1838, 1014, 18, 32, "Output"]
}, Open  ]],
Cell[78599, 1859, 1023, 23, 77, "Input"],
Cell[CellGroupData[{
Cell[79647, 1886, 128, 2, 32, "Input"],
Cell[79778, 1890, 982, 18, 55, "Output"]
}, Open  ]],
Cell[80775, 1911, 1231, 29, 77, "Input"],
Cell[CellGroupData[{
Cell[82031, 1944, 125, 2, 32, "Input"],
Cell[82159, 1948, 1189, 22, 55, "Output"]
}, Open  ]],
Cell[83363, 1973, 1893, 47, 121, "Input"],
Cell[85259, 2022, 388, 10, 32, "Input"],
Cell[CellGroupData[{
Cell[85672, 2036, 130, 2, 32, "Input"],
Cell[85805, 2040, 1220, 23, 55, "Output"]
}, Open  ]],
Cell[87040, 2066, 146, 2, 77, "Input"],
Cell[CellGroupData[{
Cell[87211, 2072, 126, 2, 32, "Input"],
Cell[87340, 2076, 151, 3, 32, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[87528, 2084, 214, 4, 32, "Input"],
Cell[87745, 2090, 1112, 38, 281, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[88894, 2133, 260, 5, 32, "Input"],
Cell[89157, 2140, 3885, 84, 326, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[93079, 2229, 98, 1, 32, "Input"],
Cell[93180, 2232, 304, 7, 32, "Output"]
}, Open  ]]
}
]
*)

